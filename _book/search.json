[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Reavealing Hidden Sensitivity - Inter-Individual Growth Variation in Earthworms Exposed to a Fungicide",
    "section": "",
    "text": "1 How to use this repository ?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>How to use this repository ?</span>"
    ]
  },
  {
    "objectID": "index.html#html-pages",
    "href": "index.html#html-pages",
    "title": "Reavealing Hidden Sensitivity - Inter-Individual Growth Variation in Earthworms Exposed to a Fungicide",
    "section": "1.1 Html pages",
    "text": "1.1 Html pages",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>How to use this repository ?</span>"
    ]
  },
  {
    "objectID": "index.html#repository-organisation",
    "href": "index.html#repository-organisation",
    "title": "Reavealing Hidden Sensitivity - Inter-Individual Growth Variation in Earthworms Exposed to a Fungicide",
    "section": "1.2 Repository organisation",
    "text": "1.2 Repository organisation\n\n_book : Where the final html pages are created\n_quarto.yaml : YAML file that setup the structure of the website from the quarto (.qmd) documents\n.git & .gitignore : Git related files\n.quarto : ??????????????????????????????????????\n.Rproj.user & ew-growth-vi.Rproj : R project related files\nhtml_css.scss : CSS file to modify the look of the html pages\nlightnord.theme : Theme to use for code blocks displayed in the html pages\nreferences folder\n\napa.csl : File of the reference style used for the website\nreference.bib : File containing all references from a zotero library\n\nmod folder : Contain all the models generated in .rds files\nphotos folder : Contains all photos used in html pages\nfig folder : Contains all figure generated by quarto documents\ndata folder : Contains the raw data files with direct notations from the experiments\nquarto folder : Contains all the .qmd files that generate the html pages, and their associated cache and files which cannot be moved to another folder.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>How to use this repository ?</span>"
    ]
  },
  {
    "objectID": "index.html#how-to-reproduce-everything",
    "href": "index.html#how-to-reproduce-everything",
    "title": "Reavealing Hidden Sensitivity - Inter-Individual Growth Variation in Earthworms Exposed to a Fungicide",
    "section": "1.3 How to reproduce everything",
    "text": "1.3 How to reproduce everything",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>How to use this repository ?</span>"
    ]
  },
  {
    "objectID": "quarto/A_Context_of_the_study.html",
    "href": "quarto/A_Context_of_the_study.html",
    "title": "2  Context of the study",
    "section": "",
    "text": "test\nEnvironmental risk assessments (ERAs) of chemicals rely on standardized ecotoxicological tests that largely overlook inter-individual variability (Jager, 2013), an essential contributor to ecological resilience and evolutionary success (Debecker & Stoks, 2019; Des Roches et al., 2018; Hendry, 2020). Contaminants can disrupt individual differences by altering life-history traits, leading to amplified fitness disparities, favored phenotypes, and a reduced genetic diversity, ultimately affecting population dynamics and its ability to adapt to additional stressors. There is growing consensus that inter-individual variation should be a critical endpoint in ecotoxicological studies, particularly for evaluating long-term impacts on population resilience and community structure (Oziolor et al., 2020). However, the extent to which pollutants influence inter-individual variability, and how this variability translates into population-level consequences, remains poorly understood.\nBehavioral ecotoxicology studies (Polverino et al., 2021; Royauté et al., 2015) suggest two competing scenarios (Killen et al., 2013): contaminants either constrain individual variation through environmental pressures or amplify it by triggering diverse responses. To address this complexity, researchers now employ sophisticated statistical approaches such as hierarchical models (Feller & Gelman, 2015), enabling better understanding of population responses to pollutants.\nThe present study focuses on estimating the impact of pesticides exposure on the expression of inter-individual variations in earthworms as key organism for soil functioning (Keith & Robinson, 2012). Given their ecological niche, earthworms are particularly vulnerable to pesticide residues in soils, and pesticides have been implicated in the decline of earthworm biodiversity in conventionally managed agricultural fields (Bertrand et al., 2024). We specifically focus on Aporrectodea caliginosa, a model species used in ecotoxicology; which is ubiquist in agricultural fields (Bart et al., 2018). A. caliginosa is also one of the model species for ISO ecotoxicological tests (ISO 11268-2:2023).\nOur study had two primary objectives :\n\nTo investigate how pesticide exposure affects not only the mean growth rate but also the inter-individual variations in earthworm growth, with important implications for environmental risk assessment (ERA).\nTo evaluate whether current ERA protocols, which typically use fewer replicates, can reliably capture these biological variations.\n\nTo address these objectives, we conducted a longitudinal study with two treatments: one control and one with a sub-lethal dose of a cocktail of epoxiconazole and dimoxystrobin, two active substances found in the plant protection product Swing® Gold. This fungicide has known effects on A. caliginosa growth and reproduction (Bart et al., 2019, 2020).\nBecause of natural phenotypic diversity, individual variation is already expected in the non exposed cohort. We expected a decrease in the average individual growth rate in the fungicide cocktail. We also hypothesized an effect of pesticides exposure on individual variation but with no a priori on the direction of the pesticide effect, as empirical results cited above support both cases (Figure 2.1). To evaluate current ERA practices, we used a resampling procedure to examine whether a reduced sample size would have altered our estimates, potentially leading to inaccurate or even misleading conclusions. We anticipated that standard replicate numbers may not be sufficient to accurately capture both variability and mean growth, increasing the risk of overlooking a particularly sensitive subset of the population.\nThrough the longitudinal comparison of 30 exposed and 30 unexposed individuals, we discovered that while the fungicide had minimal impact on mean growth rate, it caused a three-fold increase in inter-individual variability, revealing a subset of highly sensitive individuals with up to 10% growth reduction. Our findings have significant implications for environmental risk assessment. Focusing solely on population means could overlook effects on sensitive individuals that may signal early environmental stress. While incorporating individual variability into ecotoxicological studies remains challenging, these efforts are crucial for refining safety factors in ERA frameworks (Jager, 2013; Nikinmaa & Anttila, 2019) and improving risk assessment accuracy. Additionally, better understanding of the impact of contaminants on inter-individual variation would improve the accuracy and ecological relevance of risk assessments, while capturing the long-term implications for population and ecosystem dynamics.\n\n\nCode\ncol_ctrl &lt;- pal_col[1]\ncol_trt &lt;- pal_col[2]\n\nExposition &lt;- c(\"Control\", \"Treatment\")\n\nsize_line &lt;- 1.5\nalpha_line &lt;- 0.5\nsize_text &lt;- 5\nsize_point &lt;- 5\nalpha_point &lt;- 1\nsize_title &lt;- 13\nmar &lt;- 0.2\ncol_grey &lt;- \"grey50\"\n\ny_min &lt;- -1\ny_max &lt;- 0.5\n\ny_label &lt;- -1.2\n\nmu_dim &lt;- 0.4\n\n\nplot_Inf &lt;- ggplot()+\n  geom_point(\n    aes(\n    x=Exposition[1], \n    y=c(0)\n    ), \n    color=col_ctrl,\n    size=size_point, \n    alpha=alpha_point\n    )+\n  geom_point(\n    aes(\n      x=Exposition[2], \n      y=c(-mu_dim)), \n    color=col_trt,\n    size=size_point, \n    alpha=alpha_point\n    )+\n  ylim(\n    y_min,\n    y_max\n    )+\n  labs(y=\"Growth rate\")+\n  annotate(\n    \"segment\",\n    x = Exposition[1], \n    xend = Exposition[1],\n    y = -0.3,\n    yend = 0.3,\n    colour = col_ctrl, \n    size=size_line, \n    alpha=alpha_line\n    )+\n  annotate(\n    \"segment\",\n    x = Exposition[2], \n    xend = Exposition[2],\n    y = -0.15-mu_dim, \n    yend = 0.15-mu_dim,\n    colour = col_trt, \n    size=size_line, \n    alpha=alpha_line\n    )+\n  labs(subtitle = \"1. Constraints on individual \\ndifferences in growth\")+\n  theme_classic(14)+\n  theme(\n    plot.title = element_text(\n      face=\"bold\", \n      size=size_title,\n      hjust=0.5, \n      vjust=0.5\n      ),\n    plot.subtitle = element_text(\n      face=\"plain\", \n      size=size_title-2,\n      hjust=0.5, \n      vjust=0.5\n      ),\n    plot.margin = unit(\n      c(mar, mar, mar, mar),\n      \"inches\"\n      ),\n    axis.ticks.y = element_blank(),\n    axis.text.y = element_blank(),\n    #axis.line.x = element_blank(),\n    axis.line.y = element_line(\n      arrow = grid::arrow(\n        length = unit(0.3, \"cm\"),\n        ends = \"last\"\n        )\n      ),\n    axis.title.x = element_blank()\n    )\n\nplot_Sup &lt;- ggplot()+\n  geom_point(\n    aes(\n      x=Exposition[1], \n      y=c(0)\n      ), \n    color=col_ctrl,\n    size=size_point, \n    alpha=alpha_point\n    )+\n  geom_point(\n    aes(\n      x=Exposition[2], \n      y=c(-mu_dim)\n      ), \n    color=col_trt, \n    size=size_point, \n    alpha=alpha_point\n    )+\n  ylim(\n    y_min,\n    y_max\n    )+\n  annotate(\n    \"segment\", \n    x = Exposition[1], \n    xend = Exposition[1],\n    y = -0.3,\n    yend = 0.3, \n    colour = col_ctrl, \n    size=size_line, \n    alpha=alpha_line\n    )+\n  annotate(\n    \"segment\",\n    x = Exposition[2], \n    xend = Exposition[2],\n    y = -0.6-mu_dim, \n    yend = 0.6-mu_dim,\n    colour = col_trt, \n    size=size_line, \n    alpha=alpha_line\n    )+\n\n  labs(subtitle = \"2. Amplification of individual \\ndifferences in growth\")+\n  theme_classic(14)+\n  theme(\n    plot.title = element_text(\n      face=\"bold\", \n      size=size_title,\n      hjust=0.5, \n      vjust=0.5\n      ),\n    plot.subtitle = element_text(\n      face=\"plain\", \n      size=size_title-2,\n      hjust=0.5, vjust=0.5\n      ),\n    plot.margin = unit(\n      c(mar, mar, mar, mar),\n      \"inches\"\n      ),\n    axis.ticks.y = element_blank(),\n    axis.text.y = element_blank(),\n    axis.line.y = element_blank(),\n    axis.title = element_blank()\n    )\n\n# Population simulation for a decrease in variance\nnb_ind &lt;- 10\nt_expe &lt;- 56\n\nt_values = seq(0, t_expe, 1) # Time points\nsd = 0.000001 # Measurement error\n\n# Biological parameters (Bart et al. 2020)\nL0_mu = 2.12                # Initial volumetric structural length (mg1/3) (= 2.25)\na_ctrl_mu = 0.085           # Growth rate (d-1)\na_trt_mu = 0.085*0.7        # Growth rate (d-1)\n\nL0_sd = 0.26\na_ctrl_sd = 0.01\na_trt_sd = 0.005\n\nset.seed(3333)\n\nID_i  &lt;- seq(1,nb_ind,1)\nList_L0_i&lt;- rnorm(nb_ind, L0_mu, L0_sd)\nList_a_i &lt;- c(rnorm(nb_ind/2, a_ctrl_mu, a_ctrl_sd), rnorm(nb_ind/2, a_trt_mu, a_trt_sd))\n\ndf_pop_sim &lt;- data.frame(                                \n  ID = ID_i,                           \n  L0_i = List_L0_i,                                        \n  a_i = List_a_i,                     \n  exposition = as.factor(c(                                             \n    rep(0, nb_ind/2),                                       \n    rep(1, nb_ind/2)                                        \n    ))                                                       \n  ) \n\ndf_sim &lt;- df_pop_sim |&gt; \n  expand_grid(t = t_values) |&gt;   \n  mutate(\n    L = L0_i + a_i * t\n    )\ndata_sim &lt;- df_sim |&gt; \n  mutate(\n    w = L^3,\n    exposition = as.factor(exposition)\n  )\n\ndf_sim_decrease &lt;- data_sim\n\n# Population simulation for an increase in variance\n\na_ctrl_sd = 0.01\na_trt_sd = 0.025\n\nset.seed(3333)\n\nID_i  &lt;- seq(1,nb_ind,1)\nList_L0_i&lt;- rnorm(nb_ind, L0_mu, L0_sd)\nList_a_i &lt;- c(rnorm(nb_ind/2, a_ctrl_mu, a_ctrl_sd), rnorm(nb_ind/2, a_trt_mu, a_trt_sd))\n\ndf_pop_sim &lt;- data.frame(                                \n  ID = ID_i,                           \n  L0_i = List_L0_i,                                        \n  a_i = List_a_i,                     \n  exposition = as.factor(c(                                             \n    rep(0, nb_ind/2),                                       \n    rep(1, nb_ind/2)                                        \n    ))                                                       \n  )  \n\ndf_sim &lt;- df_pop_sim |&gt; \n  expand_grid(t = t_values) |&gt;   \n  mutate(\n    L = L0_i + a_i * t\n    )\ndata_sim &lt;- df_sim |&gt; \n  mutate(\n    w = L^3,\n    exposition = as.factor(exposition)\n  )\n\ndf_sim_increase &lt;- rbind(subset(df_sim_decrease, exposition==0),subset(data_sim, exposition==1))\n\nalpha_line &lt;- 0.8\nline_width &lt;- 1.2\n\nplot_Inf_traj &lt;- ggplot(\n  data=df_sim_decrease, \n  aes(\n    x=t, \n    y=L^3, \n    color=exposition, \n    group=as.factor(ID))\n  )+\n  scale_color_manual(values=pal_col, label=Exposition, name=\"\")+\n  geom_line(\n    lwd=line_width, \n    alpha=alpha_line\n    )+\n  labs(\n    x=\"Time\", \n    y=\"Weight\",\n    title = \"Consequences on growth\",\n    subtitle = \"1. Low to no overlap in \\ngrowth trajectories\"\n    )+\n  theme_classic(14)+\n  theme(\n    plot.title = element_text(\n      face=\"bold\", \n      size=size_title,\n      vjust=0.5\n      ),\n    plot.subtitle = element_text(\n      face=\"plain\", \n      size=size_title-2,\n      vjust=0.5\n      ),\n    plot.margin = unit(\n      c(mar, mar, mar, mar),\n      \"inches\"\n      ),\n    axis.ticks = element_blank(),\n    legend.position = \"bottom\",\n    axis.text = element_blank(),\n    axis.title = element_text(),\n    axis.line.x=element_line(),\n    axis.line.y = element_line(\n      arrow = grid::arrow(\n        length = unit(0.3, \"cm\"),\n        ends = \"last\"\n        )\n      )\n    )\n\nplot_Sup_traj &lt;- ggplot(\n  data=df_sim_increase, \n  aes(\n    x=t, \n    y=L^3, \n    color=exposition, \n    group=as.factor(ID))\n  )+\n  scale_color_manual(values=pal_col, label=Exposition, name=\"\")+\n\n  geom_line(\n    lwd=line_width, \n    alpha=alpha_line\n    )+\n  \n  labs(\n    x=\"Time\", \n    y=\"\",\n    subtitle = \"2. Strong overlap in growth trajectories \\ndespite average differences\"\n    )+\n  theme_classic(14)+\n  theme(\n    plot.title = element_text(\n      face=\"bold\", \n      size=size_title,\n      hjust=0.5, \n      vjust=0.5\n      ),\n    plot.subtitle = element_text(\n      face=\"plain\", \n      size=size_title-2,\n      vjust=0.5\n      ),\n    plot.margin = unit(\n      c(mar, mar, mar, mar),\n      \"inches\"\n      ),\n    axis.ticks = element_blank(),\n    legend.position = \"bottom\",\n    axis.text = element_blank(),\n    axis.title = element_text(),\n    axis.line.y = element_blank(),\n    axis.line.x = element_line(\n      arrow = grid::arrow(\n        length = unit(0.3, \"cm\"),\n        ends = \"last\"\n        )\n      )\n    )\n\n\n\n\nCode\nplot_hyp &lt;- plot_Inf+plot_Sup+ plot_Inf_traj+plot_Sup_traj+plot_layout(ncol=2, guides=\"collect\")+\n  plot_annotation(title = \"Growth rate comparison\") &\n  theme(legend.position = \"bottom\",\n        plot.title = element_text(face=\"bold\", size=size_title,\n                                  vjust=0.5))\nplot_hyp\n\n\n\n\n\n\n\n\nFigure 2.1: Different scenarios of how pesticides exposure may alter individual differences in growth under the general hypothesis that average growth is reduced by the exposition. Case 1 describes a diminution of individual differences that may be due to the additional constraints from the exposition, leading to a low overlap in growth trajectories between the two groups. Case 2 describes an amplification of individual differences that may be due to the additional variation of individual responses to the fungicide exposure, leading to a strong overlap in growth trajectories between the two groups.\n\n\n\n\n\n\n\n\n\n\n\nBart, S., Amossé, J., Lowe, C. N., Mougin, C., Péry, A. R. R., & Pelosi, C. (2018). Aporrectodea caliginosa, a relevant earthworm species for a posteriori pesticide risk assessment: Current knowledge and recommendations for culture and experimental design. Environmental Science and Pollution Research, 25(34), 33867–33881. https://doi.org/10.1007/s11356-018-2579-9\n\n\nBart, S., Barraud, A., Amossé, J., Péry, A. R. R., & Mougin, C. (2019). Effects of two common fungicides on the reproduction of Aporrectodea caliginosa in natural soil. Ecotoxicology and Environmental Safety, 181, 518–524. https://doi.org/10.1016/j.ecoenv.2019.06.049\n\n\nBart, S., Pelosi, C., Nélieu, S., Lamy, I., & Péry, A. R. R. (2020). An energy-based model to analyze growth data of earthworms exposed to two fungicides. Environmental Science and Pollution Research, 27(1), 741–750. https://doi.org/10.1007/s11356-019-06985-z\n\n\nBertrand, C., Aviron, S., Pelosi, C., Faburé, J., Le Perchec, S., Mamy, L., & Rault, M. (2024). Effects of plant protection products on ecosystem functions provided by terrestrial invertebrates. Environmental Science and Pollution Research. https://doi.org/10.1007/s11356-024-34534-w\n\n\nDebecker, S., & Stoks, R. (2019). Pace of life syndrome under warming and pollution: Integrating life history, behavior, and physiology across latitudes. Ecological Monographs, 89(1), e01332. https://doi.org/10.1002/ecm.1332\n\n\nDes Roches, S., Post, D. M., Turley, N. E., Bailey, J. K., Hendry, A. P., Kinnison, M. T., Schweitzer, J. A., & Palkovacs, E. P. (2018). The ecological importance of intraspecific variation. Nature Ecology & Evolution, 2(1, 1), 57–64. https://doi.org/10.1038/s41559-017-0402-5\n\n\nFeller, A., & Gelman, A. (2015). Hierarchical Models for Causal Effects. In R. A. Scott & S. M. Kosslyn (Eds.), Emerging Trends in the Social and Behavioral Sciences (1st ed., pp. 1–16). Wiley. https://doi.org/10.1002/9781118900772.etrds0160\n\n\nHendry, A. P. (2020). Eco-evolutionary dynamics. Princeton University Press.\n\n\nJager, T. (2013). All Individuals Are Not Created Equal; Accounting for Interindividual Variation in Fitting Life-History Responses to Toxicants. Environmental Science & Technology, 47, 1664–1669. https://doi.org/10.1021/es303870g\n\n\nKeith, A. M., & Robinson, D. A. (2012). Earthworms as Natural Capital: Ecosystem Service Providers in Agricultural Soils.\n\n\nKillen, S. S., Marras, S., Metcalfe, N. B., McKenzie, D. J., & Domenici, P. (2013). Environmental stressors alter relationships between physiology and behaviour. Trends in Ecology & Evolution, 28(11), 651–658. https://doi.org/10.1016/j.tree.2013.05.005\n\n\nNikinmaa, M., & Anttila, K. (2019). Individual variation in aquatic toxicology: Not only unwanted noise. Aquatic Toxicology, 207, 29–33. https://doi.org/10.1016/j.aquatox.2018.11.021\n\n\nOziolor, E. M., DeSchamphelaere, K., Lyon, D., Nacci, D., & Poynton, H. (2020). Evolutionary Toxicology—An Informational Tool for Chemical Regulation? Environmental Toxicology and Chemistry, 39(2), 257–268. https://doi.org/10.1002/etc.4611\n\n\nPolverino, G., Martin, J. M., Bertram, M. G., Soman, V. R., Tan, H., Brand, J. A., Mason, R. T., & Wong, B. B. M. (2021). Psychoactive pollution suppresses individual differences in fish behaviour. Proceedings of the Royal Society B: Biological Sciences, 288(1944), 20202294. https://doi.org/10.1098/rspb.2020.2294\n\n\nRoyauté, R., Buddle, C. M., & Vincent, C. (2015). Under the influence: Sublethal exposure to an insecticide affects personality expression in a jumping spider. Functional Ecology, 29(7), 962–970. https://doi.org/10.1111/1365-2435.12413",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Context of the study</span>"
    ]
  },
  {
    "objectID": "quarto/B_Growth_experiment.html",
    "href": "quarto/B_Growth_experiment.html",
    "title": "3  Longitudinal monitoring of earthworm growth exposed to a fungicide",
    "section": "",
    "text": "3.1 Earthworms",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Longitudinal monitoring of earthworm growth exposed to a fungicide</span>"
    ]
  },
  {
    "objectID": "quarto/B_Growth_experiment.html#earthworms",
    "href": "quarto/B_Growth_experiment.html#earthworms",
    "title": "3  Longitudinal monitoring of earthworm growth exposed to a fungicide",
    "section": "",
    "text": "3.1.1 Earthworm model - Aporrectodea caliginosa\nAporrectodea caliginosa (Figure 3.1) was the chosen biological model for it is considered highly representative of agricultural soil (Bart, 2018) and is part of the most sensitive agricultural species to pesticides (Pelosi et al., 2013). It is also a species we are able to cultivate under laboratory conditions (Section 3.1.2).\n\n\n\n\n\n\nFigure 3.1: Adult A. caliginosa individual.\n\n\n\nIts life cycle at 15°C is presented Figure 3.2.\n\n\n\n\n\n\nFigure 3.2: Aporrectodea caliginosa life cycle. Figure taken from Bart (2018)\n\n\n\n\n\n3.1.2 Eartworm cultivation\nIndividuals used were bred in the laboratory from individuals initially collected from an agricultural field in Estrée-Mons, France (49°52’ N, 3°01’ E) in 2019.\nIndividuals are bred at 18°C in 1 L vessels in groups of five individuals (Figure 3.3) using a loamy soil texture called Closeaux soil (based on the texture definition of the Food and Agriculture Organization of the United Nations (FAO)) (Table 3.1), sampled from a permanent grassland in Versailles (48°48′ N, 2°5′ E) where no pesticides have been applied for more than 25 years. Pesticides found in the soil are summarized in Figure 3.4. The soil was collected from the top 0-20 cm, air-dried and crushed to pass a 2 mm mesh. Soil culture is kept with a soil water-holding capacity (WHC) of 60-70% and individuals are fed with horse dung frost and defrosted twice before being milled (&gt; 1mm) as presented in Lowe & Butt (2005).\n\n\n\n\n\n\nFigure 3.3: Earthworm culture at the EcoSys laboratory in Palaiseau.\n\n\n\n\n\nCode\n# Data of measured pesticides concentrations in the Closeaux soil \ndf_PPPclx &lt;- read_excel(\n  here::here(\"data/Data_pesticides_closeaux_soil.xlsx\"), \n  sheet=\"Clx\"\n  ) |&gt;\n  mutate(Conc = round(C_calc, 2))\n\n# Separation per scale\n1df_PPPclx &lt;- df_PPPclx |&gt;\n  mutate(Molecule = fct_reorder(Molecule, Conc)) |&gt;\n  mutate(facet = case_when(Conc &lt;= 10 ~ 1,\n                           Conc &lt;= 100 & Conc &gt; 10 ~ 2,\n                           Conc &lt;= 1000 & Conc &gt; 100 ~ 3,\n                           Conc &lt;= 10000 & Conc &gt; 1000 ~ 4,\n                           Conc &lt;= 100000 & Conc &gt; 10000 ~5))\n\ndf_PPPclx_10     &lt;- df_PPPclx |&gt; subset(facet==1)\ndf_PPPclx_100    &lt;- df_PPPclx |&gt; subset(facet==2)\ndf_PPPclx_1000   &lt;- df_PPPclx |&gt; subset(facet==3)\ndf_PPPclx_10000  &lt;- df_PPPclx |&gt; subset(facet==4)\ndf_PPPclx_100000 &lt;- df_PPPclx |&gt; subset(facet==5)\n\nSize_text &lt;- 10\nsize_label &lt;- 2\n\nplot_1 &lt;- ggplot(\n  data=df_PPPclx_10, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x     = \"Pesticides\", \n    y     = \"Soil concentration (ng/kg)\",\n    title = \"Concentration of searched pesticides found in the cultivation soil\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(face=\"bold\", size=14)\n    )\n\n\nplot_2 &lt;- ggplot(\n  data=df_PPPclx_100, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x=\"Pesticides\", \n    y=\"Soil concentration (ng/kg)\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\nplot_3 &lt;- ggplot(\n  data=df_PPPclx_1000, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x=\"Pesticides\", \n    y=\"Soil concentration\\n (ng/kg)\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\nplot_4 &lt;- ggplot(\n  data=df_PPPclx_10000, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x=\"Pesticides\", \n    y=\"Soil concentration\\n (ng/kg)\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nplot_5 &lt;- ggplot(\n  data=df_PPPclx_100000, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x=\"Pesticides\", \n    y=\"Soil concentration\\n (ng/kg)\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n#plot\ngrid.arrange(plot_1, plot_2, plot_3, plot_4, plot_5,\n             ncol=3, \n             layout_matrix = cbind(c(1,1,2,2), \n                                   c(1,1,2,2), \n                                   c(1,1,3,4), \n                                   c(1,1,3,5)))\n\n\n\n1\n\nDivision of the pesticides in groups of similar concentration levels.\n\n\n\n\n\n\n\n\n\n\nFigure 3.4: Concentrations of pesticides found in the cultivation soil for our earthworms.\n\n\n\n\n\n\n\n\nTable 3.1: Closeaux soil characteristics\n\n\n\n\n\nCharacteristics\nValue\n\n\n\n\nClay (&lt; 2 µm, g/kg)\n226.0\n\n\nFine silt (2-20 µm, g/kg)\n174.1\n\n\nCoarse silt (20-50 µm, g/kg)\n298.9\n\n\nFine sand (50-200 µm, g/kg)\n239.1\n\n\nCoarse sand (200-2000 µm, g/kg)\n47.9\n\n\nCaCO3 total (g/kg)\n23.3\n\n\nOrganic matter (g/kg)\n32.6\n\n\nP2O5 (g/kg)\n0.1\n\n\nOrganic carbon (g/kg)\n18.9\n\n\nTotal nitrogen (N) (g/kg)\n1.5\n\n\nC/N\n12.7\n\n\npH\n7.5\n\n\nTotal Cu (mg/kg)\n25.2\n\n\n\n\n\n\nTo get synchronized cohorts of hatchlings, cocoons were collected in the breeding culture by wet sieving the soil through a 1-mm mesh size (Bart, 2018), and incubated at 18°C in Petri dishes on wet filter papers (Holmstrup et al., 1991) (Figure 3.5). Everyday, new hatchlings were collected and stored in soil at 4°C, to slow their development until the start of the experiment.\n\n\n\n\n\n\nFigure 3.5: Newly hatched juvenile ready to be put in a small cosm of soil.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Longitudinal monitoring of earthworm growth exposed to a fungicide</span>"
    ]
  },
  {
    "objectID": "quarto/B_Growth_experiment.html#growth-experiment-protocol",
    "href": "quarto/B_Growth_experiment.html#growth-experiment-protocol",
    "title": "3  Longitudinal monitoring of earthworm growth exposed to a fungicide",
    "section": "3.2 Growth experiment protocol",
    "text": "3.2 Growth experiment protocol\n\n3.2.1 Overview\nThe growth experiment was performed based on an adaptation of the protocol of Bart et al. (2020). We monitored the growth of 60 earthworms, each randomly allocated to exposed or unexposed conditions (30 individuals per treatment) in individual vessels, during a total of 56 days. Earthworms were individually weighted every 14 days (with their gut content).\nThe experiment was performed using the LUFA 2.4 soil, a standardized soil from Speyer. This soil was chosen for it is a loamy soil close to agricultural soils, with a pH of 7.5 and an organic carbon percentage of 1.83% (Table 3.2). It was maintained at 70% WHC by adding water from the surface. The soil was renewed after 28 days to keep earthworms in fresh soil and therefore in ideal conditions for growth. For the exposed cohort, it meant the pesticides concentrations were renewed after 28 days. We fed individuals every 14 days with 3 g of horse dung mixed to the soil, corresponding to ad libitum conditions. Similarly to our rearing protocol, individuals were kept in a thermoregulated enclosure at 18°C in complete darkness. Earthworms were individually placed in small High Density PolyEthylene vessels (5 cm x 5∅ cm) with 50 g of soil (dry weight).\n\n\n\nTable 3.2: LUFA 2.4 soil characteristics\n\n\n\n\n\n\n\n\n\n\n\n\n\nPhysicochemical characteristics\n\nParticle size (mm) distribution according to german DIN (%)\n\nParticle size (mm) distribution according to german USDA (%)\n\n\n\n\n\nOrganic carbon (% C)\n1.83 ± 0.17\n&lt; 0.002\n23.5 ± 1.0\n&lt; 0.002\n23.7 ± 1.4\n\n\nNitrogen (% N)\n0.23 ± 0.02\n0.002 - 0.006\n7.5 ± 0.7\n0.002 - 0.05\n42.2 ± 1.4\n\n\npH value (0.01 M CaCl2)\n7.5 ± 0.1\n0.006 - 0.02\n14.4 ± 1.2\n0.05 - 2\n33.1 ± 1.7\n\n\nCation exchange capacity (meq/100 g)\n17.4 ± 0.8\n0.02 - 0.063\n25.9 ± 1.7\nSoil type\nloam\n\n\nWater holding capacity (g/100 g)\n47.1 ± 1.9\n0.063 - 0.2\n21.5 ± 1.3\n\n\n\n\nWeight per volume (g/1000 mL)\n1182 ± 38\n0.2 - 0.63\n5.9 ± 1.9\n\n\n\n\n\n\n0.63 - 2.0\n1.3 ± 0.4\n\n\n\n\n\n\nSoil type\nsandy loam (sL)\n\n\n\n\n\n\n\n\nIn the pesticide treatment, we used a mixture of two molecules, , epoxiconazole (EPX) and dimoxystrobin (DMX), which are the main active substances of several pesticides, including the now banned, but largely used in the past, Swing® Gold (BASF Agro SAS, dimoxystrobin 133 g.L-1, epoxiconazole 50 g.L-1), a broad spectrum fungicide for cereal crops. Epoxiconazole is still frequently found in agricultural soils in France because of its persistance (Pelosi et al., 2021). Pesticide exposure in the exposed cohort was done by adding a diluted solution of DMX and EPX equivalent to 3 RD of Swing® Gold, a dose shown to have sublethal effects on A. caliginosa growth (Bart et al., 2020). Swing® Gold recommended dose (RD) is 1.5 L.ha-1. Considering that active substances of pesticides are mainly found in the first ten centimeters of soil (Chabauty et al., 2016; McDonald et al., 2013), and that the LUFA 2.4 soil has a density of 1.18, we calculated that the corresponding concentrations of the two molecules should be 165.0 µg of DMX per kg of dry soil and 190.3 µg of EPX per kg of dry soil. The dry soil was spiked with aqueous solutions of the mixture for contamination and to adjust its water holding capacity (WHC) to 70%.\n\n\n3.2.2 Detailed processes\n\n3.2.2.1 Preparation of soils and cosms\nThe soil is prepared the day prior to the day it is really renewed (D-1 and D27). To do so, we had primary solutions of epoxiconazole and dimoxystrobin in acetonitrile (396.0 mg/L and 384.61 mg/L respectively).\nWe used the following procedure to prepare the soils (Figure 3.6) :\nTo prepare the control soil :\n\nIn a large recipient, weight 2 kg of LUFA 2.4 soil previously put in an oven at 80°C for 48h to dry it;\nPrepare a solution of 659 mL of water with 3.5 µL of acetonitrile (to match the amount put in the contaminated soil);\nAdd this solution to the soil, do not mix;\nCover the recipient with an aluminum sheet and put it in a thermoregulated chamber at 18°C.\n\nTo prepare the contaminated soil :\n\nPrepare the secondary solutions of DMX and EPX (diluted 100 times) : The primary solution are taken out of the fridge for at least 30 min so the solutions go back to room temperature. For each molecule, take a 5 mL volumetric flask 3/4 filled with water, add 50 µL of the corresponding primary solution, mix and complete the volumetric flask with water.\nIn a large recipient, weight 2 kg of LUFA 2.4 soil previously put in an oven at 80°C for 48h to dry it;\nPut 500 mL of water in a 1l beaker;\nIn this beaker, add 257 µL of the secondary solution of DMX and 96 µL of the secondary solution of EPX;\nHomogeneously spray these 500 mL on top of the soil;\nUse 160 mL of water to rince the sprayer and spray it too;\nCover the recipient with an aluminum sheet and put it in a thermoregulated chamber at 18°C.\n\nAt D0 and D28, individual cosms are prepared with the soil preparations and the addition of horse dung.\nTo prepare the cosms :\n\nWeight and humidify horse dung at 70% of its WHC (WHC 100% = 304 mL);\nAdd, in each cosm, 9.1 g of this horse dung preparation;\nMix the prepared soil;\nAdd 66.5 g of soil in each cosm;\nMix the soil with the horse dung;\nWeigth the earthworm. To do so, earthworms are rinced in a cup of water to remove any soil particules and then softely dried on paper towel before being weighted on a precision balance (Figure 3.7).\nPut the earthworm in its corresponding cosm;\nWeight the overall weight of the cosm and note it on its lid;\nPut the cosms in thermoregulated chambers at 18°C.\n\nEach time, soil samples are kept at 20°C for chemical analysis.\n\n\n\n\n\n\nFigure 3.6: Preparation of the small cosms.\n\n\n\n\n\n3.2.2.2 Maintenance\nEach week, the WHC is adjusted thanks to the overall weight of the cosm noted right after it was prepared. Water is added to the surface of the soil to reach this weight again.\nEach 14 days, earthworms are weighted.\n\n\n\n\n\n\nFigure 3.7: Weighting of a juvenile earthworm.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Longitudinal monitoring of earthworm growth exposed to a fungicide</span>"
    ]
  },
  {
    "objectID": "quarto/B_Growth_experiment.html#results-of-the-growth-experiment",
    "href": "quarto/B_Growth_experiment.html#results-of-the-growth-experiment",
    "title": "3  Longitudinal monitoring of earthworm growth exposed to a fungicide",
    "section": "3.3 Results of the growth experiment",
    "text": "3.3 Results of the growth experiment\nData from this experiment can be found in this repository : “data\\Data_growth_EPX_DMX.xlsx”\nVariables names :\n\ndate : Date of the measurement\nID : Identification number of the earthworm\nbirth_date: Birthday of the earthworm\nt : Number of days since the start of the exposition\nw : Fresh weight of the earthworm (mg)\nexposition :\n\n“Ctrl” : non exposed\n“Trt” : exposed\n\nstatus :\n\n“J” : Juvenile\n“A” : Adulte\n“D” : Dead\n\n\n\n\nCode\n1df_growth &lt;- read_excel(\n  here::here(\"data/Data_growth_EPX_DMX.xlsx\"),\n  sheet=\"Growth\"\n  ) |&gt;\n  mutate(L=w^(1/3))\n\ndf_growth$ID &lt;- as.factor(df_growth$ID)\n\n2df_growth_mean &lt;- df_growth |&gt;\n  aggregate(w~t+exposition, mean)\n\n3df_growth_t0 &lt;- df_growth |&gt; subset(t==0)\n\n\n\n1\n\nRaw data importation and calculation of structural lengths\n\n2\n\nCreation of a dataset with the mean growth per exposition group\n\n3\n\nInitial weights dataset\n\n\n\n\n\n3.3.1 Initial state\nWe can first take a look at the initial weights of individuals in each cohort (Figure 3.8).\n\n\nCode\np &lt;- ggplot(\n  data=df_growth_t0, \n  aes(\n    x=exposition, \n    y=w, \n    color=exposition, \n    fill=exposition\n    )\n  )+\n  geom_boxplot(alpha=0)+\n  geom_dotplot(\n    binaxis='y', \n    stackdir='center', \n    dotsize=0.7, \n    alpha=0.5\n    )+\n  \n  labs(\n    x=\"\", \n    y=\"Weight (mg)\",\n    title = \"The &lt;span style = 'color:#5E81AC;'&gt;non exposed&lt;/span&gt; and &lt;span style = 'color:#f42404;'&gt;exposed&lt;/span&gt; cohorts have &lt;br/&gt; similar initial weight distributions\"\n    )+\n  \n  scale_color_manual(\n    name=\"Exposition\",\n    values=pal_col, \n    labels=c(\"Non exposed\", \"Exposed\")\n    )+\n  scale_fill_manual(\n    name=\"Exposition\",\n    values=pal_col, \n    labels=c(\"Non exposed\", \"Exposed\")\n    )+\n  \n  theme_classic(14)+\n  theme(\n    \n    plot.title = element_markdown(face=\"bold\"),\n    title=element_text(size=sizetitle, face=\"bold\"), \n    \n    legend.position = \"none\",\n    legend.title=element_text(size=sizetitle-2,face=\"bold\"),\n    legend.text = element_text(size=sizetitle-2,face=\"plain\"),\n    \n    axis.title.x = element_blank(),\n    axis.text.x = element_blank(),\n    axis.line.x=element_blank(),\n    axis.ticks.x=element_blank(),\n    \n    axis.title.y = element_text(size=sizetitle,face=\"plain\")\n    )\np\n\n\n\n\n\n\n\n\nFigure 3.8: Initial weight distribution in each group.\n\n\n\n\n\nWe can test the normality of the weight distribution in each cohort :\n\n\nCode\n1shapiro.test(subset(df_growth_t0, exposition==\"Ctrl\")$w)\nshapiro.test(subset(df_growth_t0,exposition==\"Trt\")$w)\n\n\n\n1\n\nNormality tests with the shapiro test. If the test isn’t sinificant, the dataset is not inconsistent with a Gaussian distribution.\n\n\n\n\n\n    Shapiro-Wilk normality test\n\ndata:  subset(df_growth_t0, exposition == \"Ctrl\")$w\nW = 0.93247, p-value = 0.05714\n\n\n    Shapiro-Wilk normality test\n\ndata:  subset(df_growth_t0, exposition == \"Trt\")$w\nW = 0.9873, p-value = 0.9696\n\n\nTherefore, these two datasets are not inconsistent with a Gaussian distribution.\nWe can test for variance homogeneity :\n\n\nCode\nvar.test(\n  subset(df_growth_t0, exposition==\"Ctrl\")$w, \n  subset(df_growth_t0, exposition==\"Trt\")$w\n1  )\n\n\n\n1\n\nVariance homogeneity test with a F-test. If the test isn’t sinificant, the dataset is not inconsistent with a ratio of variances equal to 1.\n\n\n\n\n\n    F test to compare two variances\n\ndata:  subset(df_growth_t0, exposition == \"Ctrl\")$w and subset(df_growth_t0, exposition == \"Trt\")$w\nF = 1.1901, num df = 29, denom df = 29, p-value = 0.6424\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.5664681 2.5004941\nsample estimates:\nratio of variances \n          1.190147 \n\n\nThe datasets are not inconsistent with a ratio of variances equal to 1.\nThen, we can test if there is an effect of the cohort on the initial weight of individuals with a t-test :\n\n\nCode\n1t.test(df_growth_t0$w~df_growth_t0$exposition, var.equal=T)\n\n\n\n1\n\nT-test : If the test is significant, the dataset is not inconsistent with an effect of the group on the initial weight of individuals.\n\n\n\n\n\n    Two Sample t-test\n\ndata:  df_growth_t0$w by df_growth_t0$exposition\nt = -0.024192, df = 58, p-value = 0.9808\nalternative hypothesis: true difference in means between group Ctrl and group Trt is not equal to 0\n95 percent confidence interval:\n -1.953987  1.907321\nsample estimates:\nmean in group Ctrl  mean in group Trt \n          12.41333           12.43667 \n\n\nWe can conclude there is no effect of the cohort on the initial weight of the individuals.\n\n\n3.3.2 Growth of individuals\n\n\nCode\n# We go back from the raw data to do a general summary\ndf_growth_ctrl &lt;- subset(df_growth,exposition==\"Ctrl\")\ndf_growth_trt &lt;- subset(df_growth,exposition==\"Trt\")\n\ndf_growth_ctrl_mean &lt;- subset(df_growth_mean,exposition==\"Ctrl\")\ndf_growth_trt_mean &lt;- subset(df_growth_mean,exposition==\"Trt\")\n\nN_Sample &lt;- c(\n  n_distinct(df_growth_ctrl[df_growth_ctrl$t==0,]$ID),\n  n_distinct(df_growth_trt[df_growth_trt$t==0,]$ID)\n  )\n \nN_dead_D56 &lt;- c(\n  n_distinct(subset(df_growth_ctrl, t==56 & status==\"D\")$ID), \n  n_distinct(subset(df_growth_trt, t==56 & status==\"D\")$ID)\n  )\n\nMean_w_init &lt;- c(\n  subset(df_growth_ctrl_mean, t==0)$w, \n  subset(df_growth_trt_mean, t==0)$w\n  )\n\nC95_w_init &lt;- c(\n  quantile(subset(df_growth_ctrl, t==0)$w, c(0.025, 0.975)), \n  quantile(subset(df_growth_trt, t==0)$w, c(0.025, 0.975))\n  )\n\nMean_w_D56 &lt;- c(\n  subset(df_growth_ctrl_mean, t==56)$w, \n  subset(df_growth_trt_mean, t==56)$w\n  )\n\nC95_w_D56 &lt;- c(\n  quantile(subset(df_growth_ctrl, t==56)$w, c(0.025, 0.975), na.rm=TRUE), \n  quantile(subset(df_growth_trt, t==56)$w, c(0.025, 0.975), na.rm=TRUE)\n  )\n\nAbsolute_growth_rates &lt;- cbind(\n  (subset(df_growth_ctrl, t==56)$w-subset(df_growth_ctrl, t==0)$w)/56, \n  (subset(df_growth_trt, t==56)$w-subset(df_growth_trt, t==0)$w)/56\n  )\n\nMean_a &lt;- c(\n  mean(Absolute_growth_rates[,1], na.rm=TRUE), \n  mean(Absolute_growth_rates[,2], na.rm=TRUE)\n  )\n\nC95_a &lt;- c(\n  quantile(Absolute_growth_rates[,1], c(0.025, 0.975), na.rm=TRUE), \n  quantile(Absolute_growth_rates[,2], c(0.025, 0.975), na.rm=TRUE)\n  )\n\n\ndf_summary &lt;- data.frame(\n  Cohort = c(\"Non exposed\", \"Exposed\"),\n  N_sample=N_Sample,\n  N_dead=N_dead_D56,\n  w_init=paste(\n    round(Mean_w_init,1), \n    \" [\",round(C95_w_init[1],1),\n    \" ; \",round(C95_w_init[2],1),\"]\"\n    , sep=\"\"\n   ),\n  Mean_w_D56=paste(\n    round(Mean_w_D56,1),\n    \" [\",round(C95_w_D56[1],1),\n    \" ; \",round(C95_w_D56[2],1),\"]\"\n    , sep=\"\"\n    ),\n  Mean_a=paste(\n    round(Mean_a,1),\n    \" [\",round(C95_a[1],1),\n    \" ; \",round(C95_a[2],1),\"]\"\n    , sep=\"\"\n    )\n  )\n\ncolnames(df_summary) &lt;- c(\n  \"Cohort\", \n  \"Sample size\", \n  \"Number of dead individuals\", \n  \"Initial weight {2.5% ; 97.5%  quantiles} (mg)\", \n  \"Weight after 56 days (mg)\", \n  \"Absolute growth rate (mg/d)\"\n  )\n\ndf_summary &lt;- as.data.frame(t(df_summary)) \nnames(df_summary) &lt;- as.character(df_summary[1,])\ndf_summary &lt;- df_summary[-1,]\n\ndf_summary |&gt; datatable(options = list(dom = 't'), class=\"hover\")%&gt;%\n  formatStyle(columns = colnames(df_summary), textAlign = \"left\") \n\n\n\n\nTable 3.3: Summary of the collected growth data.\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Survival curves\n1df_growth &lt;- df_growth |&gt;\n  mutate(dead = case_when(\n    status == \"D\" ~ 1,\n    status %in% c(\"J\", \"S\", \"A\") ~ 0)\n    )\n\n2df_surv &lt;- df_growth |&gt;\n  arrange(t) |&gt;\n  group_by(t,exposition) |&gt;\n  summarise(\n    n = n(),\n    n_dead = sum(dead),\n    n_alive = n - n_dead,\n    survival_prob = cumprod((n_alive/n))\n  ) |&gt;\n  ungroup()\n\n\n# Survival curve plot\np_surv &lt;- ggplot(\n  df_surv, \n  aes(\n    x = t, \n    y = n_alive, \n    color=exposition\n    )\n  ) +\n  \n  geom_step(linewidth = 1.2) +\n  \n  scale_color_manual(values=c(col_blue, col_red), labels = c(\"Non-exposed\", \"Exposed\"))+\n  scale_fill_manual(name = \"Exposition\", values=c(col_blue, col_red))+\n  \n  lims(\n    y=c(0,30), \n    x=c(0,56)\n      ) +\n  \n  labs(\n    #title = \"Survival curves\",\n    x = \"Time (days)\",\n    y = \"Number of alive earthworms\"\n    ) +\n  \n  scale_y_continuous(\n    limits = c(0, 30),  \n    breaks = seq(0, 30, by = 5),  \n    minor_breaks = seq(0, 30, by = 1) \n  ) +\n  \n  scale_x_continuous(\n    limits = c(0, 56),       \n    breaks = seq(0, 56, by = 28),\n    minor_breaks = seq(0, 56, by = 14) \n  ) +\n  \n  theme_minimal(12)+\n  theme(\n    legend.position = \"bottom\", \n    \n    plot.title=element_text(size=sizetitle, face=\"bold\"),\n    \n    axis.title.x = element_text(face=\"plain\"), \n    axis.title.y = element_text(face=\"plain\"),\n    \n    panel.grid.major.y = element_line(color = \"gray70\", size = 0.3),\n    panel.grid.minor.y = element_line(color = \"gray90\", size = 0.2), \n    )\n\np_surv\n\n\n\n1\n\nAddition of dead status column.\n\n2\n\nCalculation of number of alive individual per group throughout time.\n\n\n\n\n\n\n\n\n\n\nFigure 3.9: Survival curves for both cohorts.\n\n\n\n\n\n\n\nCode\nalpha_point &lt;- 0.5\nalpha_line &lt;- 0.3\n\nplot &lt;- ggplot(\n  data=df_growth, \n  aes(\n    x=t, \n    y=w, \n    color=exposition, \n    group=as.factor(ID)\n    )\n  )+\n  \n  facet_wrap(~exposition)+\n  \n  geom_point(alpha=alpha_point, size=2)+\n  geom_line(lwd=0.8, alpha=alpha_line)+\n  \n  scale_color_manual(\n    values = pal_col, \n    label  = c(\"Non exposed\", \"Exposed\"), \n    name   = \"\"\n    )+\n  \n  labs(\n    x=\"Time (days)\", \n    y=\"Weight (mg)\",\n    title = \"Growth monitoring of the first 56 days\",\n    subtitle = \"For the &lt;span style = 'color:#5E81AC;'&gt;non exposed&lt;/span&gt; and &lt;span style = 'color:#f42404;'&gt;exposed&lt;/span&gt; groups\"\n    )+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  ylim(0, max(df_growth$w, na.rm=T))+\n  \n  theme_minimal(12) +\n  theme(\n    legend.position = \"none\",\n    \n    title=element_markdown(face=\"bold\"),\n    plot.subtitle=element_markdown(face=\"plain\"),\n    \n    axis.title=element_text(face=\"plain\"),\n    \n    strip.background = element_blank(),\n    strip.text = element_blank()\n    )\n\nplot\n\n\n\n\n\n\n\n\nFigure 3.10: Evolution of fresh body weight of non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points and thin lines, each line corresponding to one individual).\n\n\n\n\n\n\n\nCode\n# Comparison of the final mean weight in the two groups\n\n1var.test(\n  subset(df_growth, exposition==\"Ctrl\" & t==56)$w,\n  subset(df_growth, exposition==\"Trt\"& t==56)$w\n  )\n\n2Test &lt;- t.test(\n  df_growth$w ~ df_growth$exposition,\n  var.equal=F\n  )\n\nTest\nTest_p_val &lt;- round(Test$p.value,2)\n\n\n\n1\n\nTest of the variance homogeneity hypothesis.\n\n2\n\nWelsh two sample t-test\n\n\n\n\n\n    F test to compare two variances\n\ndata:  subset(df_growth, exposition == \"Ctrl\" & t == 56)$w and subset(df_growth, exposition == \"Trt\" & t == 56)$w\nF = 0.40594, num df = 26, denom df = 24, p-value = 0.02697\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.1807097 0.9001427\nsample estimates:\nratio of variances \n         0.4059418 \n\n\n    Welch Two Sample t-test\n\ndata:  df_growth$w by df_growth$exposition\nt = 0.10208, df = 266.67, p-value = 0.9188\nalternative hypothesis: true difference in means between group Ctrl and group Trt is not equal to 0\n95 percent confidence interval:\n -30.40347  33.72831\nsample estimates:\nmean in group Ctrl  mean in group Trt \n          127.4268           125.7644 \n\n\nThe final mean weights do not differ significatively between the two cohorts (Welsh Two Sample t-test, p-value = 0.92).\n\n Session Information \n\n\n\n\n\nCode\nsessionInfo()\n\n\nR version 4.2.2 (2022-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS 14.0\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n [1] parallel  grid      stats4    stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] devtools_2.4.5     usethis_2.2.3      readxl_1.4.3       DT_0.33           \n [5] kableExtra_1.4.0   knitr_1.47         latex2exp_0.9.6    nlstools_2.1-0    \n [9] lsmeans_2.30-0     emmeans_1.10.3     Hmisc_5.1-3        car_3.1-2         \n[13] carData_3.0-5      modelsummary_2.2.0 extrafont_0.19     gridExtra_2.3     \n[17] ggpubr_0.6.0       plotly_4.10.4      ggtext_0.1.2       ggbreak_0.1.2     \n[21] cowplot_1.1.3      patchwork_1.2.0    ggdist_3.3.2       nord_1.0.0        \n[25] RColorBrewer_1.1-3 wesanderson_0.3.7  viridis_0.6.5      viridisLite_0.4.2 \n[29] ggthemes_5.1.0     see_0.8.4.3        report_0.5.8       parameters_0.22.2 \n[33] performance_0.12.0 modelbased_0.8.8   insight_0.20.4     effectsize_0.8.8  \n[37] datawizard_0.11.0  correlation_0.8.5  bayestestR_0.13.2  easystats_0.7.2   \n[41] deSolve_1.40       priorsense_1.0.4   truncnorm_1.0-9    tmvtnorm_1.6      \n[45] gmm_1.8            sandwich_3.1-0     Matrix_1.6-5       mvtnorm_1.2-5     \n[49] fdrtool_1.2.17     tidybayes_3.0.6    ggmcmc_1.5.1.1     glmmTMB_1.1.9     \n[53] rstan_2.32.6       StanHeaders_2.32.9 cmdstanr_0.8.0     brms_2.22.0       \n[57] Rcpp_1.0.12        plan_0.4-5         reshape2_1.4.4     lubridate_1.9.3   \n[61] forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2       \n[65] readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1     \n[69] tidyverse_2.0.0    here_1.0.1        \n\nloaded via a namespace (and not attached):\n  [1] utf8_1.2.4           tidyselect_1.2.1     lme4_1.1-31         \n  [4] htmlwidgets_1.6.4    munsell_0.5.1        ragg_1.3.2          \n  [7] codetools_0.2-20     miniUI_0.1.1.1       withr_3.0.0         \n [10] Brobdingnag_1.2-9    colorspace_2.1-0     tables_0.9.28       \n [13] rstudioapi_0.16.0    ggsignif_0.6.4       Rttf2pt1_1.3.12     \n [16] bayesplot_1.11.1     labeling_0.4.3       farver_2.1.2        \n [19] bridgesampling_1.1-2 rprojroot_2.0.4      coda_0.19-4.1       \n [22] vctrs_0.6.5          generics_0.1.3       TH.data_1.1-2       \n [25] xfun_0.45            timechange_0.3.0     markdown_1.13       \n [28] R6_2.5.1             cachem_1.1.0         gridGraphics_0.5-1  \n [31] promises_1.3.0       scales_1.3.0         multcomp_1.4-25     \n [34] nnet_7.3-19          gtable_0.3.5         processx_3.8.4      \n [37] rlang_1.1.4          systemfonts_1.1.0    splines_4.2.2       \n [40] rstatix_0.7.2        extrafontdb_1.0      TMB_1.9.11          \n [43] lazyeval_0.2.2       broom_1.0.6          checkmate_2.3.1     \n [46] inline_0.3.19        yaml_2.3.8           abind_1.4-5         \n [49] crosstalk_1.2.1      backports_1.5.0      httpuv_1.6.15       \n [52] gridtext_0.1.5       tensorA_0.36.2.1     tools_4.2.2         \n [55] ggplotify_0.1.2      ellipsis_0.3.2       jquerylib_0.1.4     \n [58] posterior_1.6.0      sessioninfo_1.2.2    plyr_1.8.9          \n [61] base64enc_0.1-3      ps_1.7.6             rpart_4.1.23        \n [64] urlchecker_1.0.1     zoo_1.8-12           cluster_2.1.6       \n [67] fs_1.6.4             magrittr_2.0.3       data.table_1.15.4   \n [70] matrixStats_1.3.0    pkgload_1.4.0        mime_0.12           \n [73] hms_1.1.3            evaluate_0.24.0      arrayhelpers_1.1-0  \n [76] xtable_1.8-4         rstantools_2.4.0     compiler_4.2.2      \n [79] V8_4.4.2             minqa_1.2.7          htmltools_0.5.8.1   \n [82] later_1.3.2          ggfun_0.1.6          mgcv_1.9-1          \n [85] tzdb_0.4.0           Formula_1.2-5        aplot_0.2.3         \n [88] RcppParallel_5.1.7   MASS_7.3-58.1        boot_1.3-30         \n [91] cli_3.6.3            pkgconfig_2.0.3      numDeriv_2016.8-1.1 \n [94] foreign_0.8-87       xml2_1.3.6           svUnit_1.0.6        \n [97] svglite_2.1.3        bslib_0.7.0          QuickJSR_1.2.2      \n[100] ggstats_0.6.0        estimability_1.5.1   yulab.utils_0.1.7   \n[103] distributional_0.4.0 digest_0.6.36        cellranger_1.1.0    \n[106] rmarkdown_2.27       htmlTable_2.4.2      curl_5.2.1          \n[109] commonmark_1.9.1     shiny_1.8.1.1        nloptr_2.0.3        \n[112] lifecycle_1.0.4      nlme_3.1-160         jsonlite_1.8.8      \n[115] fansi_1.0.6          pillar_1.9.0         lattice_0.22-6      \n[118] loo_2.8.0            GGally_2.2.1         fastmap_1.2.0       \n[121] httr_1.4.7           pkgbuild_1.4.4       survival_3.7-0      \n[124] remotes_2.5.0        glue_1.7.0           sass_0.4.9          \n[127] profvis_0.3.8        stringi_1.8.4        textshaping_0.4.0   \n[130] memoise_2.0.1       \n\n\n\n\n\n\n\n\n\n\nBart, S. (2018). Impacts comportementaux, démographiques et fonctionnels des pesticides sur des annélides oligochètes du sol. Université Paris-Saclay.\n\n\nBart, S., Pelosi, C., Nélieu, S., Lamy, I., & Péry, A. R. R. (2020). An energy-based model to analyze growth data of earthworms exposed to two fungicides. Environmental Science and Pollution Research, 27(1), 741–750. https://doi.org/10.1007/s11356-019-06985-z\n\n\nChabauty, F., Pot, V., Bourdat-Deschamps, M., Bernet, N., Labat, C., & Benoit, P. (2016). Transport of organic contaminants in subsoil horizons and effects of dissolved organic matter related to organic waste recycling practices. Environmental Science and Pollution Research, 23(7), 6907–6918. https://doi.org/10.1007/s11356-015-5938-9\n\n\nHolmstrup, M., Ostergaard, I. K., Nielsen, A., & Hansen, B. T. (1991). The relationship between temperature and cocoon incubation time for some lumbricid earthworm species. Pedobiologia. http://archive.org/details/holmstrup-et-al.-1991\n\n\nLowe, C. N., & Butt, K. R. (2005). Culture techniques for soil dwelling earthworms: A review. Pedobiologia, 49(5), 401–413. https://doi.org/10.1016/j.pedobi.2005.04.005\n\n\nMcDonald, J., Gaston, L., Elbana, T., Andres, K., & Cranfield, E. (2013). Dimoxystrobin sorption and degradation in sandy loam soil: Impact of different landscape positions. Soil Science, 178, 662–670. https://doi.org/10.1097/SS.0000000000000030\n\n\nPelosi, C., Joimel, S., & Makowski, D. (2013). Searching for a more sensitive earthworm species to be used in pesticide homologation tests – A meta-analysis. Chemosphere, 90(3), 895–900. https://doi.org/10.1016/j.chemosphere.2012.09.034\n\n\nPelosi, C., Thiel, P., Bart, S., Amossé, J., Jean-Jacques, J., Thoisy, J.-C., & Crouzet, O. (2021). The contributions of enchytraeids and earthworms to the soil mineralization process in soils with fungicide. Ecotoxicology, 30(9), 1910–1921. https://doi.org/10.1007/s10646-021-02452-z",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Longitudinal monitoring of earthworm growth exposed to a fungicide</span>"
    ]
  },
  {
    "objectID": "quarto/C_Model_def_sim_data.html",
    "href": "quarto/C_Model_def_sim_data.html",
    "title": "4  A model for earthworm growth and its individual variation",
    "section": "",
    "text": "4.1 Model definition\nTo evaluate individual variations in growth and fungicide sensitivity parameters, a simplified version of the bioenergetic model from Bart et al. (2020) was developed.\nWe used an individual reaction norm approach (Dingemanse & Dochtermann, 2013) to compare growth rate across exposed and non-exposed individuals. As indicated by (Bart et al., 2020), A. caliginosa growth is approximately linear with the structural volumetric length \\(L\\) during the juvenile phase of the life-cycle. This structural volumetric length can be calculated as the cubic root of the wet weight of the organisms.\nHere, we assume that both cohorts can have a different growth rate \\(a\\) (mg\\(^{1/3}\\)/d). We suppose the structural volumetric length at the start of the experiment (\\(L0\\)) does not depend on the treatment as individuals came from the same pool of individuals.\nTo take individual variations for both parameters, we assume that each parameter can be considered as a random variable described by a normal distribution whose mean is the population-level value of the parameter and the standard deviation is the individual variation of the parameter. Each individual can then have a parameter value that is taken from this normal distribution.\nThis gives us Equation 4.1.\n\\[\n\\begin{aligned}\nL_{c,i} &\\sim \\mathcal{N}(L_{\\mu,c,i}, \\sigma_L)\\\\\nL_{\\mu,c,i}(t)&=L0_i+a_{c,i}\\times t \\\\\n\\text{With}\\\\\nL0_{i} &\\sim \\mathcal{N}(L0_{\\mu}, L0_{\\sigma})\\\\\na_{c,i} &\\sim \\mathcal{N}(a_{c,\\mu}, a_{c,\\sigma})\n\\end{aligned}\n\\tag{4.1}\\]\nWith :\nOur model is implemented with the brms package which means this mathematical formulation translate to the following formula in the brms language :",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>A model for earthworm growth and its individual variation</span>"
    ]
  },
  {
    "objectID": "quarto/C_Model_def_sim_data.html#model-definition",
    "href": "quarto/C_Model_def_sim_data.html#model-definition",
    "title": "4  A model for earthworm growth and its individual variation",
    "section": "",
    "text": "\\(i\\) : the individual under a certain exposure \\((i \\in [\\![1,60]\\!]),\\)\n\\(c\\) : the exposition concentration (0 or 3 RD),\n\\(L_{c,i}(t)\\) : the cubic root of the wet body weight of individual i exposed to the concentration \\(c\\) at a given time \\(t\\) (mg\\(^{1/3}\\)),\n\\(L_{\\mu,c,i}(t)\\) : the expected cubic root of the wet body weight of individual \\(i\\) exposed to the concentration \\(c\\) at time \\(t\\),\n\\(\\sigma_L\\) : standard deviation of residuals on \\(L_{c,i}\\), representing the variability not captured by the growth model,\n\\(L0_i\\) : the cubic root of the wet body weight at t=0 (mg\\(^{1/3}\\)),\n\\(a_{c,i}\\) : the growth rate (mg\\(^{1/3}\\)/d) of the individual \\(i\\) exposed to the concentration \\(c\\),\n\\(L0_{\\mu}\\) : mean of the normal distribution for the initial wet body weight (\\(L0_i\\)),\n\\(L0_{\\sigma}\\) : standard deviation of the normal distribution for the initial wet body weight (\\(L0_i\\)),\n\\(a_{c,\\mu}\\) : mean of the normal distribution for the growth rate (\\(a_{c,i}\\)),\n\\(a_{c,\\sigma}\\) : standard deviation of the normal distribution for the growth rate (\\(a_{c,i}\\)).\n\n\n\nL  ~ L0+a*t\n\nL0 ~ 1 + (1||ID)\n\na  ~ 0 + exposition+(0+exposition||ID)\n\n\nLigne 1 specify the general formula for \\(L\\),\nLigne 2 specify there is an intercept plus a random effect of ID on \\(L0\\), in other words that \\(L0\\) is definied by a population mean and inter-individual variation,\nLigne 3 specify that a depend on exposition and that there is a random effect on \\(a\\) that depends on the exposition, in other words that \\(a\\) is definied by a population mean and inter-individual variation and these depend on the exposition.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>A model for earthworm growth and its individual variation</span>"
    ]
  },
  {
    "objectID": "quarto/C_Model_def_sim_data.html#parameter-recovery-with-simulated-data",
    "href": "quarto/C_Model_def_sim_data.html#parameter-recovery-with-simulated-data",
    "title": "4  A model for earthworm growth and its individual variation",
    "section": "4.2 Parameter recovery with simulated data",
    "text": "4.2 Parameter recovery with simulated data\nA first step is to look at the parameter recovery with a fit on simulated data.\n\n4.2.1 Data simulation\nAccording to Bart et al. (2020), earthworm initial size is 2.25 mg\\(^{1/3}\\) (\\(L0\\)) with a standard deviation of 0.45 mg\\(^{1/3}\\) and grow at xxx mg\\(^{1/3}\\)/day (\\(a\\)). Next, we simulate data according to a variation attenuation scenario. To do so, we assume that the average growth rate in earthworms exposed to 3 RD of Swing Gold decreases by 10 % compared to a control cohort, as shown in Bart et al. (2020). We set the individual variability in the control group to 10% around the average growth rate which is coherent with Bart’s data. We set the change in among-individiual variance to 50 %, which would correspond to a moderate effect size of pesticide exposure on growth rate variation.\nThis gives us the following simulation parameters :\n\n\\(L0_{\\mu}\\) = 2.25 mg\\(^{1/3}\\)\n\\(a_{ctrl,\\mu}\\) = 0.075 mg\\(^{1/3}\\)/d\n\\(a_{trt,\\mu}\\) = 0.0675 mg\\(^{1/3}\\)/d\n\\(a_{ctrl,\\sigma}\\) = 0.0075 mg\\(^{1/3}\\)/d\n\\(a_{trt,\\sigma}\\) = 0.008775 mg\\(^{1/3}\\)/d\n\nIn parallel, the simulated pesticides effect can be expressed with a response ratio (Ln(RR), Equation 5.1) and a coefficient of variation ratio (Ln(CVi), Equation 5.2).\n\\[\n\\text{Ln}(\\text{RR}) = \\text{Ln}\\left( \\frac{a_{ctrl,\\mu}}{a_{trt,\\mu}} \\right)\n\\tag{4.2}\\]\n\\[\n\\text{Ln}(\\text{CVi}) = \\text{Ln}\\left( \\frac{CV_{ctrl}}{CV_{trt}} \\right)\\\\\n\\tag{4.3}\\]\nWith :\n\\[\nCV_{x}=\\frac{a_{x,\\sigma}}{a_{x,\\mu}}\n\\]\n\n\nCode\n1nb_ind_sim &lt;- 30\n\nset.seed(242412)\n\na_ctrl_mu_mu &lt;- 0.075\na_ctrl_mu_sd &lt;- a_ctrl_mu_mu*0.1\na_trt_mu_mu &lt;- 0.0675\na_trt_mu_sd &lt;- a_ctrl_mu_mu*0.1*(1+0.5)\nL0_mu &lt;- 2.25\nL0_sd &lt;- 0.45\n\n2List_a_i_ctrl &lt;- rnorm(\n  nb_ind_sim,\n  a_ctrl_mu_mu,\n  a_ctrl_mu_sd\n  )\n\n3List_a_i_trt &lt;- rnorm(\n  nb_ind_sim,\n  a_trt_mu_mu,\n  a_trt_mu_sd\n  )\n\n4List_L0_i &lt;- rnorm(\n  nb_ind_sim*2,\n  L0_mu,\n  L0_sd\n  )\n\n\n5df_pop_sim &lt;- data.frame(\n  ID = seq(1, nb_ind_sim*2, 1),\n  L0_i = List_L0_i,\n  a_i = c(List_a_i_ctrl, List_a_i_trt),\n  exposition = c(\n    rep(0, nb_ind_sim),\n    rep(1, nb_ind_sim)\n    )\n  )\n\n# Real pop values \n6sim_a_ctrl_mu &lt;- with(subset(df_pop_sim, exposition == 0), mean(a_i))\nsim_a_ctrl_sd &lt;- with(subset(df_pop_sim, exposition == 0), sd(a_i))\nsim_a_trt_mu &lt;- with(subset(df_pop_sim, exposition == 1), mean(a_i))\nsim_a_trt_sd &lt;- with(subset(df_pop_sim, exposition == 1), sd(a_i))\nsim_L0_mu &lt;- with(df_pop_sim, mean(L0_i))\nsim_L0_sd &lt;- with(df_pop_sim, sd(L0_i))\n\n7sim_LnRR &lt;- log(sim_a_trt_mu/sim_a_ctrl_mu)\nsim_LnCVi &lt;- log((sim_a_trt_sd/sim_a_trt_mu)/(sim_a_ctrl_sd/sim_a_ctrl_mu))\n\ntmp &lt;- sim_a_trt_sd/sim_a_ctrl_sd\n\n\n\n1\n\nNumber of individuals in each populations.\n\n2\n\nSimulation of the growth rates of non exposed individuals.\n\n3\n\nSimulation of the growth rates of exposed individuals.\n\n4\n\nSimulation of the initial structural length.\n\n5\n\nDataframe with all individuals from both populations. (0 = Non exposed, 1 = Exposed)\n\n6\n\nCalculation of the real parameters values in the simulated population.\n\n7\n\nCalculation of Ln(RR) and Ln(CVi).\n\n\n\n\n\n\nCode\n# Times with weight measurements\nt_values &lt;- seq(0, 56, 14)\n# Approximate error on L\nsd &lt;- 0.1\n\n# Calculation of each earthworm weight at each time point\ndf_sim &lt;- df_pop_sim |&gt; \n  expand_grid(t = t_values) |&gt;   \n  mutate(\n    Lhat = L0_i + a_i * t\n  ) |&gt;   \n  mutate(\n    L = rtruncnorm(n = n(), mean = Lhat, sd = sd, a = 0),\n    w = L^3\n  ) |&gt;\n  mutate(\n    exposition = as.factor(exposition),\n    ID = as.factor(ID)\n  )\n\n\n\n\nCode\nalpha_point &lt;- 0.5\nalpha_line &lt;- 0.3\n\np_growth &lt;- ggplot() +\n  \n  geom_line(\n    data=df_sim, \n    aes(\n      x=t, \n      y=w, \n      color=exposition, \n      group=ID\n      ),\n    lwd=0.8, \n    alpha=alpha_line, \n    color = \"grey80\"\n    ) +\n  geom_point(\n    data=df_sim, \n    aes(\n      x=t, \n      y=w, \n      color=exposition, \n      group=ID\n      ),\n    alpha=alpha_point, \n    size=2\n    ) +\n\n\n  facet_wrap(~exposition) +\n  \n  scale_color_manual(\n    values = pal_col, \n    label  = c(\"Non exposed\", \"Exposed\"), \n    name   = \"\"\n    ) +\n  \n  labs(\n    x         = \"Time (days)\", \n    y         = \"Weight (mg)\",\n    title     = \"Growth of simulated individuals\",\n    subtitle  = \"For the &lt;span style = 'color:#5E81AC;'&gt;non exposed&lt;/span&gt; \n       and &lt;span style = 'color:#f42404;'&gt;exposed&lt;/span&gt; groups\"\n    )+\n  \n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_minimal(12)+\n  theme(\n    legend.position = \"none\",\n        \n    title=element_markdown(face=\"bold\"),\n    plot.subtitle=element_markdown(face=\"plain\"),\n        \n    axis.title=element_text(face=\"plain\"),\n        \n    strip.background = element_blank(),\n    strip.text = element_blank()\n    )\n\np_growth\n\n\n\n\n\n\n\n\nFigure 4.1: Growth of simulated individuals\n\n\n\n\n\n\n\n4.2.2 Model definition with brms\n\n\nCode\n# Model definition\nbf.mod &lt;- \n  \n  bf(\n1    L  ~ L0+a*t,\n2    L0 ~ 1 + (1||ID),\n3    a  ~ 0 + exposition+(0+exposition||ID),\n    \n4    center=F,\n5    nl=T\n  )                              \n\n\n\n1\n\nEquation of L depending on t\n\n2\n\nEach individual can have its own L0 value but L0 does not depend on the exposition\n\n3\n\nEach individual can have its own a value and a depend on the exposition\n\n4\n\nData are centered in the calculation process\n\n5\n\nOur parameters have non-linear definitions\n\n\n\n\n\n\nCode\nList_parameters &lt;- \n  \n  c(\n    \"b_L0_Intercept\",       # L0_mu\n    \"sd_ID__L0_Intercept\",  # L0_sd\n    \"b_a_exposition0\",      # a_ctrl_mu\n    \"b_a_exposition1\",      # a_trt_mu\n    \"sd_ID__a_exposition0\", # a_ctrl_sd\n    \"sd_ID__a_exposition1\", # a_trt_sd\n    \"sigma\"                 # Residuals variance\n  )\n\n\nThe model parameters are named as follows by brms :\n\n\\(L0_{\\mu}\\) : b_L0_Intercept\n\\(L0_{\\sigma}\\) : sd_ID__L0_Intercept\n\\(a_{\\text{ctrl},\\mu}\\) : b_a_exposition0\n\\(a_{\\text{trt},\\mu}\\) : b_a_exposition1\n\\(a_{\\text{ctrl},\\sigma}\\) : sd_ID__a_exposition0\n\\(a_{\\text{trt},\\sigma}\\) : sd_ID__a_exposition1\n\n\n\n4.2.3 Priors definitions\nThe priors cannot be defined according to the results of Bart et al. (2020). Therefore we base the prior to our general knowledge about A. caliginosa :\n\nWeight at birth is often around 10 to 15 mg and might range from 8 to 20 mg. The prior on \\(L0_{\\mu}\\) can be a normal distribution with a mean of 12.5\\(^{1/3}\\) = 2.32 mg\\(^{1/3}\\) and coefficient of variation of 20%. The prior on \\(L0_{\\sigma}\\) can be a normal distribution with a mean of 2.32 \\(\\times\\) 0.2 and a coefficient of variation of 100%. We also know that \\(L0_{\\mu}\\) cannot be less than 0.\nAn individual typically takes 4 months to be an adult weighting around 600 mg. It gives us a growth rate of 600\\(^{1/3}\\)/(30 \\(\\times\\) 4) = 0.070 mg\\(^{1/3}\\)/d. The prior on \\(a_{ctrl,\\mu}\\) can be a normal distribution with a mean of 0.070 and a coefficient of variation of 20% so our prior is less restrictive.\nWe have no real a priori knowledge about the inter-individual variation of growth. We therefore want a large prior such as a normal distribution with a mean of 20% of the mean growth rate and a coefficient of variation of 100%.\n\nThe same priors are given to the two cohorts. A growth rate individual variation of 20% was given as a prior for the two cohort.\n\n\nCode\n# Priors definition\npriors &lt;-\n1  prior(normal(2.32, 2.32*0.2), class = b, nlpar = L0, lb = 0) +\n2  prior(normal(2.32*0.2, 2.32*0.2), class = sd, nlpar = L0)+\n\n3  prior(normal(0.070, 0.070*0.2), class=b, coef=exposition0, nlpar = a) +\n4  prior(normal(0.070,  0.070*0.2), class=b, coef=exposition1, nlpar = a) +\n\n5  prior(normal(0.070*0.2,  0.070), class=sd,\n        coef=exposition0, group=ID, nlpar = a)+\n6  prior(normal(0.070*0.2,  0.070), class=sd,\n        coef=exposition1, group=ID, nlpar = a)+\n\n7  prior(exponential(1), sigma, nlpar=\"\")\n\n\n\n1\n\nPrior on \\(L0_{\\mu}\\)\n\n2\n\nPrior on \\(L0_{\\sigma}\\)\n\n3\n\nPrior on \\(a_{\\text{ctrl},\\mu}\\)\n\n4\n\nPrior on \\(a_{\\text{trt},\\mu}\\)\n\n5\n\nPrior on \\(a_{\\text{ctrl},\\sigma}\\)\n\n6\n\nPrior on \\(a_{\\text{trt},\\sigma}\\)\n\n7\n\nPrior on residuals\n\n\n\n\n\n\nCode\ncol_dens &lt;- Nord_polar[1]\nalpha_dens &lt;- 0.5\nsizetitle &lt;- 18\n\npriors$nlpar &lt;- factor(priors$nlpar, levels = c(\"L0\", \"a\")) \n\np1 &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"b\") %&gt;% \n  ggplot(\n    aes(\n      xdist = .dist_obj, \n      y = format(.dist_obj),\n      color = coef,\n      fill = coef\n      )\n    ) +\n  stat_dist_halfeye(\n    alpha = alpha_dens\n  ) +\n  facet_wrap(\n    ~nlpar+coef, \n    scales = \"free\"\n    ) +\n  scale_color_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+\n  scale_fill_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+\n  ggtitle(\"Intercepts\") +\n  labs(\n    x = \"Value\",\n    y = \"Density\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face=\"bold\", size = sizetitle),\n    strip.text = element_text(face=\"plain\", size = sizetitle-2),\n        )\n\np2 &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sd\") %&gt;% \n  ggplot(\n    aes(\n      xdist = .dist_obj, \n      y = format(.dist_obj),\n      color = coef,\n      fill = coef\n      )\n    ) +\n  stat_dist_halfeye(\n    alpha = alpha_dens\n  ) +\n  facet_wrap(\n    ~nlpar+coef, \n    scales = \"free\"\n    ) +\n  scale_color_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+\n  scale_fill_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+\n  ggtitle(\"Inter-individual variances\") +\n  labs(\n    x = \"Value\",\n    y = \"Density\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face=\"bold\", size = sizetitle),\n    strip.text = element_text(face=\"plain\", size = sizetitle-2),\n    )\n\np3 &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sigma\") %&gt;% \n  ggplot(\n    aes(\n      xdist = .dist_obj, \n      y = format(.dist_obj),\n      color = coef,\n      fill = coef\n      )\n    ) +\n  stat_dist_halfeye(\n    # fill = col_dens,\n    # color = col_dens,\n    alpha = alpha_dens\n  ) +\n  facet_wrap(\n    ~nlpar, \n    scales = \"free\"\n    ) +\n  scale_color_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+\n  scale_fill_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+\n  ggtitle(\"Residual variance\") +\n  labs(\n    x = \"Value\",\n    y = \"Density\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face=\"bold\", size = sizetitle),\n    strip.text = element_text(face=\"plain\", size = sizetitle-2),\n    )\n\n\n\np &lt;- plot_grid(\n  p1, p2, p3, \n  ncol = 1, align = \"v\", axis = \"l\"\n)\np\n\n\n\n\n\n\n\n\nFigure 4.2: Priors of our model.\n\n\n\n\n\n\n\n4.2.4 Prior predictive check\nIn bayesian modeling, we first perform a prior predictive check before fitting the model to our data. This allows us to check on the rationnality of the chosen priors.\nResults of the model with the sampling of priors :\n\n\nCode\nm.sim.prior &lt;- \n  \n  brm(\n1    data = df_sim,\n2    bf.mod,\n3    backend = \"cmdstanr\",\n4    prior = priors,\n5    sample_prior = \"only\",\n6    cores = 4,\n7    seed = 1212,\n8    iter = 1000, warmup = 500,\n    control = list(\n9      adapt_delta = .95,\n      max_treedepth = 12\n      ), \n10    file=here::here(\"mod/m_brms_prior_sim\")\n  )\n\nprint(m.sim.prior)\n\n\n\n1\n\nData used\n\n2\n\nModel to be used\n\n3\n\nType of backend for calculations\n\n4\n\nPriors to be used\n\n5\n\nWork only done with priors and not the data\n\n6\n\nCores for calculations\n\n7\n\nSeed for reproducibility\n\n8\n\nA total of 1000 interations are done with 500 that are part of the warmup phase\n\n9\n\nControl parameters on the iterations\n\n10\n\nPath where the model results are saved\n\n\n\n\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: L ~ L0 + a * t \n         L0 ~ 1 + (1 || ID)\n         a ~ 0 + exposition + (0 + exposition || ID)\n   Data: df_sim (Number of observations: 300) \n  Draws: 4 chains, each with iter = 1000; warmup = 500; thin = 1;\n         total post-warmup draws = 2000\n\nMultilevel Hyperparameters:\n~ID (Number of levels: 60) \n                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsd(L0_Intercept)      0.61      0.35     0.05     1.35 1.00     1206      916\nsd(a_exposition0)     0.06      0.04     0.00     0.16 1.00     1337      934\nsd(a_exposition1)     0.06      0.04     0.00     0.17 1.00     1361      794\n\nRegression Coefficients:\n              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nL0_Intercept      2.32      0.46     1.41     3.19 1.00     2449      980\na_exposition0     0.07      0.01     0.04     0.10 1.00     2637     1272\na_exposition1     0.07      0.01     0.04     0.10 1.00     3378     1323\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     0.99      1.01     0.03     3.89 1.00     1644      818\n\nDraws were sampled using sample(hmc). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\n\nWe can then plot the predictions of this model and see if they represent at least the full range of our experimental data.\n\n\nCode\n1pred &lt;- predicted_draws(m.sim.prior, newdata=df_sim)\n\ny_max &lt;- 500\n\np_ctrl &lt;- ggplot()+\n  \n  stat_lineribbon(\n    data = subset(pred, exposition == 0), \n    aes(x = t, y = .prediction^3, group = exposition),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_line(\n    data = subset(df_sim, exposition == 0),\n    aes(x = t, y = w, group=ID),\n    color = \"black\",\n    alpha = 0.4\n    )+\n  geom_point(\n    data = subset(df_sim, exposition == 0),\n    aes(x = t, y = w, group = ID),\n    color = \"black\",\n    alpha = 0.4\n    )+\n  \n  scale_fill_manual(values = rev(pal_blue))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  \n  ylim(0, y_max)+\n  \n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_minimal(14)+\n  theme(legend.position = \"none\")\n\n\np_trt &lt;- ggplot()+\n  \n  stat_lineribbon(\n    data = subset(pred, exposition == 1),\n    aes(x = t, y=.prediction^3, group=exposition),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_point(\n    data = subset(df_sim, exposition == 1),\n    aes(x = t, y = w, group = ID),\n    color = \"black\",\n    alpha = 0.4\n    )+\n  geom_line(\n    data = subset(df_sim, exposition == 1),\n    aes(x = t, y = w, group = ID),\n    color = \"black\",\n    alpha = 0.4\n    )+\n  \n  scale_fill_manual(values = rev(pal_red))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  \n  ylim(0, y_max)+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_minimal(14)+\n  theme(legend.position = \"none\")\n\nplot.prior_pred &lt;- p_ctrl + p_trt + \n  plot_layout(ncol = 2, guides = \"collect\") & \n  theme(\n    legend.position = \"right\", \n    title=element_text(face=\"bold\"), \n    axis.title.x = element_text(face=\"plain\"),\n    axis.title.y = element_text(face=\"plain\")\n    )\n\nplot.prior_pred\n\n\n\n1\n\nPredictions from the model\n\n\n\n\n\n\n\n\n\n\nFigure 4.3: Prior predictive check.Fresh body weight of simulated non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed every 28 days (red points and thin lines, each line corresponding to one individual). Colored ribbons correspond to the different credibility intervals for the mean growth for each cohort under the prior distribution. The thicker black lines represent the predicted mean body weight based solely on prior assumptions.\n\n\n\n\n\nThe Figure 4.3 shows the chosen priors are realistic.\nThe prior sensitivity of our model is explored Section 7.2.\n\n\n4.2.5 Posterior predictive check\n\n4.2.5.1 Model fit\nWe can now fit the model to our simulated data.\n\n\nCode\nm.sim.post &lt;-\n\n  brm(\n1    data = df_sim,\n2    bf.mod,\n3    backend = \"cmdstanr\",\n4    prior = priors,\n5    save_pars = save_pars(all = TRUE),\n6    sample_prior = \"yes\",\n7    seed = 12121212,\n8    chains = 4, cores = 4,\n9    iter = 6000, warmup = 1000,\n10    control = list(adapt_delta = .95,\n    max_treedepth = 12),\n11    file=here::here(\"mod/m_brms_post_sim\")\n  )\n\nprint(m.sim.post)\n\n\n\n1\n\nData used\n\n2\n\nModel to be used\n\n3\n\nType of backend for calculations\n\n4\n\nPriors to be used\n\n5\n\nWe want all parameters to be saved\n\n6\n\nWork done with priors and the data\n\n7\n\nNumber of chains and cores for calculations\n\n8\n\nSeed for reproducibility\n\n9\n\nA total of 6000 interations are done with 1000 that are part of the warmup phase\n\n10\n\nControl parameters on the iterations\n\n11\n\nPath where the model results are saved\n\n\n\n\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: L ~ L0 + a * t \n         L0 ~ 1 + (1 || ID)\n         a ~ 0 + exposition + (0 + exposition || ID)\n   Data: df_sim (Number of observations: 300) \n  Draws: 4 chains, each with iter = 6000; warmup = 1000; thin = 1;\n         total post-warmup draws = 20000\n\nMultilevel Hyperparameters:\n~ID (Number of levels: 60) \n                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsd(L0_Intercept)      0.41      0.04     0.34     0.49 1.00     4727     8913\nsd(a_exposition0)     0.01      0.00     0.01     0.01 1.00     8096    12231\nsd(a_exposition1)     0.01      0.00     0.01     0.01 1.00     6808    11548\n\nRegression Coefficients:\n              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nL0_Intercept      2.28      0.05     2.18     2.39 1.00     2420     5015\na_exposition0     0.07      0.00     0.07     0.08 1.00     5502     9989\na_exposition1     0.07      0.00     0.06     0.07 1.00     3997     8397\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     0.10      0.01     0.09     0.11 1.00    13705    15182\n\nDraws were sampled using sample(hmc). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\n\n\n\n4.2.5.2 Parameter estimation results\nChains recuperation and calculation of additional parameters :\n\n\nCode\n1df_chains &lt;- ggs(m.sim.post, burnin = T) |&gt;\n  filter(Parameter %in% List_parameters) |&gt;\n  mutate(\n    Chain=as.factor(Chain),\n    value=value\n    )\n\n2df_chains_post &lt;- df_chains |&gt;\n filter(Iteration&gt;1000)\n\n3df_chains_median &lt;- df_chains_post |&gt;\n  aggregate(value ~ Parameter, median) |&gt;\n  rename(median = value)\n\n4df_chains_post_large &lt;-\n  dcast(\n    data = df_chains_post,\n    formula = Iteration + Chain ~ Parameter,\n    value.var = 'value'\n  )\n\ndf_chains_post_large &lt;- df_chains_post_large |&gt;\n  mutate(\n    Delta_a_mu = b_a_exposition1-b_a_exposition0,\n    Ratio_a_mu = b_a_exposition1/b_a_exposition0,\n    Delta_a_sd = sd_ID__a_exposition1-sd_ID__a_exposition0,\n    Ratio_a_sd = sd_ID__a_exposition1/sd_ID__a_exposition0,\n    LnRR = log(b_a_exposition1/b_a_exposition0),\n    LnCVi = log((sd_ID__a_exposition1/b_a_exposition1)/(sd_ID__a_exposition0/b_a_exposition0))\n  )\n\ndf_chains_post_long &lt;- df_chains_post_large |&gt;\n  melt(\n    id.vars=c(\"Iteration\", \"Chain\"),\n    measure.vars=colnames(df_chains_post_large)[-c(1,2)],\n    variable.name=\"Parameter\",\n    value.name=\"value\"\n  )\n\nParam_a_mu &lt;- c(\n  \"b_a_exposition0\",\n  \"b_a_exposition1\"\n  )\nParam_a_sd &lt;- c(\n  \"sd_ID__a_exposition0\",\n  \"sd_ID__a_exposition1\"\n  )\nParam_ctrl &lt;- c(\n  \"b_a_exposition0\",\n  \"sd_ID__a_exposition0\"\n  )\nParam_trt &lt;- c(\n  \"b_a_exposition1\",\n  \"sd_ID__a_exposition1\"\n  )\nParam_t0 &lt;- c(\n  \"b_L0_Intercept\",\n  \"sd_ID__L0_Intercept\",\n  \"Delta_a_mu\",\n  \"Delta_a_sd\"\n  )\n\ndf_chains_post_long &lt;- df_chains_post_long |&gt;\n  mutate(\n    exposition = case_when(\n      Parameter %in% Param_ctrl ~ \"Non exposed\",\n      Parameter %in% Param_trt ~ \"Exposed\",\n      Parameter %in% Param_t0 ~ \"General\")\n    )\n\n\n\n1\n\nExtraction of each chain iterations values for each parameters\n\n2\n\nOnly iterations after the warmup phase\n\n3\n\nAdding medians from each distribution\n\n4\n\nCalculation delta and ratios between non-exposed and exposed individuals\n\n\n\n\n\n\nCode\nalpha_dens &lt;- 0.5\nalpha_dens_prior &lt;- 0.2\nfont_size &lt;- 12\ncol_dens &lt;- Nord_polar[1]\ncol_dens_ctrl &lt;- Nord_frost[4]\ncol_dens_trt &lt;- col_red\nsize_norm &lt;- 0.7\n\nprior_L0_mu &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"b\" & nlpar == \"L0\")\nprior_L0_sd &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sd\" & nlpar == \"L0\")\n\nprior_a_ctrl_mu &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"b\" & nlpar == \"a\" & coef == \"exposition0\")\nprior_a_ctrl_sd &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sd\" & nlpar == \"a\" & coef == \"exposition0\")\n\nprior_a_trt_mu &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"b\" & nlpar == \"a\" & coef == \"exposition1\")\nprior_a_trt_sd &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sd\" & nlpar == \"a\" & coef == \"exposition1\")\n\nprior_sigma &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sigma\")\n\nplot_L0_mu &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_L0_mu,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"b_L0_Intercept\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens\n  ) +\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Mean initial structural length \" (mg^{1/3})))\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_L0_sd &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_L0_sd,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"sd_ID__L0_Intercept\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens\n  ) +\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Individual variation of\\ninitial structural length \" (mg^{1/3})))\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_a_ctrl_mu &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_a_ctrl_mu,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"b_a_exposition0\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens_ctrl,\n    color = col_dens_ctrl,\n    alpha = alpha_dens\n  ) +\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Mean growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Non-exposed\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_a_trt_mu &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_a_trt_mu,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"b_a_exposition1\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens_trt,\n    color = col_dens_trt,\n    alpha = alpha_dens\n  ) +\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Mean growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Exposed\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_a_ctrl_sd &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_a_ctrl_sd,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"sd_ID__a_exposition0\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens_ctrl,\n    color = col_dens_ctrl,\n    alpha = alpha_dens\n  ) +\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Inter-individual variation\\nof growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Non-exposed\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_a_trt_sd &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_a_trt_sd,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"sd_ID__a_exposition1\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens_trt,\n    color = col_dens_trt,\n    alpha = alpha_dens\n  ) +\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Inter-individual variation\\nof growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Exposed\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_sigma &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_sigma,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"sigma\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens\n  ) +\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Residual variance\" (mg^{1/3})))\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\n\np &lt;- (plot_L0_mu+ plot_a_ctrl_mu + plot_a_trt_mu)/(plot_L0_sd + plot_a_ctrl_sd   + plot_a_trt_sd) / plot_sigma \np\n\n\n\n\n\n\n\n\nFigure 4.4: Prior (light grey) and posterior distributions for each parameter.\n\n\n\n\n\nParameters estimation results :\n\n\nCode\ndf_res_VI &lt;- summarise_draws(tidy_draws(m.sim.post))\ndf_res_VI_show &lt;- df_res_VI[1:7,]\n\ndf_res_VI_show |&gt; datatable(\n  options = list(\n    dom = 't',\n    columnDefs = list(\n      list(className = 'dt-left', targets = \"_all\")\n      )\n    ),\n  class=\"hover\"\n  ) |&gt;\n  formatRound(columns = 2:length(df_res_VI_show), digits = 2)\n\n\n\n\nTable 4.1: Different statistical values of the posterior distributions\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Calculation of the results for Ln(RR) and Ln(CVi)\n\nMedian_LnRR &lt;- median(subset(df_chains_post_long, Parameter==\"LnRR\")$value)\nMedian_LnCVi &lt;- median(subset(df_chains_post_long, Parameter==\"LnCVi\")$value)\nMedian_LnRR_print &lt;- round(Median_LnRR, 2)\nMedian_LnCVi_print &lt;- round(Median_LnCVi, 2)\n\nMedian_Ratio_a_mu &lt;- median(subset(df_chains_post_long, Parameter==\"Ratio_a_mu\")$value)\nMedian_Ratio_a_sd &lt;- median(subset(df_chains_post_long, Parameter==\"Ratio_a_sd\")$value)\n\nCI_Ratio_a_mu &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter==\"Ratio_a_mu\")$value, method = \"ETI\", ci = 0.90)\nCI_Ratio_a_mu_p &lt;- paste(\"[\", round(CI_Ratio_a_mu$CI_low,2), \" ; \", round(CI_Ratio_a_mu$CI_high,2), \"]\", sep=\"\")\nCI_Ratio_a_sd &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter==\"Ratio_a_sd\")$value, method = \"ETI\", ci = 0.90)\nCI_Ratio_a_sd_p &lt;- paste(\"[\", round(CI_Ratio_a_sd$CI_low,2), \" ; \", round(CI_Ratio_a_sd$CI_high,2), \"]\", sep=\"\")\n\nCI_LnRR &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter==\"LnRR\")$value, method = \"ETI\", ci = 0.90)\nCI_LnRR_p &lt;- paste(\"[\", round(CI_LnRR$CI_low,2), \" ; \", round(CI_LnRR$CI_high,2), \"]\", sep=\"\")\n\nCI_LnCVi &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter==\"LnCVi\")$value, ci = 0.90)\nCI_LnCVi_p &lt;- paste(\"[\", round(CI_LnCVi$CI_low,2), \" ; \", round(CI_LnCVi$CI_high,2), \"]\", sep=\"\")\n\npd_LnRR &lt;- p_direction(subset(df_chains_post_long, Parameter==\"LnRR\")$value)\npd_LnCVi &lt;- p_direction(subset(df_chains_post_long, Parameter==\"LnCVi\")$value)\n\npd_Ratio_a_mu &lt;- p_direction(subset(df_chains_post_long, Parameter==\"Ratio_a_mu\")$value)\npd_Ratio_a_sd &lt;- p_direction(subset(df_chains_post_long, Parameter==\"Ratio_a_sd\")$value)\n\ndf_res_Ln &lt;- data.frame(\n  Variable = c(\"LnRR\", \"LnCVi\", \"Ratio a_mu\", \"Ratio a_sd\"),\n  Median = c(Median_LnRR, Median_LnCVi, Median_Ratio_a_mu, Median_Ratio_a_sd),\n  CI = c(CI_LnRR_p, CI_LnCVi_p, CI_Ratio_a_mu_p, CI_Ratio_a_sd_p),\n  pd = c(pd_LnRR$pd, pd_LnCVi$pd, pd_Ratio_a_mu$pd, pd_Ratio_a_sd$pd)\n) |&gt; \n  mutate(\n    Median = round(Median, 3)\n  )\n\n# Results expressed as LnRR and LnCVi\ndf_res_Ln |&gt; datatable(\n  options = list(\n    dom = 't',\n    autoWidth = TRUE,\n    columnDefs = list(\n      list(className = 'dt-left', targets = \"_all\")\n      )\n    ), \n  class=\"hover\"\n  ) |&gt;\n  formatRound(columns = c(2,4), digits = 2)\n\n\n\n\nTable 4.2: Effect size results\n\n\n\n\n\n\n\n\n\n\n\n\n4.2.5.3 Chains\nWe can check if the chains look good (Figure 5.4).\n\n\nCode\nplot &lt;-\n  ggplot(\n    data = df_chains_post,\n    aes(x = Iteration, y = value, color = Chain, group = Chain)\n  )+\n  geom_line(alpha=0.7)+\n  facet_wrap(~Parameter, scales = \"free\", ncol = 3)+\n\n  scale_color_manual(values = nord(palette = \"frost\"))+\n\n  theme_bw()+\n  theme(\n    legend.position = \"right\",\n    title=element_text(size=12, face=\"plain\"),\n    axis.title.x = element_text(face=\"plain\"),\n    strip.background = element_rect(fill=\"white\")\n    )\n\nplot\n\n\n\n\n\n\n\n\nFigure 4.5: Parameters chains (without the first 1000 iterations of warmup).\n\n\n\n\n\nWe can also check on the parameters correlations (Figure 4.6).\n\n\nCode\nbayesplot::color_scheme_set(\"gray\")\np &lt;- pairs(m.sim.post, regex=T)\np\n\n\n\n\n\n\n\n\nFigure 4.6: Parameters correlations\n\n\n\n\n\n\n\n4.2.5.4 Model predictions\n\n\nCode\npred &lt;- predicted_draws(m.sim.post, newdata=df_sim)\npost_i &lt;- as.data.frame(posterior_summary(m.sim.post))\n\nID &lt;- subset(df_sim, t==0)$ID\nexpo &lt;- subset(df_sim, t==0)$exposition\n\ndf_estimates &lt;- \n  data.frame(\n    ID                = ID,\n    exposition        = expo,\n    r_L0_i            = post_i$Estimate[8:(8+length(ID)-1)],\n    r_a_i_expo_0      = post_i$Estimate[(8+length(ID)):(8+length(ID)*2-1)],\n    r_a_i_expo_1      = post_i$Estimate[(8+length(ID)*2):(8+length(ID)*3-1)],\n    r_a_i_2.5_expo_0  = post_i$Q2.5[(8+length(ID)):(8+length(ID)*2-1)],\n    r_a_i_2.5_expo_1  = post_i$Q2.5[(8+length(ID)*2):(8+length(ID)*3-1)],\n    r_a_i_97.5_expo_0 = post_i$Q97.5[(8+length(ID)):(8+length(ID)*2-1)],\n    r_a_i_97.5_expo_1 = post_i$Q97.5[(8+length(ID)*2):(8+length(ID)*3-1)]\n    ) |&gt; \n  mutate(\n    L0_i = post_i$Estimate[1]+r_L0_i,\n    a_i = case_when(\n      exposition == 0 ~ post_i$Estimate[2]+r_a_i_expo_0,\n      exposition == 1 ~ post_i$Estimate[3]+r_a_i_expo_1\n      ),\n    a_i_2.5 = case_when(\n      exposition==0 ~ post_i$Q2.5[2]+r_a_i_expo_0,\n      exposition==1 ~ post_i$Q2.5[3]+r_a_i_expo_1\n      ),\n    a_i_97.5 = case_when(\n      exposition==0 ~ post_i$Q97.5[2]+r_a_i_expo_0,\n      exposition==1 ~ post_i$Q97.5[3]+r_a_i_expo_1\n      )\n    ) |&gt; \n  select(ID, exposition, L0_i, a_i, a_i_2.5, a_i_97.5)\n\ndf_pred_mean &lt;- pred |&gt; \n  aggregate(\n    .prediction ~ t + ID + exposition, \n    FUN=mean\n    )\n\ndf_pred_Q &lt;- pred |&gt; \n  aggregate(\n    .prediction ~ t + ID + exposition, \n    FUN='quantile', \n    probs=c(2.5, 97.5)/100\n    )\n\n\ndf_pred &lt;- df_pred_mean |&gt; \n  cbind(df_pred_Q$.prediction[,1]) |&gt; \n  cbind(df_pred_Q$.prediction[,2]) |&gt;\n  mutate(Expo=case_when(exposition==0 ~ \"Non exposed\",\n                        exposition==1 ~ \"Exposed\"))\n\ncolnames(df_pred) &lt;- c(\"t\", \"ID\", \"exposition\", \n                       \"pred_L_mean\", \"pred_L_Q2.5\", \"pred_L_Q97.5\", \"Expo\")\n\n\nWe now check the predictions of the model at the population level (Figure 4.7) and the individual level (Figure 4.8 & Figure 4.9) :\n\n\nCode\ny_max &lt;- 480\n\np_ctrl &lt;- ggplot()+\n  \n  stat_lineribbon(\n    data = pred[pred$exposition == 0,],\n    aes(x=t, y=.prediction^3, group=exposition),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_line(\n    data = df_sim[df_sim$exposition == 0,], \n    aes(x = t, y = L^3, group = ID), \n    color = \"#141c44\", \n    alpha = 0.4\n    )+\n  geom_point(\n    data = df_sim[df_sim$exposition == 0,], \n    aes(x = t, y = L^3, group = ID), color = \"#141c44\", alpha = 0.4\n    )+\n  \n  ylim(0, y_max)+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  scale_fill_manual(values = rev(pal_blue))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  \n  theme_minimal()+\n  theme(legend.position = \"none\")\n\np_trt &lt;- ggplot()+\n  stat_lineribbon(\n    data = pred[pred$exposition == 1,], \n    aes(x=t, y = .prediction^3, group = exposition),\n    .width = c(.99,.95,.8,.5),\n    color = \"black\"\n    )+\n  geom_point(\n    data = df_sim[df_sim$exposition == 1,], \n    aes(x = t, y = L^3, group = ID), \n    color = \"#380000\", \n    alpha = 0.4\n    )+\n  geom_line(\n    data = df_sim[df_sim$exposition == 1,], \n    aes(x = t, y = L^3, group = ID), \n    color = \"#380000\", \n    alpha = 0.4\n    )+\n  \n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  ylim(0, y_max)+\n  \n  \n  scale_fill_manual(values = rev(pal_red))+\n  \n  labs(y = \"Weight (mg)\", x = \"Time (days)\")+\n  \n  theme_minimal()+\n  theme(legend.position = \"none\")\n\nplot.estimates.grp &lt;- p_ctrl + p_trt + \n  plot_layout(ncol=2, guides=\"collect\") & \n  theme(\n    legend.position = \"right\", \n    title=element_text(face=\"bold\"), \n    axis.title.x = element_text(face=\"plain\"),\n    axis.title.y = element_text(face=\"plain\")\n    )\n\nplot.estimates.grp\n\n\n\n\n\n\n\n\nFigure 4.7: Posterior predictive check. Fresh body weight of simulated non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points and thin lines, each line corresponding to one individual). Colored ribbons correspond to the different credibility intervals for the mean growth for each cohort. The thicker black lines represent the predicted mean body weight.\n\n\n\n\n\n\nNon-exposedExposed\n\n\n\n\nCode\np_ctrl &lt;- ggplot()+\n  stat_lineribbon(\n    data = pred[pred$exposition==0,], \n    aes(x = t, y=.prediction^3, color=exposition, group=ID),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_line(\n    data=df_sim[df_sim$exposition==0,], \n    aes(x=t, y=L^3, group=ID), \n    color=\"#141c44\", \n    alpha=0.25\n    )+\n  geom_point(\n    data=df_sim[df_sim$exposition==0,],\n    aes(x=t, y=L^3, group=ID), \n    color=\"#141c44\", \n    alpha=0.3, \n    size=2.5\n    )+\n  facet_wrap(~ID, ncol=5)+\n  \n  scale_fill_manual(values = rev(pal_blue))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  ylim(0, y_max)+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_bw()+\n  theme(\n    legend.position = \"right\", \n    title=element_text(size=12, face=\"plain\"), \n    axis.title.x = element_text(face=\"plain\"),\n    strip.background = element_rect(fill=\"white\")\n    )\np_ctrl\n\n\n\n\n\n\n\n\nFigure 4.8: Posterior predictive check. Fresh body weight of simulated non-exposed earthworms (blue points). Colored ribbons correspond to the different credibility intervals for the predicted growth for each individual. The thicker black lines represent the predicted body weight.\n\n\n\n\n\n\n\n\n\nCode\np_trt &lt;- ggplot()+\n  stat_lineribbon(\n    data = pred[pred$exposition==1,],\n    aes(x = t, y=.prediction^3, color=exposition, group=ID),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_point(\n    data=df_sim[df_sim$exposition==1,], \n    aes(x=t, y=L^3, group=ID), \n    color=\"#380000\", \n    alpha=0.3, \n    size=2.5\n    )+\n  geom_line(\n    data=df_sim[df_sim$exposition==1,], \n    aes(x=t, y=L^3, group=ID), \n    color=\"#380000\", \n    alpha=0.25\n    )+\n  facet_wrap(~ID, ncol=5, nrow=6)+\n  \n  scale_fill_manual(values = rev(pal_red))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  ylim(0, y_max)+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_bw()+\n  theme(\n    legend.position = \"right\", \n    title=element_text(size=12, face=\"plain\"), \n    axis.title.x = element_text(face=\"plain\"),\n    strip.background = element_rect(fill=\"white\")\n    )\np_trt\n\n\n\n\n\n\n\n\nFigure 4.9: Posterior predictive check. Fresh body weight of simulated exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points). Colored ribbons correspond to the different credibility intervals for the predicted growth for each individual. The thicker black lines represent the predicted body weight.\n\n\n\n\n\n\n\n\n\n\n4.2.5.5 Comparison of the simulated and estimated parameters values\n\n\nCode\ndf_sim_ordered &lt;- df_sim |&gt; arrange(t) |&gt; arrange(as.numeric(ID))\n\ndf_data_pred_obs &lt;- df_pred |&gt;\n  mutate(\n    w_obs = df_sim_ordered$w,\n    ratio_predobs = pred_L_mean^3 / w_obs\n    )\n\nfact_1 &lt;- 1.5\nfact_2 &lt;- 2\n\nseq_line &lt;- seq(1.1, 600, 0.1)\n\ndf_line &lt;- data.frame(\n  x1  = seq_line,\n  y1  = seq_line*fact_1,\n  x_1 = seq_line,\n  y_1 = seq_line/fact_1,\n  x2  = seq_line,\n  y2  = seq_line*fact_2,\n  x_2 = seq_line,\n  y_2 = seq_line/fact_2\n  )\n\nplot_predobs_log &lt;- ggplot()+ \n  \n  geom_line(\n    data=df_line, \n    mapping=aes(x=x1, y=y1), \n    linetype=\"dashed\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x_1, y=y_1), \n    linetype=\"dashed\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x2, y=y2), \n    linetype=\"dotted\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x_2, y=y_2), \n    linetype=\"dotted\"\n    )+\n  geom_abline(intercept=0, slope=1)+\n  geom_pointrange(\n    data = df_data_pred_obs, \n    aes(\n      x=w_obs,\n      y=pred_L_mean^3,\n      ymin=pred_L_Q2.5^3,\n      ymax=pred_L_Q97.5^3, \n      color=Expo\n      ), \n    alpha=0.5\n    )+\n  \n  scale_x_log10(limits=c(1.6, 700))+\n  scale_y_log10(limits=c(1.6, 700))+\n  \n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n  \n  labs(\n    x=\"Observed weight (mg)\", \n    y=\"Predicted weight (mg)\"\n    )+\n  \n  theme_minimal(24)+\n  theme(legend.position = \"bottom\")\n\nplot_predobs_log\n\n\n\n\n\n\n\n\nFigure 4.10: Results of the model fit on experimental data. Predicted values are represented with points with their respective credibility interval of 95%. Red points correspond to the predicted value for exposed individuals and blue points for the non exposed individuals. Dashed and dotted lines represent the 1.5-folds and 2-fold changes, respectively. The full line represents the identity line.\n\n\n\n\n\n\n\nCode\n# Percentage of points in the X-fold change area\nf_fold &lt;- function(fold){\n  res &lt;- length(\n    subset(\n      df_data_pred_obs, \n      ratio_predobs &lt; fold & ratio_predobs &gt; -fold\n      )$w_obs\n    )/length(subset(df_data_pred_obs, !is.na(w_obs))$t)\n  return(res)\n}\n\ndf_fold &lt;- data.frame(fold = c(1.05, 1.075, 1, 1.25, 1.5, 2)) %&gt;%\n  mutate(per = signif(mapply(f_fold, fold),2)*100)\n\ncolnames(df_fold) &lt;- c(\"Fold\", \"Percentage of predictions within\")\n\ndf_fold |&gt; datatable(options = list(dom = 't'), class=\"hover\")\n\n\n\n\nTable 4.3: Percentage of points in the X-fold change area\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ncol_delta &lt;- Nord_polar[4]\nfont_size &lt;- 10\nalpha_dens &lt;- 0.6\nalpha_expo &lt;- 0.4\n\nplot_L0_mu &lt;- ggplot(\n  data=subset(df_chains_post_long,Parameter == \"b_L0_Intercept\"),\n  aes(\n    x=value\n    ),\n  color = Nord_polar[1],\n  fill = Nord_polar[1]\n  )+\n  labs(x=bquote(\"Initial structural length \" (mg^{1/3})))+\n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  geom_vline(xintercept = sim_L0_mu, color = Nord_polar[1])+\n\n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n\n  theme_classic(font_size)+\n  theme(\n    axis.line.y=element_blank(),\n    axis.title.y=element_blank(),\n    axis.ticks.y=element_blank(),\n    axis.text.y=element_blank(),\n    legend.position=\"none\"\n    )\n\nplot_L0_sd &lt;- ggplot(\n  data=subset(df_chains_post_long,Parameter == \"sd_ID__L0_Intercept\"),\n  aes(\n    x=value\n    ),\n  color = Nord_polar[1],\n  fill = Nord_polar[1]\n  )+\n  labs(x=bquote(\"Initial structural length individual variation \" (mg^{1/3})))+\n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  geom_vline(xintercept = sim_L0_sd, color = Nord_polar[1])+\n\n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n\n  theme_classic(font_size)+\n  theme(\n    axis.line.y=element_blank(),\n    axis.title.y=element_blank(),\n    axis.ticks.y=element_blank(),\n    axis.text.y=element_blank(),\n    legend.position=\"none\",\n      \n    )\n\nplot_res_mu &lt;- ggplot(\n  data=subset(df_chains_post_long,Parameter %in% Param_a_mu),\n  aes(\n    #x=Parameter,\n    x=value,\n    color=exposition,\n    fill=exposition\n    )\n  )+\n  labs(x=bquote(\"Mean growth rate \" (mg^{1/3}/d)))+\n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  geom_vline(xintercept = sim_a_ctrl_mu, color = pal_col[1])+\n  geom_vline(xintercept = sim_a_trt_mu, color = pal_col[2])+\n\n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n\n  theme_classic(font_size)+\n  theme(\n    axis.line.y=element_blank(),\n    axis.title.y=element_blank(),\n    axis.ticks.y=element_blank(),\n    axis.text.y=element_blank(),\n    legend.position=\"none\",\n    )\n\nplot_res_sd &lt;- ggplot(\n  data=subset(df_chains_post_long,Parameter %in% Param_a_sd),\n  aes(\n    x=value,\n    color=exposition,\n    fill=exposition\n      )\n  )+\n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  geom_vline(xintercept = sim_a_ctrl_sd, color = pal_col[1])+\n  geom_vline(xintercept = sim_a_trt_sd, color = pal_col[2])+\n\n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n\n  labs(x=bquote(\n    \"Growth rate individual variation \" (mg^{1/3}/d)\n    )\n    )+\n\n  theme_classic(font_size)+\n  theme(\n    axis.line.y=element_blank(),\n    axis.title.y=element_blank(),\n    axis.ticks.y=element_blank(),\n    axis.text.y=element_blank(),\n    legend.position=\"none\"\n    )\n\nplot_LnRR &lt;- ggplot(\n  data=subset(df_chains_post_long,Parameter == \"LnRR\"),\n  aes(\n    x=value\n    ),\n  color = Nord_polar[4],\n  fill = Nord_polar[4]\n  )+\n  labs(x=bquote(\"Mean pesticides effect (LnRR)\"))+\n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  geom_vline(xintercept = sim_LnRR, color = Nord_polar[4])+\n\n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n\n  theme_classic(font_size)+\n  theme(\n    axis.line.y=element_blank(),\n    axis.title.y=element_blank(),\n    axis.ticks.y=element_blank(),\n    axis.text.y=element_blank(),\n    legend.position=\"none\"\n    )\n\nplot_LnCVi &lt;- ggplot(\n  data=subset(df_chains_post_long,Parameter == \"LnCVi\"),\n  aes(\n    x=value\n    ),\n  color = Nord_polar[4],\n  fill = Nord_polar[4]\n  )+\n  labs(x=bquote(\"Pesticides effect on individual variation (LnCVi)\"))+\n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  geom_vline(xintercept = sim_LnCVi, color = Nord_polar[4])+\n\n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n\n  theme_classic(font_size)+\n  theme(\n    axis.line.y=element_blank(),\n    axis.title.y=element_blank(),\n    axis.ticks.y=element_blank(),\n    axis.text.y=element_blank(),\n    legend.position=\"none\"\n    )\n\nplot &lt;- plot_L0_mu +plot_L0_sd +plot_res_mu + plot_res_sd + plot_LnRR + plot_LnCVi +\n  plot_layout(ncol=2, guides=\"collect\", heights = c(1, 1, 1))\nplot\n\n\n\n\n\n\n\n\nFigure 4.11: Comparison of simulated vs predicted parameters values. Vertical lines represent the true values of the simulated population parameters.\n\n\n\n\n\nFigure 4.11 shows the posterior distributions of estimated parameters, with vertical black lines indicating the true population values. The results demonstrate good parameter recovery, as the distributions are generally centered around the true values. Estimates for initial structural length, growth rate, and pesticide effects align well with the simulated data, indicating accurate inference.\n\n\nCode\ndf_err &lt;- data.frame(\n  Parameter = c(as.list(df_res_VI_show[1])$variable, \"LnRR\", \"LnCVi\"),\n  Simulated = c(sim_L0_mu, sim_a_ctrl_mu, sim_a_trt_mu, sim_L0_sd, sim_a_ctrl_sd, sim_a_trt_sd, sd, sim_LnRR, sim_LnCVi),\n  Predicted = c(as.list(df_res_VI_show[2])$mean, mean(subset(df_chains_post_long, Parameter == \"LnRR\")$value), mean(subset(df_chains_post_long, Parameter == \"LnCVi\")$value))\n)\ndf_err &lt;- df_err |&gt; \n  mutate(\n    Per_error = (Predicted-Simulated)/Simulated*100\n  )\n\ndf_err |&gt; datatable(\n  options = list(\n    dom = 't',\n    columnDefs = list(\n      list(className = 'dt-left', targets = \"_all\")\n      )\n    ),\n  class=\"hover\"\n  ) |&gt;\n  formatRound(columns = 2:length(df_err), digits = 4)\n\n\n\n\nTable 4.4: Estimation errors on parameters\n\n\n\n\n\n\n\n\n\n\nParameter recovery is excellent at the population level, with absolute errors below 0.5%, and strong at the individual level, with absolute errors between 4 to 5%.\n\n Session Information \n\n\n\n\n\nCode\nsessionInfo()\n\n\nR version 4.2.2 (2022-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS 14.0\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] devtools_2.4.5     usethis_2.2.3      readxl_1.4.3       DT_0.33           \n [5] kableExtra_1.4.0   knitr_1.47         latex2exp_0.9.6    nlstools_2.1-0    \n [9] lsmeans_2.30-0     emmeans_1.10.3     Hmisc_5.1-3        car_3.1-2         \n[13] carData_3.0-5      modelsummary_2.2.0 extrafont_0.19     gridExtra_2.3     \n[17] ggpubr_0.6.0       plotly_4.10.4      ggtext_0.1.2       ggbreak_0.1.2     \n[21] cowplot_1.1.3      patchwork_1.2.0    ggdist_3.3.2       nord_1.0.0        \n[25] RColorBrewer_1.1-3 wesanderson_0.3.7  viridis_0.6.5      viridisLite_0.4.2 \n[29] ggthemes_5.1.0     see_0.8.4.3        report_0.5.8       parameters_0.22.2 \n[33] performance_0.12.0 modelbased_0.8.8   insight_0.20.4     effectsize_0.8.8  \n[37] datawizard_0.11.0  correlation_0.8.5  bayestestR_0.13.2  easystats_0.7.2   \n[41] deSolve_1.40       priorsense_1.0.4   truncnorm_1.0-9    tmvtnorm_1.6      \n[45] gmm_1.8            sandwich_3.1-0     Matrix_1.6-5       mvtnorm_1.2-5     \n[49] fdrtool_1.2.17     tidybayes_3.0.6    ggmcmc_1.5.1.1     glmmTMB_1.1.9     \n[53] rstan_2.32.6       StanHeaders_2.32.9 cmdstanr_0.8.0     brms_2.22.0       \n[57] Rcpp_1.0.12        plan_0.4-5         reshape2_1.4.4     lubridate_1.9.3   \n[61] forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2       \n[65] readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1     \n[69] tidyverse_2.0.0    here_1.0.1        \n\nloaded via a namespace (and not attached):\n  [1] utf8_1.2.4           tidyselect_1.2.1     lme4_1.1-31         \n  [4] htmlwidgets_1.6.4    grid_4.2.2           munsell_0.5.1       \n  [7] ragg_1.3.2           codetools_0.2-20     miniUI_0.1.1.1      \n [10] withr_3.0.0          Brobdingnag_1.2-9    colorspace_2.1-0    \n [13] tables_0.9.28        rstudioapi_0.16.0    ggsignif_0.6.4      \n [16] Rttf2pt1_1.3.12      bayesplot_1.11.1     labeling_0.4.3      \n [19] farver_2.1.2         bridgesampling_1.1-2 rprojroot_2.0.4     \n [22] coda_0.19-4.1        vctrs_0.6.5          generics_0.1.3      \n [25] TH.data_1.1-2        xfun_0.45            timechange_0.3.0    \n [28] markdown_1.13        R6_2.5.1             cachem_1.1.0        \n [31] gridGraphics_0.5-1   promises_1.3.0       scales_1.3.0        \n [34] multcomp_1.4-25      nnet_7.3-19          gtable_0.3.5        \n [37] processx_3.8.4       rlang_1.1.4          systemfonts_1.1.0   \n [40] splines_4.2.2        rstatix_0.7.2        extrafontdb_1.0     \n [43] TMB_1.9.11           lazyeval_0.2.2       broom_1.0.6         \n [46] checkmate_2.3.1      inline_0.3.19        yaml_2.3.8          \n [49] abind_1.4-5          backports_1.5.0      httpuv_1.6.15       \n [52] gridtext_0.1.5       tensorA_0.36.2.1     tools_4.2.2         \n [55] ggplotify_0.1.2      ellipsis_0.3.2       posterior_1.6.0     \n [58] sessioninfo_1.2.2    plyr_1.8.9           base64enc_0.1-3     \n [61] ps_1.7.6             rpart_4.1.23         urlchecker_1.0.1    \n [64] zoo_1.8-12           cluster_2.1.6        fs_1.6.4            \n [67] magrittr_2.0.3       data.table_1.15.4    matrixStats_1.3.0   \n [70] pkgload_1.4.0        mime_0.12            hms_1.1.3           \n [73] evaluate_0.24.0      arrayhelpers_1.1-0   xtable_1.8-4        \n [76] rstantools_2.4.0     compiler_4.2.2       V8_4.4.2            \n [79] minqa_1.2.7          htmltools_0.5.8.1    later_1.3.2         \n [82] ggfun_0.1.6          mgcv_1.9-1           tzdb_0.4.0          \n [85] Formula_1.2-5        aplot_0.2.3          RcppParallel_5.1.7  \n [88] MASS_7.3-58.1        boot_1.3-30          cli_3.6.3           \n [91] parallel_4.2.2       pkgconfig_2.0.3      numDeriv_2016.8-1.1 \n [94] foreign_0.8-87       xml2_1.3.6           svUnit_1.0.6        \n [97] svglite_2.1.3        QuickJSR_1.2.2       ggstats_0.6.0       \n[100] estimability_1.5.1   yulab.utils_0.1.7    distributional_0.4.0\n[103] digest_0.6.36        cellranger_1.1.0     rmarkdown_2.27      \n[106] htmlTable_2.4.2      curl_5.2.1           commonmark_1.9.1    \n[109] shiny_1.8.1.1        nloptr_2.0.3         lifecycle_1.0.4     \n[112] nlme_3.1-160         jsonlite_1.8.8       fansi_1.0.6         \n[115] pillar_1.9.0         lattice_0.22-6       loo_2.8.0           \n[118] GGally_2.2.1         fastmap_1.2.0        httr_1.4.7          \n[121] pkgbuild_1.4.4       survival_3.7-0       remotes_2.5.0       \n[124] glue_1.7.0           profvis_0.3.8        stringi_1.8.4       \n[127] textshaping_0.4.0    memoise_2.0.1       \n\n\n\n\n\n\n\n\n\n\nBart, S., Pelosi, C., Nélieu, S., Lamy, I., & Péry, A. R. R. (2020). An energy-based model to analyze growth data of earthworms exposed to two fungicides. Environmental Science and Pollution Research, 27(1), 741–750. https://doi.org/10.1007/s11356-019-06985-z\n\n\nDingemanse, N. J., & Dochtermann, N. A. (2013). Quantifying individual variation in behaviour: Mixed‐effect modelling approaches. Journal of Animal Ecology, 82(1), 39–54. https://doi.org/10.1111/1365-2656.12013",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>A model for earthworm growth and its individual variation</span>"
    ]
  },
  {
    "objectID": "quarto/D_Growth_modeling.html",
    "href": "quarto/D_Growth_modeling.html",
    "title": "5  Analysis of experimental data",
    "section": "",
    "text": "5.1 Data used\nThe model is now fitted on our experimental data.\nCode\n1df_growth &lt;- read_excel(here::here(\"data/Data_growth_EPX_DMX.xlsx\"), sheet=\"Growth\")\n\n2dead &lt;- subset(df_growth, t==14 & status == \"D\")$ID\n\ndf_growth &lt;- df_growth |&gt; \n3  subset(t&lt;57 & (!ID %in% dead)) |&gt;\n  mutate(\n4    L            = w^(1/3),\n5    exposition   = as.factor(0 + 1*(exposition == \"Trt\")),\n    ID           = as.factor(ID)\n    )\n\n6df_growth_mean &lt;- df_growth |&gt;\n  aggregate(w ~ t + exposition, mean)\n\n7n_ctrl &lt;- length(subset(df_growth, t==0 & exposition == 0)$ID)\nn_trt &lt;- length(subset(df_growth, t==0 & exposition == 1)$ID)\n\n\n\n1\n\nRaw data importation\n\n2\n\nIndividuals that died before day 56\n\n3\n\nDataset of the first 56 days without the dead individuals\n\n4\n\nStructural length calculation (mg\\(^{1/3}\\)/d)\n\n5\n\nCreation of a new exposition variable for the sake of short model parameters’ names\n\n6\n\nCreation of a dataset with the mean growth per exposition group\n\n7\n\nNumber of individuals in each group\nCode\nalpha_point &lt;- 0.5\nalpha_line &lt;- 0.3\n\np_growth &lt;- ggplot(\n  data=df_growth, \n  aes(\n    x=t, \n    y=w, \n    color=exposition, \n    group=ID\n    )\n  ) +\n  \n  geom_line(\n    lwd=0.8, \n    alpha=alpha_line, \n    color = \"grey80\"\n    ) +\n  geom_point(\n    alpha=alpha_point, \n    size=2\n    ) +\n  facet_wrap(~exposition) +\n  \n  scale_color_manual(\n    values = pal_col, \n    label  = c(\"Non exposed\", \"Exposed\"), \n    name   = \"\"\n    ) +\n  \n  labs(\n    x         = \"Time (days)\", \n    y         = \"Weight (mg)\",\n    title     = \"Growth monitoring\",\n    subtitle  = \"For the &lt;span style = 'color:#5E81AC;'&gt;non exposed&lt;/span&gt; \n       and &lt;span style = 'color:#f42404;'&gt;exposed&lt;/span&gt; groups\"\n    )+\n  \n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_minimal(12)+\n  theme(\n    legend.position = \"none\",\n        \n    title=element_markdown(face=\"bold\"),\n    plot.subtitle=element_markdown(face=\"plain\"),\n        \n    axis.title=element_text(face=\"plain\"),\n        \n    strip.background = element_blank(),\n    strip.text = element_blank()\n    )\n\np_growth\n\n\n\n\n\n\n\n\nFigure 5.1: Evolution of fresh body weight of non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points and thin lines, each line corresponding to one individual).\nComparison of the initial state in both cohorts :\nCode\n1df_growth_t0 &lt;- subset(df_growth, t==0)\n\n# Equality of variances\n2var.test(\n  subset(df_growth_t0, exposition==0)$w,\n  subset(df_growth_t0, exposition==1)$w\n  )\n\n\n\n1\n\nDataset for t=0.\n\n2\n\nEquality of weight variance test between the two groups.\n\n\n\n\n\n    F test to compare two variances\n\ndata:  subset(df_growth_t0, exposition == 0)$w and subset(df_growth_t0, exposition == 1)$w\nF = 1.0131, num df = 26, denom df = 26, p-value = 0.9737\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.4617116 2.2231315\nsample estimates:\nratio of variances \n          1.013136\nThe datasets are not inconsistent with a ratio of variances equal to 1.\nCode\n# Equality of means\nt.test(df_growth_t0$w~df_growth_t0$exposition, var.equal=T)\n\n\n\n    Two Sample t-test\n\ndata:  df_growth_t0$w by df_growth_t0$exposition\nt = 0.41076, df = 52, p-value = 0.6829\nalternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0\n95 percent confidence interval:\n -1.496523  2.266894\nsample estimates:\nmean in group 0 mean in group 1 \n       12.47778        12.09259\nWe can conclude there is no effect of the cohort on the initial weight of the individuals.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis of experimental data</span>"
    ]
  },
  {
    "objectID": "quarto/D_Growth_modeling.html#sec-modeldef",
    "href": "quarto/D_Growth_modeling.html#sec-modeldef",
    "title": "5  Analysis of experimental data",
    "section": "5.2 Model prior definition",
    "text": "5.2 Model prior definition\n\n\nCode\n# Model definition\nbf.mod&lt;- \n  \n  bf(\n1    L  ~ L0+a*t,\n2    L0 ~ 1 + (1||ID),\n3    a  ~ 0 + exposition+(0+exposition||ID),\n    \n4    center=T,\n5    nl=T\n  )                              \n\n\n\n1\n\nEquation of L depending on t\n\n2\n\nEach individual can have its own L0 value but L0 does not depend on the exposition\n\n3\n\nEach individual can have its own a value and a depend on the exposition\n\n4\n\nData are centered in the calculation process\n\n5\n\nOur parameters have non-linear definitions\n\n\n\n\n\n\nCode\nList_parameters &lt;- \n  \n  c(\n    \"b_L0_Intercept\",       # L0_mu\n    \"sd_ID__L0_Intercept\",  # L0_sd\n    \"b_a_exposition0\",      # a_ctrl_mu\n    \"b_a_exposition1\",      # a_trt_mu\n    \"sd_ID__a_exposition0\", # a_ctrl_sd\n    \"sd_ID__a_exposition1\", # a_trt_sd\n    \"sigma\"                 # Residuals variance\n  )\n\n\nThe model parameters are named as follows by brms :\n\n\\(L0_{\\mu}\\) : b_L0_Intercept\n\\(L0_{\\sigma}\\) : sd_ID__L0_Intercept\n\\(a_{\\text{ctrl},\\mu}\\) : b_a_exposition0\n\\(a_{\\text{trt},\\mu}\\) : b_a_exposition1\n\\(a_{\\text{ctrl},\\sigma}\\) : sd_ID__a_exposition0\n\\(a_{\\text{trt},\\sigma}\\) : sd_ID__a_exposition1",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis of experimental data</span>"
    ]
  },
  {
    "objectID": "quarto/D_Growth_modeling.html#priors-definition",
    "href": "quarto/D_Growth_modeling.html#priors-definition",
    "title": "5  Analysis of experimental data",
    "section": "5.3 Priors definition",
    "text": "5.3 Priors definition\nThe priors were defined the same way as in Section 4.2.3.\n\n\nCode\n# Priors definition\npriors &lt;-\n1  prior(normal(2.32, 2.32*0.2), class = b, nlpar = L0, lb = 0) +\n2  prior(normal(2.32*0.2, 2.32*0.2), class = sd, nlpar = L0)+\n\n3  prior(normal(0.070, 0.070*0.2), class=b, coef=exposition0, nlpar = a) +\n4  prior(normal(0.070,  0.070*0.2), class=b, coef=exposition1, nlpar = a) +\n\n5  prior(normal(0.070*0.2,  0.070*0.2), class=sd,\n        coef=exposition0, group=ID, nlpar = a)+\n6  prior(normal(0.070*0.2,  0.070*0.2), class=sd,\n        coef=exposition1, group=ID, nlpar = a)+\n\n7  prior(exponential(1), sigma, nlpar = \"\")\n\n\n\n1\n\nPrior on \\(L0_{\\mu}\\)\n\n2\n\nPrior on \\(L0_{\\sigma}\\)\n\n3\n\nPrior on \\(a_{\\text{ctrl},\\mu}\\)\n\n4\n\nPrior on \\(a_{\\text{trt},\\mu}\\)\n\n5\n\nPrior on \\(a_{\\text{ctrl},\\sigma}\\)\n\n6\n\nPrior on \\(a_{\\text{trt},\\sigma}\\)\n\n7\n\nPrior on residuals",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis of experimental data</span>"
    ]
  },
  {
    "objectID": "quarto/D_Growth_modeling.html#prior-predictive-check",
    "href": "quarto/D_Growth_modeling.html#prior-predictive-check",
    "title": "5  Analysis of experimental data",
    "section": "5.4 Prior predictive check",
    "text": "5.4 Prior predictive check\nIn bayesian modeling, we first perform a prior predictive check before fitting the model to our data. This allows us to check on the rationnality of the chosen priors.\nResults of the model with the sampling of priors :\n\n\nCode\nm.prior &lt;- \n  \n  brm(\n1    data = df_growth,\n2    bf.mod,\n3    backend = \"cmdstanr\",\n4    prior = priors,\n5    sample_prior = \"only\",\n6    cores = 4,\n7    seed = 42,\n8    iter = 1000, warmup = 500,\n    control = list(\n9      adapt_delta = .95,\n      max_treedepth = 12\n      ), \n10    file=here::here(\"mod/m_brms_VI_prior\")\n  )\n\nprint(m.prior)\n\n\n\n1\n\nData used\n\n2\n\nModel to be used\n\n3\n\nType of backend for calculations\n\n4\n\nPriors to be used\n\n5\n\nWork only done with priors and not the data\n\n6\n\nCores for calculations\n\n7\n\nSeed for reproducibility\n\n8\n\nA total of 1000 interations are done with 500 that are part of the warmup phase\n\n9\n\nControl parameters on the iterations\n\n10\n\nPath where the model results are saved\n\n\n\n\nRunning MCMC with 4 parallel chains...\n\nChain 1 Iteration:   1 / 1000 [  0%]  (Warmup) \nChain 2 Iteration:   1 / 1000 [  0%]  (Warmup) \nChain 3 Iteration:   1 / 1000 [  0%]  (Warmup) \nChain 4 Iteration:   1 / 1000 [  0%]  (Warmup) \nChain 1 Iteration: 100 / 1000 [ 10%]  (Warmup) \nChain 1 Iteration: 200 / 1000 [ 20%]  (Warmup) \nChain 1 Iteration: 300 / 1000 [ 30%]  (Warmup) \nChain 1 Iteration: 400 / 1000 [ 40%]  (Warmup) \nChain 1 Iteration: 500 / 1000 [ 50%]  (Warmup) \nChain 1 Iteration: 501 / 1000 [ 50%]  (Sampling) \nChain 1 Iteration: 600 / 1000 [ 60%]  (Sampling) \nChain 2 Iteration: 100 / 1000 [ 10%]  (Warmup) \nChain 1 Iteration: 700 / 1000 [ 70%]  (Sampling) \nChain 1 Iteration: 800 / 1000 [ 80%]  (Sampling) \nChain 2 Iteration: 200 / 1000 [ 20%]  (Warmup) \nChain 2 Iteration: 300 / 1000 [ 30%]  (Warmup) \nChain 3 Iteration: 100 / 1000 [ 10%]  (Warmup) \nChain 4 Iteration: 100 / 1000 [ 10%]  (Warmup) \nChain 4 Iteration: 200 / 1000 [ 20%]  (Warmup) \nChain 1 Iteration: 900 / 1000 [ 90%]  (Sampling) \nChain 1 Iteration: 1000 / 1000 [100%]  (Sampling) \nChain 2 Iteration: 400 / 1000 [ 40%]  (Warmup) \nChain 2 Iteration: 500 / 1000 [ 50%]  (Warmup) \nChain 2 Iteration: 501 / 1000 [ 50%]  (Sampling) \nChain 2 Iteration: 600 / 1000 [ 60%]  (Sampling) \nChain 3 Iteration: 200 / 1000 [ 20%]  (Warmup) \nChain 3 Iteration: 300 / 1000 [ 30%]  (Warmup) \nChain 4 Iteration: 300 / 1000 [ 30%]  (Warmup) \nChain 4 Iteration: 400 / 1000 [ 40%]  (Warmup) \nChain 4 Iteration: 500 / 1000 [ 50%]  (Warmup) \nChain 4 Iteration: 501 / 1000 [ 50%]  (Sampling) \nChain 1 finished in 1.1 seconds.\nChain 2 Iteration: 700 / 1000 [ 70%]  (Sampling) \nChain 2 Iteration: 800 / 1000 [ 80%]  (Sampling) \nChain 3 Iteration: 400 / 1000 [ 40%]  (Warmup) \nChain 3 Iteration: 500 / 1000 [ 50%]  (Warmup) \nChain 3 Iteration: 501 / 1000 [ 50%]  (Sampling) \nChain 3 Iteration: 600 / 1000 [ 60%]  (Sampling) \nChain 4 Iteration: 600 / 1000 [ 60%]  (Sampling) \nChain 4 Iteration: 700 / 1000 [ 70%]  (Sampling) \nChain 2 Iteration: 900 / 1000 [ 90%]  (Sampling) \nChain 3 Iteration: 700 / 1000 [ 70%]  (Sampling) \nChain 3 Iteration: 800 / 1000 [ 80%]  (Sampling) \nChain 4 Iteration: 800 / 1000 [ 80%]  (Sampling) \nChain 4 Iteration: 900 / 1000 [ 90%]  (Sampling) \nChain 2 Iteration: 1000 / 1000 [100%]  (Sampling) \nChain 3 Iteration: 900 / 1000 [ 90%]  (Sampling) \nChain 3 Iteration: 1000 / 1000 [100%]  (Sampling) \nChain 4 Iteration: 1000 / 1000 [100%]  (Sampling) \nChain 2 finished in 1.3 seconds.\nChain 3 finished in 1.3 seconds.\nChain 4 finished in 1.2 seconds.\n\nAll 4 chains finished successfully.\nMean chain execution time: 1.2 seconds.\nTotal execution time: 1.7 seconds.\n\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: L ~ L0 + a * t \n         L0 ~ 1 + (1 || ID)\n         a ~ 0 + exposition + (0 + exposition || ID)\n   Data: df_growth (Number of observations: 264) \n  Draws: 4 chains, each with iter = 1000; warmup = 500; thin = 1;\n         total post-warmup draws = 2000\n\nMultilevel Hyperparameters:\n~ID (Number of levels: 54) \n                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsd(L0_Intercept)      0.58      0.36     0.04     1.36 1.00     1480      783\nsd(a_exposition0)     0.02      0.01     0.00     0.04 1.00     1433      851\nsd(a_exposition1)     0.02      0.01     0.00     0.04 1.00     1785      664\n\nRegression Coefficients:\n              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nL0_Intercept      2.31      0.47     1.41     3.23 1.00     2593     1180\na_exposition0     0.07      0.01     0.04     0.10 1.00     2671     1431\na_exposition1     0.07      0.01     0.04     0.10 1.00     2764     1426\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     0.96      0.93     0.02     3.38 1.00     1925      826\n\nDraws were sampled using sample(hmc). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\n\nWe can then plot the predictions of this model and see if they represent at least the full range of our experimental data.\n\n\nCode\n1pred &lt;- predicted_draws(m.prior, newdata=df_growth)\n\ny_max &lt;- 480\n\np_ctrl &lt;- ggplot()+\n  \n  stat_lineribbon(\n    data = pred[pred$exposition == 0,], \n    aes(x = t, y = .prediction^3, group = exposition),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_line(\n    data = df_growth[df_growth$exposition==0,],\n    aes(x = t, y = L^3, group=ID),\n    color = \"black\",\n    alpha = 0.4\n    )+\n  geom_point(\n    data = df_growth[df_growth$exposition==0,],\n    aes(x = t, y = L^3, group = ID),\n    color = \"black\",\n    alpha = 0.4\n    )+\n  \n  scale_fill_manual(values = rev(pal_blue))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  \n  ylim(0, y_max)+\n  \n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_minimal()+\n  theme(legend.position = \"none\")\n\n\np_trt &lt;- ggplot()+\n  \n  stat_lineribbon(\n    data = pred[pred$exposition==1,],\n    aes(x = t, y=.prediction^3, group=exposition),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_point(\n    data = df_growth[df_growth$exposition==1,],\n    aes(x = t, y = L^3, group = ID),\n    color = \"black\",\n    alpha = 0.4\n    )+\n  geom_line(\n    data = df_growth[df_growth$exposition==1,],\n    aes(x = t, y = L^3, group = ID),\n    color = \"black\",\n    alpha = 0.4\n    )+\n  \n  scale_fill_manual(values = rev(pal_red))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  \n  ylim(0, y_max)+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_minimal(14)+\n  theme(legend.position = \"none\")\n\nplot.prior_pred &lt;- p_ctrl + p_trt + \n  plot_layout(ncol = 2, guides = \"collect\") & \n  theme(\n    legend.position = \"right\", \n    title=element_text(face=\"bold\"), \n    axis.title.x = element_text(face=\"plain\"),\n    axis.title.y = element_text(face=\"plain\")\n    )\n\nplot.prior_pred\n\n\n\n1\n\nPredictions from the model\n\n\n\n\n\n\n\n\n\n\nFigure 5.2: Prior predictive check.\n\n\n\n\n\nThe Figure 5.2 shows the chosen priors are realistic.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis of experimental data</span>"
    ]
  },
  {
    "objectID": "quarto/D_Growth_modeling.html#posterior-predictive-check",
    "href": "quarto/D_Growth_modeling.html#posterior-predictive-check",
    "title": "5  Analysis of experimental data",
    "section": "5.5 Posterior predictive check",
    "text": "5.5 Posterior predictive check\n\n5.5.1 Model fit\nWe can now fit the model to our experimental data.\n\n\nCode\nm.post &lt;- \n  \n  brm(\n1    data = df_growth,\n2    bf.mod,\n3    backend = \"cmdstanr\",\n4    prior = priors,\n5    save_pars = save_pars(all = TRUE),\n6    sample_prior = \"yes\",\n7    seed = 42,\n8    chains = 4, cores = 4,\n9    iter = 6000, warmup = 1000,\n10    control = list(adapt_delta = .95,\n    max_treedepth = 12),\n11    file=here::here(\"mod/m_brms_VI_post\")\n  )\n\nprint(m.post)\n\n\n\n1\n\nData used\n\n2\n\nModel to be used\n\n3\n\nType of backend for calculations\n\n4\n\nPriors to be used\n\n5\n\nWe want all parameters to be saved\n\n6\n\nWork done with priors and the data\n\n7\n\nNumber of chains and cores for calculations\n\n8\n\nSeed for reproducibility\n\n9\n\nA total of 6000 interations are done with 1000 that are part of the warmup phase\n\n10\n\nControl parameters on the iterations\n\n11\n\nPath where the model results are saved\n\n\n\n\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: L ~ L0 + a * t \n         L0 ~ 1 + (1 || ID)\n         a ~ 0 + exposition + (0 + exposition || ID)\n   Data: df_growth (Number of observations: 264) \n  Draws: 4 chains, each with iter = 6000; warmup = 1000; thin = 1;\n         total post-warmup draws = 20000\n\nMultilevel Hyperparameters:\n~ID (Number of levels: 54) \n                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsd(L0_Intercept)      0.22      0.05     0.13     0.31 1.00     6857     7570\nsd(a_exposition0)     0.01      0.00     0.01     0.01 1.00     9636    13909\nsd(a_exposition1)     0.03      0.00     0.02     0.04 1.00     6424    10751\n\nRegression Coefficients:\n              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nL0_Intercept      2.18      0.04     2.09     2.26 1.00    20955    16122\na_exposition0     0.08      0.00     0.08     0.09 1.00    16363    15986\na_exposition1     0.07      0.01     0.06     0.08 1.00     3666     5945\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     0.29      0.02     0.26     0.32 1.00    12635    13018\n\nDraws were sampled using sample(hmc). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\n\n\n\n5.5.2 Parameter estimation results\nChains recuperation and calculation of additional parameters :\n\n\nCode\n1df_chains &lt;- ggs(m.post, burnin = T) |&gt;\n  filter(Parameter %in% List_parameters) |&gt;\n  mutate(\n    Chain=as.factor(Chain),\n    value=value\n    )\n                                             \n2df_chains_post &lt;- df_chains |&gt;\n  filter(Iteration&gt;1000)\n\n3df_chains_median &lt;- df_chains_post |&gt;\n  aggregate(value ~ Parameter, median) |&gt;\n  rename(median = value)\n\nParam_a_mu &lt;- c(\n  \"b_a_exposition0\", \n  \"b_a_exposition1\"\n  )\nParam_a_sd &lt;- c(\n  \"sd_ID__a_exposition0\", \n  \"sd_ID__a_exposition1\"\n  )\nParam_ctrl &lt;- c(\n  \"b_a_exposition0\", \n  \"sd_ID__a_exposition0\"\n  )\nParam_trt &lt;- c(\n  \"b_a_exposition1\", \n  \"sd_ID__a_exposition1\"\n  )\nParam_t0 &lt;- c(\n  \"b_L0_Intercept\",\n  \"sd_ID__L0_Intercept\", \n  \"Delta_a_mu\", \n  \"Delta_a_sd\",\n  \"sigma\"\n  )\n\n4df_chains_post_large &lt;-\n  dcast(\n    data = df_chains_post,\n    formula = Iteration + Chain ~ Parameter,\n    value.var = 'value'\n  )\n\ndf_chains_post_large &lt;- df_chains_post_large |&gt;\n  mutate(\n    Delta_a_mu = b_a_exposition1-b_a_exposition0,\n    Ratio_a_mu = b_a_exposition1/b_a_exposition0,\n    Delta_a_sd = sd_ID__a_exposition1-sd_ID__a_exposition0,\n    Ratio_a_sd = sd_ID__a_exposition1/sd_ID__a_exposition0,\n    LnRR = log(b_a_exposition1/b_a_exposition0),\n    LnCVR = log((sd_ID__a_exposition1/b_a_exposition1)/(sd_ID__a_exposition0/b_a_exposition0))\n  )\n\ndf_chains_post_long &lt;- df_chains_post_large |&gt;\n  melt(\n    id.vars=c(\"Iteration\", \"Chain\"),\n    measure.vars=colnames(df_chains_post_large)[-c(1,2)],\n    variable.name=\"Parameter\",\n    value.name=\"value\"\n  )\n\n\ndf_chains_post_long &lt;- df_chains_post_long |&gt; \n  mutate(\n    exposition = case_when(\n      Parameter %in% Param_ctrl ~ \"Non exposed\",\n      Parameter %in% Param_trt ~ \"Exposed\",\n      Parameter %in% Param_t0 ~ \"General\")\n    )\n\n\n\n1\n\nExtraction of each chain iterations values for each parameters\n\n2\n\nOnly iterations after the warmup phase\n\n3\n\nAdding medians from each distribution\n\n4\n\nCalculation and addition of 2 columns: \\(\\Delta a_{\\mu} = a_{\\text{trt},\\mu} - a_{\\text{ctrl},\\mu}\\) & \\(\\Delta a_{\\sigma} = a_{\\text{trt},\\sigma} - a_{\\text{ctrl},\\sigma}\\)\n\n\n\n\nThe results of the pesticides effect can be expressed with a response ratio (Ln(RR), Equation 5.1) and a coefficient of variation ratio (Ln(CVi), Equation 5.2).\n\\[\n\\text{Ln}(\\text{RR}) = \\text{Ln}\\left( \\frac{a_{trt,\\mu}}{a_{ctrl,\\mu}} \\right)\n\\tag{5.1}\\]\n\\[\n\\text{Ln}(\\text{CVi}) = \\text{Ln}\\left( \\frac{CV_{trt}}{CV_{ctrl}} \\right)\\\\\n\\tag{5.2}\\]\nWith :\n\\[\nCV_{x}=\\frac{a_{x,\\sigma}}{a_{x,\\mu}}\n\\]\nParameters estimation results :\n\n\nCode\nalpha_dens &lt;- 0.5\nalpha_dens_prior &lt;- 0.2\nalpha_like &lt;- 0.5\nfont_size &lt;- 12\ncol_dens &lt;- Nord_polar[1]\ncol_like &lt;- Nord_frost[2]\ncol_dens_ctrl &lt;- Nord_frost[4]\ncol_dens_trt &lt;- col_red\nsize_norm &lt;- 0.7\n\nprior_L0_mu &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"b\" & nlpar == \"L0\")\nprior_L0_sd &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sd\" & nlpar == \"L0\")\n\nprior_a_ctrl_mu &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"b\" & nlpar == \"a\" & coef == \"exposition0\")\nprior_a_ctrl_sd &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sd\" & nlpar == \"a\" & coef == \"exposition0\")\n\nprior_a_trt_mu &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"b\" & nlpar == \"a\" & coef == \"exposition1\")\nprior_a_trt_sd &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sd\" & nlpar == \"a\" & coef == \"exposition1\")\n\nprior_sigma &lt;- priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sigma\")\n\nplot_L0_mu &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_L0_mu,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"b_L0_Intercept\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens\n  ) +\n\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Mean initial structural length \" (mg^{1/3})))\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_L0_sd &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_L0_sd,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"sd_ID__L0_Intercept\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens\n  ) +\n\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Individual variation of\\ninitial structural length \" (mg^{1/3})))\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_a_ctrl_mu &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_a_ctrl_mu,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"b_a_exposition0\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens_ctrl,\n    color = col_dens_ctrl,\n    alpha = alpha_dens\n  ) +\n\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Mean growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Non-exposed\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_a_trt_mu &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_a_trt_mu,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"b_a_exposition1\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens_trt,\n    color = col_dens_trt,\n    alpha = alpha_dens\n  ) +\n\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Mean growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Exposed\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_a_ctrl_sd &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_a_ctrl_sd,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"sd_ID__a_exposition0\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens_ctrl,\n    color = col_dens_ctrl,\n    alpha = alpha_dens\n  ) +\n\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Inter-individual variation\\nof growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Non-exposed\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_a_trt_sd &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_a_trt_sd,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"sd_ID__a_exposition1\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens_trt,\n    color = col_dens_trt,\n    alpha = alpha_dens\n  ) +\n\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Inter-individual variation\\nof growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Exposed\"\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\nplot_sigma &lt;-\n  ggplot() +\n  stat_dist_halfeye(\n    data = prior_sigma,\n    aes(\n      xdist = .dist_obj\n      ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens_prior\n  ) +\n  stat_halfeye(\n    data = subset(df_chains_post_long,Parameter == \"sigma\"),\n    mapping = aes(\n      x=value,\n    ),\n    fill = col_dens,\n    color = col_dens,\n    alpha = alpha_dens\n  ) +\n\n  labs(\n    x = \"Value\",\n    y = \"Density\",\n    title = bquote(bold(\"Residual variance\" (mg^{1/3})))\n    )+\n  theme_minimal()+\n  theme(\n    axis.text.y = element_text(angle = 90),\n    plot.title = element_text(face = \"bold\")\n        )\n\n\np &lt;- (plot_L0_mu+ plot_a_ctrl_mu + plot_a_trt_mu)/(plot_L0_sd + plot_a_ctrl_sd   + plot_a_trt_sd) / plot_sigma \np\n\n\n\n\n\n\n\n\nFigure 5.3: Prior (light grey) and posterior distributions for each parameter.\n\n\n\n\n\nThe fit on data gives information on model parameters as the posterior distributions are much more restrictive on parameter values than our priors.\n\n\nCode\ndf_res_VI &lt;- summarise_draws(tidy_draws(m.post))\n\ndf_res_VI_show &lt;- df_res_VI[1:7,]\n\ndf_res_VI_show |&gt; datatable(\n  options = list(\n    dom = 't',\n    columnDefs = list(\n      list(className = 'dt-left', targets = \"_all\")\n      )\n    ), \n  class=\"hover\"\n  ) |&gt; \n  formatRound(columns = 2:length(df_res_VI_show), digits = 4)\n\n\n\n\nTable 5.1: Comparaison of the different statistical values of the posterior distributions\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nratio_effet_mu &lt;- abs(round((df_res_VI_show$median[3]-df_res_VI_show$median[2])/df_res_VI_show$median[2],2)*100)\naugmentation_effet_sd &lt;- round(df_res_VI_show$median[6]/df_res_VI_show$median[5],2)\n\nper_ind_var_ctrl &lt;- round(df_res_VI_show$median[5]/df_res_VI_show$median[2]*100, 2)\nper_ind_var_trt &lt;- round(df_res_VI_show$median[6]/df_res_VI_show$median[3]*100, 2)\n\n\nThe model estimations show a reduction of 10 % in the mean growth rate but a multiplication by 3.29 of the inter-individual variation of the growth rate.\nThere are 10.5 % of growth individual variation in the non-exposed group and 38.27 % in the exposed group.\n\n\nCode\n# Calculation of the results for Ln(RR) and Ln(CVi)\n\nMedian_LnRR &lt;- median(subset(df_chains_post_long, Parameter==\"LnRR\")$value)\nMedian_LnCVR &lt;- median(subset(df_chains_post_long, Parameter==\"LnCVR\")$value)\nMedian_LnRR_print &lt;- round(Median_LnRR, 2)\nMedian_LnCVR_print &lt;- round(Median_LnCVR, 2)\n\nMedian_Ratio_a_mu &lt;- median(subset(df_chains_post_long, Parameter==\"Ratio_a_mu\")$value)\nMedian_Ratio_a_sd &lt;- median(subset(df_chains_post_long, Parameter==\"Ratio_a_sd\")$value)\n\nCI_Ratio_a_mu &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter==\"Ratio_a_mu\")$value, method = \"ETI\", ci = 0.90)\nCI_Ratio_a_mu_p &lt;- paste(\"[\", round(CI_Ratio_a_mu$CI_low,2), \" ; \", round(CI_Ratio_a_mu$CI_high,2), \"]\", sep=\"\")\nCI_Ratio_a_sd &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter==\"Ratio_a_sd\")$value, method = \"ETI\", ci = 0.90)\nCI_Ratio_a_sd_p &lt;- paste(\"[\", round(CI_Ratio_a_sd$CI_low,2), \" ; \", round(CI_Ratio_a_sd$CI_high,2), \"]\", sep=\"\")\n\nCI_LnRR &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter==\"LnRR\")$value, method = \"ETI\", ci = 0.90)\nCI_LnRR_p &lt;- paste(\"[\", round(CI_LnRR$CI_low,2), \" ; \", round(CI_LnRR$CI_high,2), \"]\", sep=\"\")\n\nCI_LnCVR &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter==\"LnCVR\")$value, ci = 0.90)\nCI_LnCVR_p &lt;- paste(\"[\", round(CI_LnCVR$CI_low,2), \" ; \", round(CI_LnCVR$CI_high,2), \"]\", sep=\"\")\n\npd_LnRR &lt;- p_direction(subset(df_chains_post_long, Parameter==\"LnRR\")$value)\npd_LnCVR &lt;- p_direction(subset(df_chains_post_long, Parameter==\"LnCVR\")$value)\n\npd_Ratio_a_mu &lt;- p_direction(subset(df_chains_post_long, Parameter==\"Ratio_a_mu\")$value)\npd_Ratio_a_sd &lt;- p_direction(subset(df_chains_post_long, Parameter==\"Ratio_a_sd\")$value)\n\ndf_res_Ln &lt;- data.frame(\n  Variable = c(\"LnRR\", \"LnCVR\", \"Ratio a_mu\", \"Ratio a_sd\"),\n  Median = c(Median_LnRR, Median_LnCVR, Median_Ratio_a_mu, Median_Ratio_a_sd),\n  CI = c(CI_LnRR_p, CI_LnCVR_p, CI_Ratio_a_mu_p, CI_Ratio_a_sd_p),\n  pd = c(pd_LnRR$pd, pd_LnCVR$pd, pd_Ratio_a_mu$pd, pd_Ratio_a_sd$pd)\n) |&gt; \n  mutate(\n    Median = round(Median, 3)\n  )\n\n# Results expressed as LnRR and LnCVR\ndf_res_Ln |&gt; datatable(\n  options = list(\n    dom = 't',\n    autoWidth = TRUE,\n    columnDefs = list(\n      list(className = 'dt-left', targets = \"_all\")\n      )\n    ), \n  class=\"hover\"\n  ) \n\n\n\n\nTable 5.2: Effect size results\n\n\n\n\n\n\n\n\n\n\n\n\n5.5.3 Chains\nWe can check if the chains look good (Figure 5.4).\n\n\nCode\nplot &lt;-  \n  ggplot(\n    data = df_chains_post, \n    aes(\n      x = Iteration, \n      y = value, \n      color = Chain, \n      group = Chain\n      )\n  )+\n  geom_line(alpha=0.7)+\n  facet_wrap(~Parameter, scales = \"free\", ncol = 2)+\n  \n  scale_color_manual(values = nord(palette = \"frost\"))+\n  \n  theme_bw()+\n  theme(\n    legend.position = \"right\", \n    title=element_text(size=12, face=\"plain\"), \n    axis.title.x = element_text(face=\"plain\"),\n    strip.background = element_rect(fill=\"white\")\n    )\n\nplot\n\n\n\n\n\n\n\n\nFigure 5.4: Parameters chains (without the first 1000 iterations of warmup).\n\n\n\n\n\nWe can also check on the parameters correlations (Figure 5.5).\n\n\nCode\nbayesplot::color_scheme_set(\"gray\")\np &lt;- pairs(m.post, regex=T)\np\n\n\n\n\n\n\n\n\nFigure 5.5: Parameters correlations\n\n\n\n\n\n\n\n5.5.4 Comparison of observed vs predicted data\n\n\nCode\npred &lt;- predicted_draws(m.post, newdata=df_growth)\npost_i &lt;- as.data.frame(posterior_summary(m.post))\n\nID &lt;- subset(df_growth, t==0)$ID\nexpo &lt;- subset(df_growth, t==0)$exposition\n\ndf_estimates &lt;- \n  data.frame(\n    ID                = ID,\n    exposition        = expo,\n    r_L0_i            = post_i$Estimate[8:(8+length(ID)-1)],\n    r_a_i_expo_0      = post_i$Estimate[(8+length(ID)):(8+length(ID)*2-1)],\n    r_a_i_expo_1      = post_i$Estimate[(8+length(ID)*2):(8+length(ID)*3-1)],\n    r_a_i_2.5_expo_0  = post_i$Q2.5[(8+length(ID)):(8+length(ID)*2-1)],\n    r_a_i_2.5_expo_1  = post_i$Q2.5[(8+length(ID)*2):(8+length(ID)*3-1)],\n    r_a_i_97.5_expo_0 = post_i$Q97.5[(8+length(ID)):(8+length(ID)*2-1)],\n    r_a_i_97.5_expo_1 = post_i$Q97.5[(8+length(ID)*2):(8+length(ID)*3-1)]\n    ) |&gt; \n  mutate(\n    L0_i = post_i$Estimate[1]+r_L0_i,\n    a_i = case_when(\n      exposition == 0 ~ post_i$Estimate[2]+r_a_i_expo_0,\n      exposition == 1 ~ post_i$Estimate[3]+r_a_i_expo_1\n      ),\n    a_i_2.5 = case_when(\n      exposition==0 ~ post_i$Q2.5[2]+r_a_i_expo_0,\n      exposition==1 ~ post_i$Q2.5[3]+r_a_i_expo_1\n      ),\n    a_i_97.5 = case_when(\n      exposition==0 ~ post_i$Q97.5[2]+r_a_i_expo_0,\n      exposition==1 ~ post_i$Q97.5[3]+r_a_i_expo_1\n      )\n    ) |&gt; \n  select(ID, exposition, L0_i, a_i, a_i_2.5, a_i_97.5)\n\ndf_pred_mean &lt;- pred |&gt; \n  aggregate(\n    .prediction ~ t + ID + exposition, \n    FUN=mean\n    )\n\ndf_pred_Q &lt;- pred |&gt; \n  aggregate(\n    .prediction ~ t + ID + exposition, \n    FUN='quantile', \n    probs=c(2.5, 97.5)/100\n    )\n\n\ndf_pred &lt;- df_pred_mean |&gt; \n  cbind(df_pred_Q$.prediction[,1]) |&gt; \n  cbind(df_pred_Q$.prediction[,2]) |&gt;\n  mutate(Expo=case_when(exposition==0 ~ \"Non exposed\",\n                        exposition==1 ~ \"Exposed\"))\n\ncolnames(df_pred) &lt;- c(\"t\", \"ID\", \"exposition\", \n                       \"pred_L_mean\", \"pred_L_Q2.5\", \"pred_L_Q97.5\", \"Expo\")\n\n\n\n\nCode\ndf_growth_ordered &lt;- df_growth |&gt; arrange(t) |&gt; arrange(ID)\n\ndf_data_pred_obs &lt;- df_pred |&gt;\n  mutate(\n    w_obs = df_growth_ordered$w,\n    ratio_predobs = pred_L_mean^3 / w_obs\n    )\n\nfact_1 &lt;- 1.5\nfact_2 &lt;- 2\n\nseq_line &lt;- seq(1.1, 600, 0.1)\n\ndf_line &lt;- data.frame(\n  x1  = seq_line,\n  y1  = seq_line*fact_1,\n  x_1 = seq_line,\n  y_1 = seq_line/fact_1,\n  x2  = seq_line,\n  y2  = seq_line*fact_2,\n  x_2 = seq_line,\n  y_2 = seq_line/fact_2\n  )\n\nplot_predobs_log &lt;- ggplot()+ \n  \n  geom_line(\n    data=df_line, \n    mapping=aes(x=x1, y=y1), \n    linetype=\"dashed\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x_1, y=y_1), \n    linetype=\"dashed\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x2, y=y2), \n    linetype=\"dotted\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x_2, y=y_2), \n    linetype=\"dotted\"\n    )+\n  geom_abline(intercept=0, slope=1)+\n  geom_pointrange(\n    data = df_data_pred_obs, \n    aes(\n      x=w_obs,\n      y=pred_L_mean^3,\n      ymin=pred_L_Q2.5^3,\n      ymax=pred_L_Q97.5^3, \n      color=Expo\n      ), \n    alpha=0.5\n    )+\n  \n  scale_x_log10(limits=c(1.6, 700))+\n  scale_y_log10(limits=c(1.6, 700))+\n  \n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n  \n  labs(\n    x=\"Observed weight (mg)\", \n    y=\"Predicted weight (mg)\"\n    )+\n  \n  theme_minimal(24)+\n  theme(legend.position = \"bottom\")\n\nplot_predobs_log\n\n\n\n\n\n\n\n\nFigure 5.6: Results of the model fit on experimental data. Predicted values are represented with points with their respective credibility interval of 95%. Red points correspond to the predicted value for exposed individuals and blue points for the non exposed individuals. Dashed and dotted lines represent the 1.5-folds and 2-fold changes, respectively. The full line represents the identity line.\n\n\n\n\n\n\n\nCode\n# Percentage of points in the X-fold change area\nf_fold &lt;- function(fold){\n  res &lt;- length(\n    subset(\n      df_data_pred_obs, \n      ratio_predobs &lt; fold & ratio_predobs &gt; -fold\n      )$w_obs\n    )/length(subset(df_data_pred_obs, !is.na(w_obs))$t)\n  return(res)\n}\n\ndf_fold &lt;- data.frame(fold = c(1.1, 1.2, 1.25, 1.3, 1.5, 1.7, 2)) %&gt;%\n  mutate(per = signif(mapply(f_fold, fold),2)*100)\n\ncolnames(df_fold) &lt;- c(\"Fold\", \"Percentage of predictions within\")\n\ndf_fold |&gt; datatable(options = list(dom = 't'), class=\"hover\")\n\n\n\n\nTable 5.3: Percentage of points in the X-fold change area\n\n\n\n\n\n\n\n\n\n\n\nNon-exposedExposed\n\n\n\n\nCode\n## Non-exposed\n\nplot_predobs_log_ind_ctrl_save &lt;- ggplot()+ \n  \n  geom_line(\n    data=df_line, \n    mapping=aes(x=x1, y=y1), \n    linetype=\"dashed\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x_1, y=y_1), \n    linetype=\"dashed\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x2, y=y2), \n    linetype=\"dotted\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x_2, y=y_2), \n    linetype=\"dotted\"\n    )+\n  \n  geom_abline(intercept=0, slope=1)+\n  \n  geom_pointrange(\n    data = subset(df_data_pred_obs, exposition == 0), \n    aes(\n      x=w_obs,\n      y=pred_L_mean^3,\n      ymin=pred_L_Q2.5^3,\n      ymax=pred_L_Q97.5^3, \n      color=Expo\n      ), \n    alpha=0.5\n    )+\n  \n  facet_wrap(~ID, ncol=4)+\n  \n  scale_x_log10(limits=c(1.6, 700))+\n  scale_y_log10(limits=c(1.6, 700))+\n  \n  scale_color_manual(values=pal_col, name=\"\")+\n  scale_fill_manual(values=pal_col, name=\"\")+\n  \n  labs(\n    x=\"Observed weight (mg)\", \n    y=\"Predicted weight (mg)\"\n    )+\n  \n  theme_minimal(20)+\n  theme(\n    legend.position = \"bottom\",\n    axis.text=element_text(size=10)\n    )\nplot_predobs_log_ind_ctrl_save\n\n\n\n\n\n\n\n\nFigure 5.7: Results of the model fit on experimental data. Predicted values are represented with points with their respective credibility interval of 95%. Red points correspond to the predicted value for exposed individuals and blue points for the non exposed individuals. Dashed and dotted lines represent the 1.5-folds and 2-fold changes, respectively. The full line represents the identity line.\n\n\n\n\n\n\n\n\n\nCode\n## Exposed\n\nplot_predobs_log_ind_trt_save &lt;- ggplot()+ \n  \n  geom_line(\n    data=df_line, \n    mapping=aes(x=x1, y=y1), \n    linetype=\"dashed\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x_1, y=y_1), \n    linetype=\"dashed\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x2, y=y2), \n    linetype=\"dotted\"\n    )+\n  geom_line(\n    data=df_line, \n    mapping=aes(x=x_2, y=y_2), \n    linetype=\"dotted\"\n    )+\n  \n  geom_abline(intercept=0, slope=1)+\n  \n  geom_pointrange(\n    data = subset(df_data_pred_obs, exposition == 1), \n    aes(\n      x=w_obs,\n      y=pred_L_mean^3,\n      ymin=pred_L_Q2.5^3,\n      ymax=pred_L_Q97.5^3, \n      color=Expo\n      ), \n    alpha=0.5\n    )+\n  \n  facet_wrap(~ID, ncol=4)+\n  \n  scale_x_log10(limits=c(1.6, 700))+\n  scale_y_log10(limits=c(1.6, 700))+\n  \n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n  \n  labs(\n    x=\"Observed weight (mg)\", \n    y=\"Predicted weight (mg)\"\n    )+\n  \n  theme_minimal(20)+\n  theme(\n    legend.position = \"bottom\",\n    axis.text=element_text(size=10)\n    )\nplot_predobs_log_ind_trt_save\n\n\n\n\n\n\n\n\nFigure 5.8: Results of the model fit on experimental data. Predicted values are represented with points with their respective credibility interval of 95%. Red points correspond to the predicted value for exposed individuals and blue points for the non exposed individuals. Dashed and dotted lines represent the 1.5-folds and 2-fold changes, respectively. The full line represents the identity line.\n\n\n\n\n\n\n\n\n\n\n5.5.5 Model predictions\nWe now check the predictions of the model at the population level (Figure 5.9) and the individual level (Figure 5.10 & Figure 5.11) :\n\n\nCode\ny_max &lt;- 480\n\np_ctrl &lt;- ggplot()+\n  \n  stat_lineribbon(\n    data = pred[pred$exposition == 0,],\n    aes(x=t, y=.prediction^3, group=exposition),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_line(\n    data = df_growth[df_growth$exposition == 0,], \n    aes(x = t, y = L^3, group = ID), \n    color = \"#141c44\", \n    alpha = 0.4\n    )+\n  geom_point(\n    data = df_growth[df_growth$exposition == 0,], \n    aes(x = t, y = L^3, group = ID), color = \"#141c44\", alpha = 0.4\n    )+\n  \n  ylim(0, y_max)+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  scale_fill_manual(values = rev(pal_blue))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  \n  theme_minimal()+\n  theme(legend.position = \"none\")\n\np_trt &lt;- ggplot()+\n  stat_lineribbon(\n    data = pred[pred$exposition == 1,], \n    aes(x=t, y = .prediction^3, group = exposition),\n    .width = c(.99,.95,.8,.5),\n    color = \"black\"\n    )+\n  geom_point(\n    data = df_growth[df_growth$exposition == 1,], \n    aes(x = t, y = L^3, group = ID), \n    color = \"#380000\", \n    alpha = 0.4\n    )+\n  geom_line(\n    data = df_growth[df_growth$exposition == 1,], \n    aes(x = t, y = L^3, group = ID), \n    color = \"#380000\", \n    alpha = 0.4\n    )+\n  \n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  ylim(0, y_max)+\n  \n  \n  scale_fill_manual(values = rev(pal_red))+\n  \n  labs(y = \"Weight (mg)\", x = \"Time (days)\")+\n  \n  theme_minimal()+\n  theme(legend.position = \"none\")\n\nplot.estimates.grp &lt;- p_ctrl + p_trt + \n  plot_layout(ncol=2, guides=\"collect\") & \n  theme(\n    legend.position = \"right\", \n    title=element_text(face=\"bold\"), \n    axis.title.x = element_text(face=\"plain\"),\n    axis.title.y = element_text(face=\"plain\")\n    )\n\nplot.estimates.grp\n\n\n\n\n\n\n\n\nFigure 5.9: Posterior predictive check. Fresh body weight of non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points and thin lines, each line corresponding to one individual). Colored ribbons correspond to the different credibility intervals for the mean growth for each cohort. The thicker black lines represent the predicted mean body weight.\n\n\n\n\n\n\nNon-exposedExposed\n\n\n\n\nCode\np_ctrl &lt;- ggplot()+\n  stat_lineribbon(\n    data = pred[pred$exposition==0,], \n    aes(x = t, y=.prediction^3, color=exposition, group=ID),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_line(\n    data=df_growth[df_growth$exposition==0,], \n    aes(x=t, y=L^3, group=ID), \n    color=\"#141c44\", \n    alpha=0.25\n    )+\n  geom_point(\n    data=df_growth[df_growth$exposition==0,],\n    aes(x=t, y=L^3, group=ID), \n    color=\"#141c44\", \n    alpha=0.3, \n    size=2.5\n    )+\n  facet_wrap(~ID, ncol=5)+\n  \n  scale_fill_manual(values = rev(pal_blue))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  ylim(0, y_max)+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_bw()+\n  theme(\n    legend.position = \"right\", \n    title=element_text(size=12, face=\"plain\"), \n    axis.title.x = element_text(face=\"plain\"),\n    strip.background = element_rect(fill=\"white\")\n    )\np_ctrl\n\n\n\n\n\n\n\n\nFigure 5.10: Posterior predictive check. Fresh body weight of non-exposed earthworms (blue points). Colored ribbons correspond to the different credibility intervals for the predicted growth for each individual. The thicker black lines represent the predicted body weight.\n\n\n\n\n\n\n\n\n\nCode\np_trt &lt;- ggplot()+\n  stat_lineribbon(\n    data = pred[pred$exposition==1,],\n    aes(x = t, y=.prediction^3, color=exposition, group=ID),\n    .width=c(.99,.95,.8,.5),\n    color=\"black\"\n    )+\n  geom_point(\n    data=df_growth[df_growth$exposition==1,], \n    aes(x=t, y=L^3, group=ID), \n    color=\"#380000\", \n    alpha=0.3, \n    size=2.5\n    )+\n  geom_line(\n    data=df_growth[df_growth$exposition==1,], \n    aes(x=t, y=L^3, group=ID), \n    color=\"#380000\", \n    alpha=0.25\n    )+\n  facet_wrap(~ID, ncol=5, nrow=6)+\n  \n  scale_fill_manual(values = rev(pal_red))+\n  \n  labs(y=\"Weight (mg)\", x=\"Time (days)\")+\n  ylim(0, y_max)+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  \n  theme_bw()+\n  theme(\n    legend.position = \"right\", \n    title=element_text(size=12, face=\"plain\"), \n    axis.title.x = element_text(face=\"plain\"),\n    strip.background = element_rect(fill=\"white\")\n    )\np_trt\n\n\n\n\n\n\n\n\nFigure 5.11: Posterior predictive check. Fresh body weight of earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points). Colored ribbons correspond to the different credibility intervals for the predicted growth for each individual. The thicker black lines represent the predicted body weight.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis of experimental data</span>"
    ]
  },
  {
    "objectID": "quarto/D_Growth_modeling.html#individual-parameters",
    "href": "quarto/D_Growth_modeling.html#individual-parameters",
    "title": "5  Analysis of experimental data",
    "section": "5.6 Individual parameters",
    "text": "5.6 Individual parameters\n\n\nCode\nplot_L0_i &lt;- ggplot(data=df_estimates, aes(x=L0_i))+\n  \n  stat_dotsinterval(subguide = 'integer')+\n  geom_dotplot(\n    alpha=0.5, \n    dotsize =0.5,\n    width = 0.7,\n    binwidth = 0.05\n    )+\n  ylim(ymin=0, ymax=0.20)+\n  \n  labs(\n    x = bquote(\"Estimated initial volumetric structural length \" (mg^{1/3})), \n    y=\"\", \n    title=\"L0_i\")+\n  \n  theme_ggdist()\n\nplot_a_i &lt;- ggplot(\n  data=df_estimates, \n  aes(x=a_i, color=exposition, fill=exposition)\n  )+\n  \n  stat_dotsinterval(subguide = 'integer')+\n  geom_dotplot(\n    alpha=0.5, \n    dotsize =0.7,\n    width = 0.7,\n    binwidth = 0.005\n    )+\n  \n  facet_wrap(~exposition, ncol=1)+\n  \n  ylim(ymin=0, ymax=0.05)+\n  \n  labs(\n    x = bquote(\"Estimated growth rate \" (mg^{1/3}/d)), \n    y=\"\", \n    title=\"a_i\"\n    )+\n  \n  scale_color_manual(values=pal_col)+\n  scale_fill_manual(values=pal_col)+\n  \n  theme_ggdist()+\n  theme(\n    legend.position = \"bottom\",\n    strip.background = element_rect(fill=\"white\"),\n    strip.text=element_blank()\n    )\n\ngrid.arrange(\n  plot_L0_i, \n  plot_a_i, \n  layout_matrix = cbind(c(1, NA),c(2, 2)))\n\n\n\n\n\n\n\n\nFigure 5.12: Distribution of the individual parameters values.\n\n\n\n\n\n\n\nCode\n# Normality tests for the distribution of parameters\nshapiro.test(df_estimates$L0_i)\n\n\n\n    Shapiro-Wilk normality test\n\ndata:  df_estimates$L0_i\nW = 0.98021, p-value = 0.5095\n\n\nCode\nshapiro.test(subset(df_estimates, exposition==0)$a_i)\n\n\n\n    Shapiro-Wilk normality test\n\ndata:  subset(df_estimates, exposition == 0)$a_i\nW = 0.94292, p-value = 0.1438\n\n\nCode\nshapiro.test(subset(df_estimates, exposition==1)$a_i)\n\n\n\n    Shapiro-Wilk normality test\n\ndata:  subset(df_estimates, exposition == 1)$a_i\nW = 0.79426, p-value = 0.000109\n\n\n\n\nCode\ncol_diag &lt;- Nord_polar[4]\n\nplot_QQ_L0 &lt;- ggplot(mapping=aes(sample=df_estimates$L0_i))+\n  stat_qq(alpha=0.3,color=col_diag)+\n  stat_qq_line(color=col_diag)+\n  labs(x=\"Normal quantiles\", y=\"Residuals\", \n       title = bquote(bold(\"Initial structural length\")))+\n  theme_bw()\n\nplot_QQ_a_ctrl &lt;- ggplot(\n  mapping=aes(\n    sample=subset(df_estimates, exposition==0)$a_i\n    )\n  )+\n  stat_qq(\n    alpha=0.3,\n    color=col_blue\n    )+\n  stat_qq_line(color=col_blue)+\n  labs(\n    x=\"Normal quantiles\", \n    y=\"Residuals\", \n    title=bquote(bold(\"Growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Non-exposed\"\n       )+\n  theme_bw()\n\nplot_QQ_a_trt &lt;- ggplot(\n  mapping=aes(\n    sample=subset(df_estimates, exposition==1)$a_i\n    )\n  )+\n  stat_qq(\n    alpha=0.3, \n    color=col_red\n    )+\n  stat_qq_line(color=col_red)+\n  labs(\n    x=\"Normal quantiles\", \n    y=\"Residuals\", \n    title=bquote(bold(\"Growth rate \" (mg^{1/3}/d))),\n    subtitle = \"Exposed\"\n    )+\n  theme_bw()\n\nplot &lt;- plot_QQ_L0 + plot_QQ_a_ctrl + plot_QQ_a_trt + plot_layout(ncol=3)\nplot\n\n\n\n\n\n\n\n\nFigure 5.13: Normality test for parameters’ distributions.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis of experimental data</span>"
    ]
  },
  {
    "objectID": "quarto/D_Growth_modeling.html#results-summary",
    "href": "quarto/D_Growth_modeling.html#results-summary",
    "title": "5  Analysis of experimental data",
    "section": "5.7 Results summary",
    "text": "5.7 Results summary\n\n\nCode\n# Simulation of predicted trajectories\n\n# Times with weight measurements\nt_values &lt;- seq(0, 56, 0.1)\n\n# Calculation of each earthworm weight at each time point\ndf_data_pred &lt;- df_estimates |&gt; \n  expand_grid(t = t_values) |&gt;   \n  mutate(\n    L = L0_i + a_i * t\n    )\ndf_data_pred &lt;- df_data_pred |&gt; \n  mutate(\n    w = L^3,\n    exposition = case_when(\n      as.numeric(ID)&lt;=30 ~ \"Non-exposed\",\n      as.numeric(ID)&gt;30 ~ \"Exposed\")\n  )\n\ndf_data_pred$exposition &lt;- factor(\n  df_data_pred$exposition, \n  levels = c(\"Non-exposed\", \"Exposed\")\n  )\n\n\n\n\nCode\nline_width &lt;- 1.2\ny_max &lt;- 550\nx_max &lt;- 57\nfont_size &lt;- 16\n\nplot_growth_pred &lt;- ggplot()+\n  ylim(ymin=0, ymax=y_max)+\n  xlim(xmin=0, xmax=x_max)+\n  geom_line(\n    data=df_data_pred, \n    aes(\n      x=t, \n      y=w, \n      group=ID, \n      color=exposition\n      ), \n    alpha=1\n    )+\n  scale_color_manual(values=pal_col)+\n  scale_fill_manual(values=pal_col)+\n  facet_wrap(~exposition)+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  labs(\n    x=\"Time (days)\", \n    y=\"Weight (mg)\",\n    title = \"A\"\n    )+ \n  theme_minimal(font_size+4)+\n  theme(\n    legend.position = \"top\", \n    legend.title=element_blank(), \n    plot.title=element_text(size=sizetitle*1.5, face=\"bold\"), \n    axis.title.x = element_text(face=\"plain\", size=font_size+2), \n    axis.title.y = element_text(face=\"plain\", size=font_size+2),\n    strip.background = element_blank(),\n    strip.text = element_blank(),\n    plot.margin = margin(b = 40,\n                         t=10,\n                         l=10,\n                         r=10)\n    )\n\n\n\n\nCode\ncol_delta &lt;- Nord_polar[4]\nfont_size &lt;- 16\nalpha_dens &lt;- 0.6\nalpha_expo &lt;- 0.4\n\nplot_res_mu &lt;- ggplot(\n  data=subset(df_chains_post_long,Parameter %in% Param_a_mu), \n  aes(\n    #x=Parameter, \n    y=value,\n    color=exposition, \n    fill=exposition\n    )\n  )+\n  labs(\n    y=bquote(\"Mean growth rate \" (mg^{1/3}/d)),\n    title = \"B\"\n    )+\n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  \n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n  \n  theme_classic(font_size)+\n  theme(\n    plot.title=element_text(size=sizetitle*1.5, face=\"bold\"), \n    axis.line.x=element_blank(),\n    axis.title.x=element_blank(),\n    axis.ticks.x=element_blank(),\n    axis.text.x=element_blank(),\n    legend.position=\"none\",\n    plot.margin = margin(\n      b = 20,\n      t=20,\n      l=20,\n      r=20\n      )\n    )\n\nplot_res_sd &lt;- ggplot(\n  data=subset(df_chains_post_long,Parameter %in% Param_a_sd), \n  aes(\n    #x=Parameter, \n    y=value, \n    color=exposition, \n    fill=exposition\n    )\n  )+\n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  \n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n  \n  labs(y=bquote(\n    \"Inter-idividual variation of growth rate \" (mg^{1/3}/d)\n    ),\n    title = \"C\"\n    )+\n  \n  theme_classic(font_size)+\n  theme(\n    plot.title=element_text(size=sizetitle*1.5, face=\"bold\"), \n    axis.line.x=element_blank(),\n    axis.title.x=element_blank(),\n    axis.ticks.x=element_blank(),\n    axis.text.x=element_blank(),\n    legend.position=\"none\",\n    plot.margin = margin(\n      b = 20,\n      t=20,\n      l=20,\n      r=20\n      )\n    )\n\nplot_res_mu_delta &lt;- ggplot(\n  data=subset(df_chains_post_long,Parameter==\"Delta_a_mu\"), \n  aes(\n    #x=Parameter, \n    y=value\n    ), \n  color=col_delta, \n  fill=col_delta\n  )+\n  labs(y=\"Effect size\")+\n  stat_halfeye(\n    adjust=0.5, \n    alpha=alpha_expo\n    )+\n  geom_abline(\n    intercept=0, \n    slope=0, \n    color=col_delta, \n    linetype=\"dashed\"\n    )+\n  ylim(-0.025, 0.025)+\n  \n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n  \n  theme_classic(font_size-2)+\n  theme(\n    axis.line.x=element_blank(),\n    axis.title.x=element_blank(),\n    axis.ticks.x=element_blank(),\n    axis.text.x=element_blank(),\n    legend.position=\"none\"\n    )\n\nplot_res_sd_delta &lt;- ggplot(\n  data=subset(df_chains_post_long, Parameter==\"Delta_a_sd\"), \n  aes(\n    #x=Parameter, \n    y=value\n    ), \n  color=col_delta, \n  fill=col_delta\n  )+\n  labs(y=\"Effect size\")+\n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  geom_abline(\n    intercept=0, \n    slope=0, \n    color=col_delta, \n    linetype=\"dashed\"\n    )+\n  ylim(-0.025, 0.025)+\n  \n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n  \n  theme_classic(font_size-2)+\n  theme(\n    axis.line.x=element_blank(),\n    axis.title.x=element_blank(),\n    axis.ticks.x=element_blank(),\n    axis.text.x=element_blank(),\n    legend.position=\"none\"\n    )\n\nplot_res_mu_LnRR &lt;- \n  ggplot(\n    data=subset(df_chains_post_long,Parameter==\"LnRR\"), \n    aes(\n      #x=Parameter, \n      y=value\n      ), \n    color=col_delta, \n    fill=col_delta\n    )+\n  \n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  geom_abline(\n    intercept = 0, \n    slope = 0, \n    color = col_delta, \n    linetype = \"dashed\"\n    )+\n  annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = 0.18, \n    label = paste(\"Median\\n =\", Median_LnRR_print),\n    size = 4.2\n    )+\n  \n  ylim(-0.25, 0.25)+\n  \n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n  \n  labs(y=\"Effect size \\n(Ln RR)\")+\n  \n  theme_classic(font_size-3)+\n  theme(\n    axis.line.x=element_blank(),\n    axis.title.x=element_blank(),\n    axis.ticks.x=element_blank(),\n    axis.text.x=element_blank(),        \n    legend.position=\"none\"\n    )\n\nplot_res_sd_LnCVR &lt;- \n  ggplot(\n    data=subset(df_chains_post_long, Parameter==\"LnCVR\"), \n    aes(\n      #x=Parameter, \n      y=value\n      ), \n    color=col_delta,\n    fill=col_delta\n    )+\n  \n  stat_halfeye(\n    adjust=0.5,\n    alpha=alpha_expo\n    )+\n  geom_abline(\n    intercept=0, \n    slope=0, \n    color=col_delta,\n    linetype=\"dashed\"\n    )+\n  annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = -1.4, \n    label = paste(\"Median\\n =\", Median_LnCVR_print),\n    size = 4.2\n    )+\n  ylim(-2, 2)+\n  \n  scale_color_manual(values=rev(pal_col), name=\"\")+\n  scale_fill_manual(values=rev(pal_col), name=\"\")+\n  \n  labs(y=\"Effect size \\n(Ln CVi)\")+\n    \n  theme_classic(font_size-3)+\n  theme(\n    axis.line.x=element_blank(),\n    axis.title.x=element_blank(),\n    axis.ticks.x=element_blank(),\n    axis.text.x=element_blank(),\n    legend.position=\"none\"\n    )\n\nplot &lt;- plot_res_mu + plot_res_sd + \n  plot_res_mu_delta + plot_res_sd_delta + \n  plot_res_mu_LnRR + plot_res_sd_LnCVR +\n  plot_layout(ncol=2, guides=\"collect\")\n\n\n\n\nCode\n# Results figure\nplot &lt;- grid.arrange(\n  plot_growth_pred, \n  plot_res_mu, plot_res_sd,\n  plot_res_mu_LnRR, plot_res_sd_LnCVR,\n  ncol=6,\n    layout_matrix = cbind(\n    c(1, 1, 1, 2, 2, 2), \n    c(1, 1, 1, 2, 2, 2),\n    c(1, 1, 1, 2, 2, 2), \n    c(1, 1, 1, 2, 2, 2), \n    c(1, 1, 1, 2, 2, 2),\n    c(1, 1, 1, 4, NA, NA),\n    c(1, 1, 1, 4, NA, NA),\n    c(1, 1, 1, 3, 3, 3), \n    c(1, 1, 1, 3, 3, 3), \n    c(1, 1, 1, 3, 3, 3), \n    c(1, 1, 1, 3, 3, 3),\n    c(1, 1, 1, 3, 3, 3),\n    c(1, 1, 1, 5, NA, NA),\n    c(1, 1, 1, 5, NA, NA)\n    )\n  )\n\ngrid::grid.draw(plot)\n\n\n\n\n\n\n\n\nFigure 5.14: Results summary. A) Estimated growth trajectories of non-exposed and exposed individuals (blue = non exposed, red = exposed). B) Comparison of the posterior distribution of the mean growth rate between the two cohorts and the corresponding effect size as the logarithm of the response ratio (Ln RR). C) Comparison of the posterior distribution of the individual variation of growth rate between the two cohorts and the corresponding effect size as the logarithm of the coefficient of variation ratio (Ln CVi).\n\n\n\n\n\n\n Session Information \n\n\n\n\n\nCode\nsessionInfo()\n\n\nR version 4.2.2 (2022-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS 14.0\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n [1] parallel  grid      stats4    stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] devtools_2.4.5     usethis_2.2.3      readxl_1.4.3       DT_0.33           \n [5] kableExtra_1.4.0   knitr_1.47         latex2exp_0.9.6    nlstools_2.1-0    \n [9] lsmeans_2.30-0     emmeans_1.10.3     Hmisc_5.1-3        car_3.1-2         \n[13] carData_3.0-5      modelsummary_2.2.0 extrafont_0.19     gridExtra_2.3     \n[17] ggpubr_0.6.0       plotly_4.10.4      ggtext_0.1.2       ggbreak_0.1.2     \n[21] cowplot_1.1.3      patchwork_1.2.0    ggdist_3.3.2       nord_1.0.0        \n[25] RColorBrewer_1.1-3 wesanderson_0.3.7  viridis_0.6.5      viridisLite_0.4.2 \n[29] ggthemes_5.1.0     see_0.8.4.3        report_0.5.8       parameters_0.22.2 \n[33] performance_0.12.0 modelbased_0.8.8   insight_0.20.4     effectsize_0.8.8  \n[37] datawizard_0.11.0  correlation_0.8.5  bayestestR_0.13.2  easystats_0.7.2   \n[41] deSolve_1.40       priorsense_1.0.4   truncnorm_1.0-9    tmvtnorm_1.6      \n[45] gmm_1.8            sandwich_3.1-0     Matrix_1.6-5       mvtnorm_1.2-5     \n[49] fdrtool_1.2.17     tidybayes_3.0.6    ggmcmc_1.5.1.1     glmmTMB_1.1.9     \n[53] rstan_2.32.6       StanHeaders_2.32.9 cmdstanr_0.8.0     brms_2.22.0       \n[57] Rcpp_1.0.12        plan_0.4-5         reshape2_1.4.4     lubridate_1.9.3   \n[61] forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2       \n[65] readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1     \n[69] tidyverse_2.0.0    here_1.0.1        \n\nloaded via a namespace (and not attached):\n  [1] utf8_1.2.4           tidyselect_1.2.1     lme4_1.1-31         \n  [4] htmlwidgets_1.6.4    munsell_0.5.1        ragg_1.3.2          \n  [7] codetools_0.2-20     miniUI_0.1.1.1       withr_3.0.0         \n [10] Brobdingnag_1.2-9    colorspace_2.1-0     tables_0.9.28       \n [13] rstudioapi_0.16.0    ggsignif_0.6.4       Rttf2pt1_1.3.12     \n [16] bayesplot_1.11.1     labeling_0.4.3       farver_2.1.2        \n [19] bridgesampling_1.1-2 rprojroot_2.0.4      coda_0.19-4.1       \n [22] vctrs_0.6.5          generics_0.1.3       TH.data_1.1-2       \n [25] xfun_0.45            timechange_0.3.0     markdown_1.13       \n [28] R6_2.5.1             cachem_1.1.0         gridGraphics_0.5-1  \n [31] promises_1.3.0       scales_1.3.0         multcomp_1.4-25     \n [34] nnet_7.3-19          gtable_0.3.5         processx_3.8.4      \n [37] rlang_1.1.4          systemfonts_1.1.0    splines_4.2.2       \n [40] rstatix_0.7.2        extrafontdb_1.0      TMB_1.9.11          \n [43] lazyeval_0.2.2       broom_1.0.6          checkmate_2.3.1     \n [46] inline_0.3.19        yaml_2.3.8           abind_1.4-5         \n [49] crosstalk_1.2.1      backports_1.5.0      httpuv_1.6.15       \n [52] gridtext_0.1.5       tensorA_0.36.2.1     tools_4.2.2         \n [55] ggplotify_0.1.2      ellipsis_0.3.2       jquerylib_0.1.4     \n [58] posterior_1.6.0      sessioninfo_1.2.2    plyr_1.8.9          \n [61] base64enc_0.1-3      ps_1.7.6             rpart_4.1.23        \n [64] urlchecker_1.0.1     zoo_1.8-12           cluster_2.1.6       \n [67] fs_1.6.4             magrittr_2.0.3       data.table_1.15.4   \n [70] matrixStats_1.3.0    pkgload_1.4.0        mime_0.12           \n [73] hms_1.1.3            evaluate_0.24.0      arrayhelpers_1.1-0  \n [76] xtable_1.8-4         rstantools_2.4.0     compiler_4.2.2      \n [79] V8_4.4.2             minqa_1.2.7          htmltools_0.5.8.1   \n [82] later_1.3.2          ggfun_0.1.6          mgcv_1.9-1          \n [85] tzdb_0.4.0           Formula_1.2-5        aplot_0.2.3         \n [88] RcppParallel_5.1.7   MASS_7.3-58.1        boot_1.3-30         \n [91] cli_3.6.3            pkgconfig_2.0.3      numDeriv_2016.8-1.1 \n [94] foreign_0.8-87       xml2_1.3.6           svUnit_1.0.6        \n [97] svglite_2.1.3        bslib_0.7.0          QuickJSR_1.2.2      \n[100] ggstats_0.6.0        estimability_1.5.1   yulab.utils_0.1.7   \n[103] distributional_0.4.0 digest_0.6.36        cellranger_1.1.0    \n[106] rmarkdown_2.27       htmlTable_2.4.2      curl_5.2.1          \n[109] commonmark_1.9.1     shiny_1.8.1.1        nloptr_2.0.3        \n[112] lifecycle_1.0.4      nlme_3.1-160         jsonlite_1.8.8      \n[115] fansi_1.0.6          pillar_1.9.0         lattice_0.22-6      \n[118] loo_2.8.0            GGally_2.2.1         fastmap_1.2.0       \n[121] httr_1.4.7           pkgbuild_1.4.4       survival_3.7-0      \n[124] remotes_2.5.0        glue_1.7.0           sass_0.4.9          \n[127] profvis_0.3.8        stringi_1.8.4        textshaping_0.4.0   \n[130] memoise_2.0.1",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis of experimental data</span>"
    ]
  },
  {
    "objectID": "quarto/E_Less_replicates.html",
    "href": "quarto/E_Less_replicates.html",
    "title": "6  Can we ignore individual differences? Bias, type M and type S errors in OECD guidelines using a simulation study",
    "section": "",
    "text": "!!!!!!!!! REFAIRE TOURNER LE BOOTSTRAP !!!!!!!!!!!!!!!!!!!!!\nWe also sought to assess the accuracy of our inference if we had followed a typical biotest design for Environmental Risk Assessment (ERA). The standardized earthworm reproduction test of the OECD (TG n°222), which also assesses growth effects, recommends four replicates per treatment and eight replicates for the control condition, with each replicate containing 10 earthworms. To simulate this design, we used the results of our growth model to generate growth data for 500 individuals. Using this simulated dataset, we performed a bootstrap procedure with 1,000 iterations. Each iteration corresponded to an experimental design adhering to the OECD TG 222 guidelines, where individuals were randomly assigned to replicates according to the recommended structure. This approach allowed us to estimate the variability and potential biases in parameter inference under the constraints of a typical ERA experimental design. This approach allowed us to calculate the Type M (magnitude) and Type S (sign) errors on the effect estimation, providing insights into the reliability and accuracy of the inferred parameters under the constraints of a typical ERA experimental design.\nThe R file used and the corresponding results are available in the bootstrap folder. The script ran on a Macbook Air M2 for about 12 hours.\nWe start by loading the results of our previous model with all the 30 replicates per groups for comparison :\n\n\nCode\nm.30 &lt;- brm(file=here::here(\"mod/m_brms_VI_post\"))\nres_30 &lt;- as.data.frame(posterior_summary(m.30))\n\nL0_est30       &lt;- res_30$Estimate[1]\na_ctrl_est30   &lt;- res_30$Estimate[2]\na_trt_est30    &lt;- res_30$Estimate[3]\nL0sd_est30     &lt;- res_30$Estimate[4]\nasd_ctrl_est30 &lt;- res_30$Estimate[5]\nasd_trt_est30  &lt;- res_30$Estimate[6]\n\neffect_est30   &lt;- a_trt_est30/a_ctrl_est30\neffectsd_est30 &lt;- asd_trt_est30/asd_ctrl_est30\n\nres_show &lt;- res_30[1:7,] |&gt; \n  datatable(options = list(dom = 't'), class=\"hover\") \nres_show\n\n\n\n\nTable 6.1: Results summary of the model with 30 individuals in each group\n\n\n\n\n\n\n\n\n\n\nWe can then load the results of the bootstrap :\n\n\nCode\nload(file=here::here(\"bootstrap/Bootstrap_VI_OECD_seed121212_28j_f.RData\"))\n\ndf_draws &lt;- res_f\n\ndf_draws_show &lt;- df_draws[1:4] |&gt; \n  datatable(options = list(dom = 't'), class=\"hover\", rownames=FALSE) \ndf_draws_show\n\n\n\n\nTable 6.2: 6 first line of the bootstrap result\n\n\n\n\n\n\n\n\n\n\nFinally, we can calculate the parameter estimation errors for all iterations.\n\n\nCode\ndf_draws_f &lt;- df_draws %&gt;%\n  mutate(\n    err_L0              = (L0_est30-L0_est)/L0_est30,\n    err_a_ctrl          = (a_ctrl_est-a_ctrl_est30)/a_ctrl_est30,\n    err_a_trt           = (a_trt_est-a_trt_est30)/a_trt_est30,\n    effect              = a_trt_est/a_ctrl_est,\n    err_effect          = (effect-effect_est30)/effect_est30,\n    err_L0sd            = (L0sd_est-L0sd_est30)/L0sd_est30,\n    err_asd_ctrl        = (asd_ctrl_est-asd_ctrl_est30)/asd_ctrl_est30,\n    err_asd_trt         = (asd_trt_est-asd_trt_est30)/asd_trt_est30,\n    effectsd            = asd_trt_est/asd_ctrl_est,\n    err_effectsd        = (effectsd-effectsd_est30)/effectsd_est30,\n    bol_contrary_ccl_mu = (a_trt_est&gt;a_ctrl_est),\n    bol_contrary_ccl_sd = (asd_trt_est&lt;asd_ctrl_est)\n  )\n\n\n\n\nCode\nalpha_stat &lt;- 0.7\nalpha_expo &lt;- 0.3\nlinevertic &lt;- 1.2\nalpha_dens &lt;- 0.5\n\nx_min_err    &lt;- -0.3*100\nx_max_err    &lt;- -x_min_err\nx_min_errsd  &lt;- -4.4*100\nx_max_errsd  &lt;- -x_min_errsd\nbin_width    &lt;- 0.05*100\nbin_width_sd &lt;- 0.15*100\n\nsizetitle &lt;- 10\n\nplot_L0 &lt;- ggplot(\n  data=df_draws_f, \n  aes(x=err_L0*100)\n  )+\n  geom_histogram(\n    binwidth=bin_width,\n    color=Nord_polar[4], \n    fill = Nord_polar[4], \n    alpha=alpha_expo\n    )+\n  geom_vline(\n    xintercept = 0, , \n    linetype=\"dashed\"\n    )+\n  xlim(\n    x_min_err, \n    x_max_err\n    )+\n  labs(\n    x=TeX(r\"( Error on $L0_{\\mu}$ (%) )\"), \n    y=\"\"\n    )+\n  theme_bw(sizetitle)\n\nplot_a_ctrl &lt;- ggplot(\n  data=df_draws_f, \n  aes(x=err_a_ctrl*100)\n  )+\n  geom_histogram(\n    binwidth=bin_width,\n    color=pal_col[1], \n    fill = pal_col[1], \n    alpha=alpha_expo\n    )+\n  geom_vline(\n    xintercept = 0, \n    linetype=\"dashed\"\n    )+\n  labs(\n    x=TeX(r\"( Error on $a_{non\\ exposed,\\mu}$ (%) )\"), \n    y=\"\"\n    )+\n  xlim(\n    x_min_err, \n    x_max_err\n    )+\n  theme_bw(sizetitle)\n\nplot_a_trt &lt;- ggplot(\n  data=df_draws_f, \n  aes(x=err_a_trt*100)\n  )+\n  geom_histogram(\n    binwidth=bin_width,\n    color=pal_col[2], \n    fill = pal_col[2], \n    alpha=alpha_expo\n    )+\n  geom_vline(\n    xintercept = 0, \n    linetype=\"dashed\"\n    )+\n  labs(\n    x=TeX(r\"( Error on $a_{exposed,\\mu}$ (%) )\"), \n    y=\"\"\n    )+\n  xlim(\n    x_min_err, \n    x_max_err\n    )+\n  theme_bw(sizetitle)\n\nplot_effect &lt;- ggplot(\n  data=df_draws_f, \n  aes(x=err_effect*100)\n  )+\n  geom_histogram(\n    binwidth=bin_width,\n    color=Nord_polar[1], \n    fill = Nord_polar[1], \n    alpha=alpha_expo\n    )+\n  geom_vline(\n    xintercept = 0, \n    linetype=\"dashed\"\n    )+\n  labs(\n    x=bquote(\"Error on the estimated mean effect (%)\"), \n    y=\"\"\n    )+\n  xlim(\n    x_min_err, \n    x_max_err\n    )+\n  theme_bw(sizetitle)\n\nplot_L0sd &lt;- ggplot(\n  data=df_draws_f, \n  aes(x=err_L0sd*100)\n  )+\n  geom_histogram(\n    binwidth=bin_width_sd,\n    color=Nord_polar[4], \n    fill = Nord_polar[4], \n    alpha=alpha_expo\n    )+\n  geom_vline(\n    xintercept = 0, \n    linetype=\"dashed\"\n    )+\n  labs(\n    x=TeX(r\"( Error on $L0_{\\sigma}$ (%) )\"), \n    y=\"\"\n    )+\n  xlim(\n    x_min_errsd, \n    x_max_errsd\n    )+\n  theme_bw(sizetitle)\n\nplot_asd_ctrl &lt;- ggplot(\n  data=df_draws_f, \n  aes(x=err_asd_ctrl*100)\n  )+\n  geom_histogram(\n    binwidth=bin_width_sd,\n    color=pal_col[1], \n    fill = pal_col[1], \n    alpha=alpha_expo\n    )+\n  geom_vline(\n    xintercept = 0, \n    linetype=\"dashed\"\n    )+\n  labs(\n    x=TeX(r\"( Error on $a_{non\\ exposed,\\sigma}$ (%) )\"), \n    y=\"\"\n    )+\n  xlim(\n    x_min_errsd, \n    x_max_errsd\n    )+\n  theme_bw(sizetitle)\n\nplot_asd_trt &lt;- ggplot(\n  data=df_draws_f, \n  aes(x=err_asd_trt*100)\n  )+\n  geom_histogram(\n    binwidth=bin_width_sd,\n    color=pal_col[2], \n    fill = pal_col[2], \n    alpha=alpha_expo\n    )+\n  geom_vline(\n    xintercept = 0,\n    linetype=\"dashed\"\n    )+\n  labs(\n    x=TeX(r\"( Error on $a_{exposed,\\sigma}$ (%) )\"), \n    y=\"\"\n    )+\n  xlim(\n    x_min_errsd, \n    x_max_errsd\n    )+\n  theme_bw(sizetitle)\n\nplot_effectsd &lt;- ggplot(\n  data=df_draws_f, \n  aes(x=err_effectsd*100)\n  )+\n  geom_histogram(\n    binwidth=bin_width_sd,\n    color=Nord_polar[1], \n    fill = Nord_polar[1], \n    alpha=alpha_expo\n    )+\n  geom_vline(\n    xintercept = 0,\n    linetype=\"dashed\"\n    )+\n  labs(\n    x=bquote(\"Error on the estimated effect\\n on individual variation (%)\"), \n    y=\"\"\n    )+\n  xlim(\n    x_min_errsd, \n    x_max_errsd\n    )+\n  theme_bw(sizetitle)\n\nplot &lt;- plot_L0 + plot_L0sd + plot_a_ctrl + plot_asd_ctrl+ plot_a_trt+ plot_asd_trt + plot_effect + plot_effectsd +\n  plot_layout(\n    ncol=2, \n    guides=\"collect\"\n    ) & \n  theme(\n    legend.position = \"right\", \n    title=element_text(size=sizetitle, face=\"bold\"), \n    axis.title.x = element_text(face=\"plain\")\n    )\nplot\n\n\n\n\n\n\n\n\nFigure 6.1: Error percentage on the different model parameters and the estimated effect on mean growth rate and its individual variation obtained with a bootstrap (n = 1000) with 8 or 4 replicates for the non-exposed and exposed conditions respectively (type M errors). One replicate represents 10 randomly chosen individuals. The bin width for estimated means and the error on the estimated individual variations are 5% and 15% respectively. The median of the distributions are 3.7% and 16.3% respectively.\n\n\n\n\n\n\n\nCode\ndf_res_draws &lt;- df_draws_f %&gt;%\n  pivot_longer(\n    cols = -ID_draws, # Garde ID_draws intact\n    names_to = \"variable\",\n    values_to = \"value\"\n  ) %&gt;%\n  group_by(variable) %&gt;%\n  summarise(\n    median = median(value)*100,\n    mean = mean(value)*100,\n    Q2.5 = quantile(value, 0.025)*100,\n    Q97.5 = quantile(value, 0.975)*100\n  )\n\nselected_var &lt;- c(\"err_L0\", \"err_a_ctrl\", \"err_a_trt\", \"err_L0sd\", \"err_asd_ctrl\", \"err_asd_trt\", \"err_effect\", \"err_effectsd\")\n\ndf_res_draws &lt;- df_res_draws |&gt; \n  filter(variable %in% selected_var)\n\ndf_res_draws_show &lt;- df_res_draws |&gt; datatable(\n  options = list(dom = 't'), \n  class=\"hover\"\n  ) |&gt; \n  formatRound(columns = 2:length(df_res_draws), digits = 2)\ndf_res_draws_show\nmean_err_effect &lt;- round(subset(df_res_draws, variable == \"err_effect\")$mean,2)\nmean_err_effectsd &lt;- round(subset(df_res_draws, variable == \"err_effectsd\")$mean,2)\n\n\n\n\nTable 6.3: Statistical summary of the parameters distributions (in % or error)\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nx = c(.05,.10,.25, .50, .75, .90, .95, 1, 2, 3, 4)\n\ndf_err &lt;- data.frame(x = x) %&gt;%\n  mutate(\n    L0       = map_dbl(x, ~ sum(abs(df_draws_f$err_L0) &lt;= .x) / 1000*100),\n    a_ctrl   = map_dbl(x, ~ sum(abs(df_draws_f$err_a_ctrl) &lt;= .x) / 1000*100),\n    a_trt    = map_dbl(x, ~ sum(abs(df_draws_f$err_a_trt) &lt;= .x) / 1000*100),\n    asd_ctrl = map_dbl(x, ~ sum(abs(df_draws_f$err_asd_ctrl) &lt;= .x) / 1000*100),\n    asd_trt  = map_dbl(x, ~ sum(abs(df_draws_f$err_asd_trt) &lt;= .x) / 1000*100),\n    effect   = map_dbl(x, ~ sum(abs(df_draws_f$err_effect) &lt;= .x) / 1000*100),\n    effectsd = map_dbl(x, ~ sum(abs(df_draws_f$err_effectsd) &lt;= .x) / 1000*100)\n  )\n\nl_df_err &lt;- length(df_err)\n\ndf_err_show &lt;- df_err |&gt; \n  datatable(\n    options = list(dom = 't'), \n    class=\"hover\", \n    rownames=FALSE\n    )  |&gt; \n  formatRound(columns = 1:length(df_err), digits = 2)\n\ndf_err_show\nPer_sample_err_effect_5 &lt;- subset(df_err, x == 0.05)$effect\nPer_sample_err_effect_10 &lt;- subset(df_err, x == 0.10)$effect\nnb_err_effectsd_sup100 &lt;- (100-subset(df_err, x == 1.0)$effectsd)/100*1000\n\n\n\n\nTable 6.4: Percentage of iteration for which the error on the different model parameters and effects on mean growth rate and its individual variation is inferior to the given x value.\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nCount_mu_higher_in_exposed &lt;- length(subset(df_draws_f, bol_contrary_ccl_mu==TRUE)$ID_draws)\nCount_sd_lower_in_exposed &lt;- length(subset(df_draws_f, bol_contrary_ccl_sd==TRUE)$ID_draws)\n\nPer_contrary_ccl_mu &lt;- Count_mu_higher_in_exposed/1000*100\nPer_contrary_ccl_sd &lt;- Count_sd_lower_in_exposed/1000*100\n\n\nWhen compared to our experimental design using 30 individuals, the results of this bootstrap indicate that the population-level effect would still be well estimated with deviations not exceeding ±5% and 10% in 50.9% and 84.5% of the samples, respectively, but with an average overestimation of 4.4%. However, estimating individual-level variability proved much more challenging, with errors reaching up to 200% in 81 samples. This suggests that the variation in growth rate among individuals would likely be poorly captured, with the effect often underestimated by approximately 50%, and in some cases, overestimated by more than 200%. We also note that the direction of the effect was misestimated in 11% of cases for the mean effect and 2.8% for individual variation (type S error).\nThese simulations of an OECD protocol identified important limitations of simplified traditional approaches, particularly in tests with a single control and one concentration. By simulating fewer replicates with measurements at the replicate scale, we demonstrated that small studies may fail to capture the full range of inter-individual differences and, in some cases, increase the risk of misinterpreting the direction of a substance’s effect. For example, in a hypothetical scenario of a simplified design of the OECD earthworm reproduction test with only one concentration tested, estimation errors could have led to incorrect conclusions about the effect direction in a non negligible percentage of cases, suggesting a beneficial effect. These results raise concerns about the robustness of underpowered studies with limited replicates and tested doses for environmental risk assessment, emphasizing the value of adequately sized experiments to improve the reliability of conclusions.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Can we ignore individual differences? Bias, type M and type S errors in OECD guidelines using a simulation study</span>"
    ]
  },
  {
    "objectID": "quarto/F_SuppInfo.html",
    "href": "quarto/F_SuppInfo.html",
    "title": "7  Supplementary information",
    "section": "",
    "text": "7.1 Choice of the model",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Supplementary information</span>"
    ]
  },
  {
    "objectID": "quarto/F_SuppInfo.html#choice-of-the-model",
    "href": "quarto/F_SuppInfo.html#choice-of-the-model",
    "title": "7  Supplementary information",
    "section": "",
    "text": "7.1.1 Linearisation of growth\nWe tested 2 different types of linearisation of growth :\n\nThe original model with \\(L=W^{1/3}\\)\nA model where \\(L=\\text{Ln}(W)\\)\n\n\n\nCode\ndf_growth_Ln &lt;- df_growth |&gt; \n  mutate(L=log(w))\n\n\n\n\nCode\nbf.mod.VI &lt;-\n  bf(\n    L  ~ L0+a*t,\n    L0 ~ 1 + (1||ID),\n    a  ~ 0 + exposition+(0+exposition||ID),\n\n    center=T,\n    nl=T\n  )\n\nbf.mod.Ln &lt;-\n  bf(\n    L  ~ L0+a*t,\n    L0 ~ 1 + (1||ID),\n    a  ~ 0 + exposition+(0+exposition||ID),\n\n    center=T,\n    nl=T\n  )\n\n\nWe use the same priors as in #sec-Dpriors.\n\n\nCode\n# Priors definition\npriors &lt;-\n1  prior(normal(2.32, 2.32*0.2), class = b, nlpar = L0, lb = 0) +\n2  prior(normal(2.32*0.2, 2.32*0.2), class = sd, nlpar = L0)+\n\n3  prior(normal(0.070, 0.070*0.2), class=b, coef=exposition0, nlpar = a) +\n4  prior(normal(0.070,  0.070*0.2), class=b, coef=exposition1, nlpar = a) +\n\n5  prior(normal(0.070*0.2,  0.070), class=sd,\n        coef=exposition0, group=ID, nlpar = a)+\n6  prior(normal(0.070*0.2,  0.070), class=sd,\n        coef=exposition1, group=ID, nlpar = a)+\n\n7  prior(exponential(1), sigma, nlpar=\"\")\n\n\n\n1\n\nPrior on \\(L0_{\\mu}\\)\n\n2\n\nPrior on \\(L0_{\\sigma}\\)\n\n3\n\nPrior on \\(a_{\\text{ctrl},\\mu}\\)\n\n4\n\nPrior on \\(a_{\\text{trt},\\mu}\\)\n\n5\n\nPrior on \\(a_{\\text{ctrl},\\sigma}\\)\n\n6\n\nPrior on \\(a_{\\text{trt},\\sigma}\\)\n\n7\n\nPrior on residuals\n\n\n\n\n\n\nCode\nm.post &lt;- \n  \n  brm(\n    data = df_growth,\n    bf.mod.VI,\n    backend = \"cmdstanr\",\n    prior = priors,\n    save_pars = save_pars(all = TRUE),\n    sample_prior = \"yes\",\n    seed = 42,\n    chains = 4, cores = 4,\n    iter = 6000, warmup = 1000,\n    control = list(adapt_delta = .95,\n    max_treedepth = 12),\n    file=here::here(\"mod/m_brms_VI_post\")\n  )\n\nm.Ln.post &lt;- \n  \n  brm(\n    data = df_growth_Ln,\n    bf.mod.Ln,\n    backend = \"cmdstanr\",\n    prior = priors,\n    save_pars = save_pars(all = TRUE),\n    sample_prior = \"yes\",\n    seed = 42,\n    chains = 4, cores = 4,\n    iter = 6000, warmup = 1000,\n    control = list(adapt_delta = .95,\n    max_treedepth = 12),\n    file=here::here(\"mod/m_brms_Ln_post\")\n  )\n\n\n\n\nCode\np1 &lt;- pp_check(m.post, ndraws = 100) +\n  scale_color_manual(values = c(Nord_polar[1], Nord_frost[3]))\np2 &lt;- pp_check(m.Ln.post, ndraws = 100)+\n  scale_color_manual(values = c(Nord_polar[1], Nord_frost[3]))\np &lt;- p1+p2+\n  plot_layout(ncol = 2) & \n  theme_minimal()\n\np\n\n\n\n\n\n\n\n\nFigure 7.1: Posterior predictive checks of both models (1 = left ; 2 = right). This figure helps comparing observed data to simulated data from the posterior predictive distribution.\n\n\n\n\n\nThe fit from both models are similar so the first model was kept.\n\n\n7.1.2 Test of different model parametrization\nDifferent models were tested to chose the appropriate model. We tested the inclusion of individual variation and of a correlation between \\(L0\\) and \\(a\\).\n\n\nCode\n# Null model\nbf.mod.null &lt;- bf(\n  L ~ L0+a*t,\n  L0~1,\n  a~1,\n  \n  center=T,\n  nl=T\n  )\n\n# Individual variation in growth rate only\nbf.mod.vi &lt;- bf(\n  L ~ L0+a*t,\n  L0~1+(1||ID),\n  a~1+(1||ID),\n  \n  center=T,\n  nl=T\n  )\n\n# Effect of the pesticide on mean growth rate, no individual variation\nbf.mod.trt &lt;- bf(\n  L ~ L0+a*t,\n  L0~1,\n  a~0+exposition,\n  \n  center=T,\n  nl=T\n  )\n\n# Addition of inter-individual variation in growth rate, depending on exposition\n# bf.mod (Defined above)\n\n# Addition of a correlation between initial length and growth rate\nbf.mod.trt.vi.cor &lt;- bf(\n  L ~ L0+a*t,\n  L0~1+(1|c|ID),\n  a~0+exposition+(0+exposition|c|ID),\n\n  center=T,\n  nl=T\n  )\n\n\nWe use the same priors for all models.\n\n\nCode\npriors.null &lt;- prior(normal(2.32, 2.32*0.2), class = b, nlpar = L0, lb = 0) +\n  # Mean values of a \n  prior(normal(0.070, 0.070*0.2), class=b, nlpar = a) +\n  # Résidus\n  prior(exponential(1), sigma)\n\npriors.vi &lt;- prior(normal(2.32, 2.32*0.2), class = b, nlpar = L0, lb = 0) + \n  prior(normal(2.32*0.2, 2.32*0.2), class = sd, nlpar = L0)+\n  # Mean values of a for the two cohorts\n  prior(normal(0.070, 0.070*0.2), class=b, nlpar = a) + \n  # Individual variations values of a for the two cohorts\n  prior(normal(0.070*0.2, 0.070), class=sd, group=ID, nlpar = a)+\n  # Résidus\n  prior(exponential(1), sigma)\n\npriors.trt &lt;- prior(normal(2.32, 2.32*0.2), class = b, nlpar = L0, lb = 0) +\n  # Mean values of a for the two cohorts\n  prior(normal(0.070, 0.070*0.2), class=b, coef=exposition0, nlpar = a) + \n  prior(normal(0.070, 0.070*0.2), class=b, coef=exposition1, nlpar = a) + \n  # Résidus\n  prior(exponential(1), sigma)\n\npriors.trt.vi.cor &lt;- prior(normal(2.32, 2.32*0.2), class = b, nlpar = L0, lb = 0) + \n  prior(normal(2.32*0.2, 2.32*0.2), class = sd, nlpar = L0)+\n  # Mean values of a for the two cohorts\n  prior(normal(0.070, 0.070*0.2), class=b, coef=exposition0, nlpar = a) + \n  prior(normal(0.070, 0.070*0.2), class=b, coef=exposition1, nlpar = a) + \n  # Individual variations values of a for the two cohorts\n  prior(normal(0.070*0.2, 0.070), class=sd, \n        coef=exposition0, group=ID, nlpar = a)+\n  prior(normal(0.070*0.2, 0.070), class=sd, \n        coef=exposition1, group=ID, nlpar = a)+\n  # Default prior for correlations\n  # Résidus\n  prior(exponential(1), sigma)\n\n\n\n\nCode\nm.null &lt;- brm(\n  data = df_growth, \n  bf.mod.null, \n  backend = \"cmdstanr\",\n  prior = priors.null,\n  save_pars = save_pars(all = TRUE),\n  sample_prior = \"yes\",\n  seed = 42,\n  chains = 4, cores = 4,\n  iter = 6000, warmup = 1000,\n  control = list(\n    adapt_delta = .95,\n    max_treedepth = 12\n    ),\n  file=here::here(\"mod/model_choice/m.null\")\n  )\n\nm.vi &lt;- brm(\n  data = df_growth, \n  bf.mod.vi, \n  backend = \"cmdstanr\",\n  prior = priors.vi,\n  save_pars = save_pars(all = TRUE),\n  sample_prior = \"yes\",\n  seed = 42,\n  chains = 4, cores = 4,\n  iter = 6000, warmup = 1000,\n  control = list(\n    adapt_delta = .95,\n    max_treedepth = 12\n    ),\n  file=here::here(\"mod/model_choice/m.vi\")\n  )\n\nm.trt &lt;- brm(\n  data = df_growth, \n  bf.mod.trt, \n  backend = \"cmdstanr\",\n  prior = priors.trt,\n  save_pars = save_pars(all = TRUE),\n  sample_prior = \"yes\",\n  seed = 42,\n  chains = 4, cores = 4,\n  iter = 6000, warmup = 1000,\n  control = list(\n    adapt_delta = .95,\n    max_treedepth = 12\n    ),\n  file=here::here(\"mod/model_choice/m.trt\")\n  )\n\nm.trt.vi &lt;- m.post\n\nm.trt.vi.cor &lt;- brm(\n  data = df_growth, \n  bf.mod.trt.vi.cor, \n  backend = \"cmdstanr\",\n  prior = priors.trt.vi.cor,\n  save_pars = save_pars(all = TRUE),\n  sample_prior = \"yes\",\n  seed = 42,\n  chains = 4, cores = 4,\n  iter = 6000, warmup = 1000,\n  control = list(\n    adapt_delta = .95,\n    max_treedepth = 12\n    ),\n  file=here::here(\"mod/model_choice/m.trt.vi.cor\")\n  )\n\n\n\n\nCode\nm.null &lt;- add_criterion(m.null, criterion=c(\"waic\", \"loo\"))\nm.vi &lt;- add_criterion(m.vi, criterion=c(\"waic\", \"loo\"))\nm.trt &lt;- add_criterion(m.trt, criterion=c(\"waic\", \"loo\"))\nm.trt.vi &lt;- add_criterion(m.trt.vi, criterion=c(\"waic\", \"loo\"))\nm.trt.vi.cor &lt;- add_criterion(m.trt.vi.cor, criterion=c(\"waic\", \"loo\"))\n\n\n\nWAIC comparisonLOO comparison\n\n\n\n\nCode\nw &lt;- loo_compare(m.null, m.vi, m.trt, m.trt.vi, m.trt.vi.cor, criterion = \"waic\")\n\n#print(w, simplify = F)\ncbind(waic_diff = w[, 1] * -2,\n      se        = w[, 2] * 2)\n\n\n              waic_diff        se\nm.trt.vi       0.000000  0.000000\nm.trt.vi.cor   4.179845  3.111794\nm.vi          11.968774  7.152235\nm.null       383.827691 53.483709\nm.trt        385.183295 52.255280\n\n\nCode\nplot &lt;- w[, 7:8] %&gt;% \n  data.frame() %&gt;% \n  rownames_to_column(\"model_name\") %&gt;% \n  ggplot(\n    aes(\n      x = waic, \n      y = model_name, \n      xmin = waic - se_waic, \n      xmax = waic + se_waic)\n    ) +\n  geom_pointrange(\n    color = pal_col[2], \n    fill = pal_col[2], \n    shape = 21, \n    alpha=0.7\n    ) +\n  labs(\n    title = \"WAIC comparison\",\n    x = NULL, \n    y = NULL\n    ) +\n  theme_bw()+\n  theme(axis.ticks.y = element_blank())\n\n\nplot\n\n\n\n\n\n\n\n\nFigure 7.2: WAIC comparison plot of all tested models.\n\n\n\n\n\n\n\n\n\nCode\nw &lt;- loo_compare(m.null, m.vi, m.trt, m.trt.vi, m.trt.vi.cor, criterion = \"loo\")\n\n\n#print(w, simplify = F)\ncbind(waic_diff = w[, 1] * -2,\n      se        = w[, 2] * 2)\n\n\n              waic_diff        se\nm.trt.vi       0.000000  0.000000\nm.trt.vi.cor   2.976959  3.232903\nm.vi          16.340694  7.865486\nm.null       362.231241 53.582916\nm.trt        363.525367 52.340189\n\n\nCode\nplot &lt;- w[, 7:8] %&gt;% \n  data.frame() %&gt;% \n  rownames_to_column(\"model_name\") %&gt;% \n  ggplot(\n    aes(\n      x = looic, \n      y = model_name,\n      xmin = looic - se_looic, \n      xmax = looic + se_looic\n      )\n    ) +\n  geom_pointrange(\n    color = pal_col[2], \n    fill = pal_col[2], \n    shape = 21\n    ) +\n  labs(\n    title = \"L00 comparison\",\n    x = NULL, \n    y = NULL\n    ) +\n  theme_bw()+\n  theme(axis.ticks.y = element_blank())\n\nplot\n\n\n\n\n\n\n\n\nFigure 7.3: LOO comparison plot of all tested models.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Supplementary information</span>"
    ]
  },
  {
    "objectID": "quarto/F_SuppInfo.html#sec-Fpriorsens",
    "href": "quarto/F_SuppInfo.html#sec-Fpriorsens",
    "title": "7  Supplementary information",
    "section": "7.2 Checking priors sensitivity",
    "text": "7.2 Checking priors sensitivity\nThe following table show the standard deviation of the prior distribution, the standard deviation of the likelihood distribution and a diagnosis on whether there is a conflict between the prior and data.\n\n\nCode\n1tbl_powerscale_sens &lt;- powerscale_sensitivity(\n  m.trt.vi,\n  variable = c(\n    \"b_a_exposition0\",\n    \"b_a_exposition1\",\n    \"sd_ID__a_exposition0\",\n    \"sd_ID__a_exposition1\"\n    )\n  )\n\n\ntbl_powerscale_sens |&gt; \n  DT::datatable(\n    options = list(dom = 't'), \n    class=\"hover\", \n    rownames=FALSE\n    )\n\n\n\n1\n\nThis function evaluates the sensitivity of a prior distribution using power-scaling, a method that modifies the prior distribution by raising it to a power \\(\\gamma\\). The goal is to assess how robust posterior inferences are to different prior strengths.\n\n\n\n\n\n\n\n\nThere seems to be a conflict on the prior and the data for the growth rate individual variation in the exposed group however, the next plots confirm the sensitivity of the model to the priors is very low.\n\nPlot densplot ecdfPlot quantities\n\n\n\n\nCode\n# A very heavy object (4.5 GB)\n\n# p_dens &lt;- powerscale_plot_dens(\n#   m.trt.vi,\n#   variable = c(\n#     \"b_a_exposition0\",\n#     \"b_a_exposition1\",\n#     \"sd_ID__a_exposition0\",\n#     \"sd_ID__a_exposition1\"\n#     )\n#   )+\n#   theme_minimal()\n# \n# ggsave(\n#   filename=\"Plot_priors_sensitivity_2.png\",\n#   plot=p_dens,\n#   width=10, height = 6,\n#   path=here::here(\"fig/\")\n#   )\n\n1knitr::include_graphics(here::here(\"fig/Plot_priors_sensitivity_2.png\"))\n\n\n\n1\n\nPlots the density of the prior and power-scaled priors for different values of \\(\\gamma\\). This helps visualize how power scaling changes the shape of the prior.\n\n\n\n\n\n\n\nPriors sensitivity.\n\n\n\n\n\n\n\n\nCode\n# Another very heavy object\n\n# p_ecdf &lt;- powerscale_plot_ecdf(\n#   m.trt.vi,\n#   variable = c(\n#     \"b_a_exposition0\",\n#     \"b_a_exposition1\",\n#     \"sd_ID__a_exposition0\",\n#     \"sd_ID__a_exposition1\"\n#     )\n#   )+\n#   theme_minimal()\n# \n# ggsave(\n#   filename=\"Plot_priors_sensitivity_1.png\",\n#   plot=p_ecdf,\n#   width=10, height = 6,\n#   path=here::here(\"fig/\")\n#   )\n\n1knitr::include_graphics(here::here(\"fig/Plot_priors_sensitivity_1.png\"))\n\n\n\n1\n\nPlots the empirical cumulative distribution function (ECDF) of the prior and power-scaled priors, making it easier to compare the distributions.\n\n\n\n\n\n\n\nPriors sensitivity.\n\n\n\n\n\n\n\n\nCode\n# Another very heavy object\n\n# p_quant &lt;- powerscale_plot_quantities(\n#   m.trt.vi,\n#   variable = c(\n#     \"b_a_exposition0\",\n#     \"b_a_exposition1\",\n#     \"sd_ID__a_exposition0\",\n#     \"sd_ID__a_exposition1\"\n#     ),\n#   mcse = TRUE\n#   )+\n#   theme_minimal()\n# \n# ggsave(\n#   filename=\"Plot_priors_sensitivity_3.png\",\n#   plot=p_quant,\n#   width=10, height = 6,\n#   path=here::here(\"fig/\")\n#   )\n\n1knitr::include_graphics(here::here(\"fig/Plot_priors_sensitivity_3.png\"))\n\n\n\n1\n\nPlots posterior summary statistics (e.g., mean, median, credible intervals) as a function of \\(\\gamma\\). This helps assess how sensitive posterior estimates are to the prior.\n\n\n\n\n\n\n\nPriors sensitivity.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Supplementary information</span>"
    ]
  },
  {
    "objectID": "quarto/F_SuppInfo.html#comparison-with-a-frequentist-approach",
    "href": "quarto/F_SuppInfo.html#comparison-with-a-frequentist-approach",
    "title": "7  Supplementary information",
    "section": "7.3 Comparison with a frequentist approach",
    "text": "7.3 Comparison with a frequentist approach\n\n7.3.1 Frequentist LMMs using glmmTMB\n\n\nCode\n# Model with no effect between cohorts\nglmmTMB.null = glmmTMB(\n  L ~ t , \n  df_growth\n  )\n# Model with the effect of the pesticide only\nglmmTMB.trt &lt;-  glmmTMB(\n  L ~ exposition * t, \n  df_growth\n  )\n# Model with only inter-individual variation\nglmmTMB.vi &lt;-  glmmTMB(\n  L ~  t + (t|ID), \n  df_growth\n  )\n# Model with the effect of the pesticide and inter-individual variation not depending on exposition\nglmmTMB.trt.vi &lt;-  glmmTMB(\n  L ~  exposition * t + (t|ID), \n  df_growth\n  )\n# Model with the effect of the pesticide and inter-individual variation depending on exposition\nglmmTMB.trt.vi.2 &lt;-  glmmTMB(\n  L ~ exposition * t + (exposition * t || ID), \n  df_growth\n  )\n\n\n\nNull modelEffect of pesticides onlyIndividual variation onlyEffect of pesticides and individual variation (not depending on exposition)Effect of pesticides and individual variation (depending on exposition)\n\n\n\nModel summaryAssumption checkEstimates plot\n\n\n\n\nCode\nmodelsummary(glmmTMB.null)\n\n\n\n\n    \n\n    \n    \n      Model summary\n        \n        \n              \n                 \n                (1)\n              \n        \n        \n        \n                \n                  (Intercept)\n                  0.690  \n                \n                \n                             \n                  2.155  \n                \n                \n                             \n                  (0.073)\n                \n                \n                  t          \n                  0.082  \n                \n                \n                             \n                  (0.002)\n                \n                \n                  Num.Obs.   \n                  264    \n                \n                \n                  R2         \n                  0.846  \n                \n                \n                  R2 Adj.    \n                  0.845  \n                \n                \n                  AIC        \n                  559.4  \n                \n                \n                  BIC        \n                  570.1  \n                \n                \n                  RMSE       \n                  0.69   \n                \n        \n      \n    \n\n\n\n\n\n\n\nCode\ncheck_model(glmmTMB.null)\n\n\n\n\n\nCheck assumptions\n\n\n\n\n\n\n\n\nCode\nmodelplot(glmmTMB.null, color = pal_col[1])\n\n\n\n\n\nEstimates of the model\n\n\n\n\n\n\n\n\n\n\nModel summaryAssumption checkEstimates plot\n\n\n\n\nCode\nmodelsummary(glmmTMB.trt)\n\n\n\n\n    \n\n    \n    \n      Model summary\n        \n        \n              \n                 \n                (1)\n              \n        \n        \n        \n                \n                  (Intercept)    \n                  0.689  \n                \n                \n                                 \n                  2.121  \n                \n                \n                                 \n                  (0.103)\n                \n                \n                  exposition1    \n                  0.069  \n                \n                \n                                 \n                  (0.146)\n                \n                \n                  t              \n                  0.084  \n                \n                \n                                 \n                  (0.003)\n                \n                \n                  exposition1 × t\n                  -0.004 \n                \n                \n                                 \n                  (0.004)\n                \n                \n                  Num.Obs.       \n                  264    \n                \n                \n                  R2             \n                  0.847  \n                \n                \n                  R2 Adj.        \n                  0.844  \n                \n                \n                  AIC            \n                  562.3  \n                \n                \n                  BIC            \n                  580.1  \n                \n                \n                  RMSE           \n                  0.69   \n                \n        \n      \n    \n\n\n\n\n\n\n\nCode\ncheck_model(glmmTMB.trt)\n\n\n\n\n\nCheck assumptions\n\n\n\n\n\n\n\n\nCode\nmodelplot(glmmTMB.trt, color = pal_col[1])\n\n\n\n\n\nEstimates of the model\n\n\n\n\n\n\n\n\n\n\nModel summaryAssumption checkEstimates plot\n\n\n\n\nCode\nmodelsummary(glmmTMB.vi)\n\n\n\n\n    \n\n    \n    \n      Model summary\n        \n        \n              \n                 \n                (1)\n              \n        \n        \n        \n                \n                  (Intercept)         \n                  2.169  \n                \n                \n                                      \n                  (0.040)\n                \n                \n                  t                   \n                  0.080  \n                \n                \n                                      \n                  (0.003)\n                \n                \n                  SD (Intercept ID)   \n                  0.184  \n                \n                \n                  SD (t ID)           \n                  0.018  \n                \n                \n                  Cor (Intercept~t ID)\n                  0.523  \n                \n                \n                  SD (Observations)   \n                  0.295  \n                \n                \n                  Num.Obs.            \n                  264    \n                \n                \n                  R2 Marg.            \n                  0.813  \n                \n                \n                  R2 Cond.            \n                  0.972  \n                \n                \n                  AIC                 \n                  311.0  \n                \n                \n                  BIC                 \n                  332.5  \n                \n                \n                  ICC                 \n                  0.8    \n                \n                \n                  RMSE                \n                  0.26   \n                \n        \n      \n    \n\n\n\n\n\n\n\nCode\ncheck_model(glmmTMB.vi)\n\n\n\n\n\nCheck assumptions\n\n\n\n\n\n\n\n\nCode\nmodelplot(glmmTMB.vi, color = pal_col[1])\n\n\n\n\n\nEstimates of the model\n\n\n\n\n\n\n\n\n\n\nModel summaryAssumption checkEstimates plot\n\n\n\n\nCode\nmodelsummary(glmmTMB.trt.vi)\n\n\n\n\n    \n\n    \n    \n      Model summary\n        \n        \n              \n                 \n                (1)\n              \n        \n        \n        \n                \n                  (Intercept)         \n                  2.121  \n                \n                \n                                      \n                  (0.055)\n                \n                \n                  exposition1         \n                  0.097  \n                \n                \n                                      \n                  (0.079)\n                \n                \n                  t                   \n                  0.084  \n                \n                \n                                      \n                  (0.004)\n                \n                \n                  exposition1 × t     \n                  -0.008 \n                \n                \n                                      \n                  (0.005)\n                \n                \n                  SD (Intercept ID)   \n                  0.176  \n                \n                \n                  SD (t ID)           \n                  0.017  \n                \n                \n                  Cor (Intercept~t ID)\n                  0.612  \n                \n                \n                  SD (Observations)   \n                  0.295  \n                \n                \n                  Num.Obs.            \n                  264    \n                \n                \n                  R2 Marg.            \n                  0.814  \n                \n                \n                  R2 Cond.            \n                  0.972  \n                \n                \n                  AIC                 \n                  310.7  \n                \n                \n                  BIC                 \n                  339.3  \n                \n                \n                  ICC                 \n                  0.8    \n                \n                \n                  RMSE                \n                  0.26   \n                \n        \n      \n    \n\n\n\n\n\n\n\nCode\ncheck_model(glmmTMB.trt.vi)\n\n\n\n\n\nCheck assumptions\n\n\n\n\n\n\n\n\nCode\nmodelplot(glmmTMB.trt.vi, color = pal_col[1])\n\n\n\n\n\nEstimates of the model\n\n\n\n\n\n\n\n\n\n\nModel summaryAssumption checkEstimates plot\n\n\n\n\nCode\nmodelsummary(glmmTMB.trt.vi.2)\n\n\n\n\n    \n\n    \n    \n      Model summary\n        \n        \n              \n                 \n                (1)\n              \n        \n        \n        \n                \n                  (Intercept)                      \n                  2.121  \n                \n                \n                                                   \n                  (0.053)\n                \n                \n                  exposition1                      \n                  0.105  \n                \n                \n                                                   \n                  (0.084)\n                \n                \n                  t                                \n                  0.084  \n                \n                \n                                                   \n                  (0.002)\n                \n                \n                  exposition1 × t                  \n                  -0.009 \n                \n                \n                                                   \n                  (0.006)\n                \n                \n                  SD (Intercept ID)                \n                  0.163  \n                \n                \n                  SD (exposition1 ID)              \n                  0.192  \n                \n                \n                  SD (t ID)                        \n                  0.009  \n                \n                \n                  SD (exposition1 × t)             \n                  0.025  \n                \n                \n                  Cor (Intercept~exposition1 ID)   \n                  0.000  \n                \n                \n                  Cor (Intercept~t ID)             \n                  0.000  \n                \n                \n                  Cor (Intercept~exposition1 × t)  \n                  0.000  \n                \n                \n                  Cor (exposition1~t ID)           \n                  0.000  \n                \n                \n                  Cor (exposition1~exposition1 × t)\n                  0.000  \n                \n                \n                  Cor (t~exposition1 × t)          \n                  0.000  \n                \n                \n                  SD (Observations)                \n                  0.284  \n                \n                \n                  Num.Obs.                         \n                  264    \n                \n                \n                  R2 Marg.                         \n                  0.812  \n                \n                \n                  R2 Cond.                         \n                  0.974  \n                \n                \n                  AIC                              \n                  292.8  \n                \n                \n                  BIC                              \n                  324.9  \n                \n                \n                  ICC                              \n                  0.9    \n                \n                \n                  RMSE                             \n                  0.24   \n                \n        \n      \n    \n\n\n\n\n\n\n\nCode\ncheck_model(glmmTMB.trt.vi.2)\n\n\n\n\n\nCheck assumptions\n\n\n\n\n\n\n\n\nCode\nmodelplot(glmmTMB.trt.vi.2, color = pal_col[1])\n\n\n\n\n\nEstimates of the model\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# AIC model comparison\ncompare_performance(\n  glmmTMB.null, glmmTMB.trt, glmmTMB.vi, glmmTMB.trt.vi, glmmTMB.trt.vi.2,\n  rank = TRUE, \n  verbose = FALSE\n  )\n\n\n# Comparison of Model Performance Indices\n\nName             |   Model |  RMSE | Sigma | AIC weights | AICc weights | BIC weights | Performance-Score\n---------------------------------------------------------------------------------------------------------\nglmmTMB.trt.vi.2 | glmmTMB | 0.242 | 0.284 |       1.000 |        1.000 |       0.977 |           100.00%\nglmmTMB.vi       | glmmTMB | 0.256 | 0.295 |    1.08e-04 |     1.30e-04 |       0.022 |            39.27%\nglmmTMB.trt.vi   | glmmTMB | 0.257 | 0.295 |    1.27e-04 |     1.36e-04 |    7.41e-04 |            38.81%\nglmmTMB.trt      | glmmTMB | 0.689 | 0.689 |    2.99e-59 |     3.80e-59 |    3.73e-56 |             0.13%\nglmmTMB.null     | glmmTMB | 0.690 | 0.690 |    1.28e-58 |     1.74e-58 |    5.71e-54 |         1.16e-52%\n\n\n\n\nCode\nplot(\n  compare_performance(\n    glmmTMB.null, \n    glmmTMB.trt, \n    glmmTMB.vi, \n    glmmTMB.trt.vi, \n    glmmTMB.trt.vi.2,\n    rank = TRUE, \n    verbose = FALSE\n    )\n  )\n\n\n\n\n\nComparison of the frequentist models\n\n\n\n\n\n\n7.3.2 Frequentist vs. Bayesian coefficients comparison\n\n\nCode\nmodels &lt;- list(\n  \"null.f\" = glmmTMB.null,\n  \"null.b\" = m.null,\n  \"trt.f\" = glmmTMB.trt,\n  \"trt.b\" = m.trt,\n  \"vi.f\" = glmmTMB.vi,\n  \"vi.b\" = m.vi,\n  \"trt.vi.f\" = glmmTMB.trt.vi.2,\n  \"trt.vi.b\" = m.trt.vi\n  )\n\n\n\n\nCode\n# tb_freqbaycomp &lt;- modelsummary(models, statistic = 'conf.int')\n# save(tb_freqbaycomp, file = here::here(\"mod/model_choice/Table_coef_freq_vs_bayes.rds\"))\nload(here::here(\"mod/model_choice/Table_coef_freq_vs_bayes.rds\"))\ntb_freqbaycomp\n\n\n\n\n    \n\n    \n    \n      Comparison of the frequentist vs. Bayesian model coefficients\n        \n        \n              \n                 \n                null.f\n                null.b\n                trt.f\n                trt.b\n                vi.f\n                vi.b\n                trt.vi.f\n                trt.vi.b\n              \n        \n        \n        \n                \n                  (Intercept)                      \n                  0.690         \n                                \n                  0.689          \n                                \n                  2.169          \n                                \n                  2.121          \n                                \n                \n                \n                                                   \n                  0.690         \n                                \n                  2.121          \n                                \n                  2.169          \n                                \n                  2.121          \n                                \n                \n                \n                                                   \n                  2.155         \n                                \n                  0.689          \n                                \n                  2.169          \n                                \n                  2.121          \n                                \n                \n                \n                                                   \n                  2.155         \n                                \n                  2.121          \n                                \n                  2.169          \n                                \n                  2.121          \n                                \n                \n                \n                                                   \n                  [0.634, 0.752]\n                                \n                  [0.632, 0.750] \n                                \n                  [2.090, 2.248] \n                                \n                  [2.018, 2.224] \n                                \n                \n                \n                                                   \n                  [0.634, 0.752]\n                                \n                  [1.920, 2.323] \n                                \n                  [2.090, 2.248] \n                                \n                  [2.018, 2.224] \n                                \n                \n                \n                                                   \n                  [2.012, 2.298]\n                                \n                  [0.632, 0.750] \n                                \n                  [2.090, 2.248] \n                                \n                  [2.018, 2.224] \n                                \n                \n                \n                                                   \n                  [2.012, 2.298]\n                                \n                  [1.920, 2.323] \n                                \n                  [2.090, 2.248] \n                                \n                  [2.018, 2.224] \n                                \n                \n                \n                  t                                \n                  0.082         \n                                \n                  0.084          \n                                \n                  0.080          \n                                \n                  0.084          \n                                \n                \n                \n                                                   \n                  [0.077, 0.086]\n                                \n                  [0.078, 0.089] \n                                \n                  [0.075, 0.085] \n                                \n                  [0.080, 0.088] \n                                \n                \n                \n                  b_L0_Intercept                   \n                                \n                  2.167         \n                                 \n                  2.175         \n                                 \n                  2.173         \n                                 \n                  2.177         \n                \n                \n                                                   \n                                \n                  [2.022, 2.308]\n                                 \n                  [2.032, 2.316]\n                                 \n                  [2.088, 2.256]\n                                 \n                  [2.092, 2.263]\n                \n                \n                  b_a_Intercept                    \n                                \n                  0.081         \n                                 \n                                \n                                 \n                  0.079         \n                                 \n                                \n                \n                \n                                                   \n                                \n                  [0.077, 0.086]\n                                 \n                                \n                                 \n                  [0.073, 0.085]\n                                 \n                                \n                \n                \n                  sigma                            \n                                \n                  0.695         \n                                 \n                  0.694         \n                                 \n                  0.291         \n                                 \n                  0.288         \n                \n                \n                                                   \n                                \n                  [0.639, 0.759]\n                                 \n                  [0.638, 0.759]\n                                 \n                  [0.262, 0.326]\n                                 \n                  [0.259, 0.322]\n                \n                \n                  exposition1                      \n                                \n                                \n                  0.069          \n                                \n                                 \n                                \n                  0.105          \n                                \n                \n                \n                                                   \n                                \n                                \n                  [-0.217, 0.355]\n                                \n                                 \n                                \n                  [-0.059, 0.269]\n                                \n                \n                \n                  exposition1 × t                  \n                                \n                                \n                  -0.004         \n                                \n                                 \n                                \n                  -0.009         \n                                \n                \n                \n                                                   \n                                \n                                \n                  [-0.012, 0.004]\n                                \n                                 \n                                \n                  [-0.020, 0.002]\n                                \n                \n                \n                  b_a_exposition0                  \n                                \n                                \n                                 \n                  0.082         \n                                 \n                                \n                                 \n                  0.083         \n                \n                \n                                                   \n                                \n                                \n                                 \n                  [0.077, 0.087]\n                                 \n                                \n                                 \n                  [0.079, 0.087]\n                \n                \n                  b_a_exposition1                  \n                                \n                                \n                                 \n                  0.080         \n                                 \n                                \n                                 \n                  0.075         \n                \n                \n                                                   \n                                \n                                \n                                 \n                  [0.075, 0.085]\n                                 \n                                \n                                 \n                  [0.063, 0.085]\n                \n                \n                  SD (Intercept ID)                \n                                \n                                \n                                 \n                                \n                  0.184          \n                                \n                  0.163          \n                                \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                  [0.110, 0.307] \n                                \n                  [0.082, 0.323] \n                                \n                \n                \n                  SD (t ID)                        \n                                \n                                \n                                 \n                                \n                  0.018          \n                                \n                  0.009          \n                                \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                  [0.014, 0.022] \n                                \n                  [0.006, 0.013] \n                                \n                \n                \n                  Cor (Intercept~t ID)             \n                                \n                                \n                                 \n                                \n                  0.523          \n                                \n                  0.000          \n                                \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                  [-0.254, 0.830]\n                                \n                                 \n                                \n                \n                \n                  sd_ID__L0_Intercept              \n                                \n                                \n                                 \n                                \n                                 \n                  0.216         \n                                 \n                  0.219         \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                                 \n                  [0.121, 0.311]\n                                 \n                  [0.131, 0.311]\n                \n                \n                  sd_ID__a_Intercept               \n                                \n                                \n                                 \n                                \n                                 \n                  0.020         \n                                 \n                                \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                                 \n                  [0.016, 0.025]\n                                 \n                                \n                \n                \n                  SD (exposition1 ID)              \n                                \n                                \n                                 \n                                \n                                 \n                                \n                  0.192          \n                                \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                                 \n                                \n                  [0.074, 0.496] \n                                \n                \n                \n                  SD (exposition1 × t)             \n                                \n                                \n                                 \n                                \n                                 \n                                \n                  0.025          \n                                \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                                 \n                                \n                  [0.018, 0.036] \n                                \n                \n                \n                  Cor (Intercept~exposition1 ID)   \n                                \n                                \n                                 \n                                \n                                 \n                                \n                  0.000          \n                                \n                \n                \n                  Cor (Intercept~exposition1 × t)  \n                                \n                                \n                                 \n                                \n                                 \n                                \n                  0.000          \n                                \n                \n                \n                  Cor (exposition1~t ID)           \n                                \n                                \n                                 \n                                \n                                 \n                                \n                  0.000          \n                                \n                \n                \n                  Cor (exposition1~exposition1 × t)\n                                \n                                \n                                 \n                                \n                                 \n                                \n                  0.000          \n                                \n                \n                \n                  Cor (t~exposition1 × t)          \n                                \n                                \n                                 \n                                \n                                 \n                                \n                  0.000          \n                                \n                \n                \n                  sd_ID__a_exposition0             \n                                \n                                \n                                 \n                                \n                                 \n                                \n                                 \n                  0.009         \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                                 \n                                \n                                 \n                  [0.006, 0.013]\n                \n                \n                  sd_ID__a_exposition1             \n                                \n                                \n                                 \n                                \n                                 \n                                \n                                 \n                  0.029         \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                                 \n                                \n                                 \n                  [0.021, 0.040]\n                \n                \n                  SD (Observations)                \n                                \n                                \n                                 \n                                \n                  0.295          \n                                \n                  0.284          \n                                \n                \n                \n                                                   \n                                \n                                \n                                 \n                                \n                  [0.264, 0.331] \n                                \n                  [0.255, 0.316] \n                                \n                \n                \n                  Num.Obs.                         \n                  264           \n                  264           \n                  264            \n                  264           \n                  264            \n                  264           \n                  264            \n                  264           \n                \n                \n                  R2                               \n                  0.846         \n                  0.845         \n                  0.847          \n                  0.844         \n                                 \n                  0.973         \n                                 \n                  0.974         \n                \n                \n                  R2 Adj.                          \n                  0.845         \n                  0.849         \n                  0.844          \n                  0.847         \n                                 \n                  0.954         \n                                 \n                  0.957         \n                \n                \n                  R2 Marg.                         \n                                \n                                \n                                 \n                                \n                  0.813          \n                                \n                  0.812          \n                                \n                \n                \n                  R2 Cond.                         \n                                \n                                \n                                 \n                                \n                  0.972          \n                                \n                  0.974          \n                                \n                \n                \n                  AIC                              \n                  559.4         \n                                \n                  562.3          \n                                \n                  311.0          \n                                \n                  292.8          \n                                \n                \n                \n                  BIC                              \n                  570.1         \n                                \n                  580.1          \n                                \n                  332.5          \n                                \n                  324.9          \n                                \n                \n                \n                  ICC                              \n                                \n                                \n                                 \n                                \n                  0.8            \n                                \n                  0.9            \n                                \n                \n                \n                  ELPD                             \n                                \n                  -281.8        \n                                 \n                  -282.5        \n                                 \n                  -108.9        \n                                 \n                  -100.7        \n                \n                \n                  ELPD s.e.                        \n                                \n                  26.5          \n                                 \n                  25.8          \n                                 \n                  11.1          \n                                 \n                  10.6          \n                \n                \n                  LOOIC                            \n                                \n                  563.7         \n                                 \n                  565.0         \n                                 \n                  217.8         \n                                 \n                  201.5         \n                \n                \n                  LOOIC s.e.                       \n                                \n                  53.0          \n                                 \n                  51.5          \n                                 \n                  22.3          \n                                 \n                  21.2          \n                \n                \n                  WAIC                             \n                                \n                  563.7         \n                                 \n                  565.1         \n                                 \n                  191.8         \n                                 \n                  179.9         \n                \n                \n                  RMSE                             \n                  0.69          \n                  0.69          \n                  0.69           \n                  0.69          \n                  0.26           \n                  0.24          \n                  0.24           \n                  0.24          \n                \n        \n      \n    \n\n\n\n\nNull modelsModels with pesticides effectModels with individual variationModels with pesticides effect and individual variation\n\n\n\n\nCode\nmodelplot(models[1:2])+\n  scale_color_manual(values = pal_col)\n\n\n\n\n\nComparison of the null models\n\n\n\n\n\n\n\n\nCode\nmodelplot(models[3:4])+\n  scale_color_manual(values = pal_col)\n\n\n\n\n\nComparison of the models with pesticides effect\n\n\n\n\n\n\n\n\nCode\nmodelplot(models[5:6])+\n  scale_color_manual(values = pal_col)\n\n\n\n\n\nComparison of the models with individual variation\n\n\n\n\n\n\n\n\nCode\nmodelplot(models[7:8])+\n  scale_color_manual(values = pal_col)\n\n\n\n\n\nComparison of the models with pesticides effect and individual variation\n\n\n\n\n\n\n\n\n Session Information \n\n\n\n\n\nCode\nsessionInfo()\n\n\nR version 4.2.2 (2022-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS 14.0\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n [1] parallel  grid      stats4    stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] devtools_2.4.5     usethis_2.2.3      readxl_1.4.3       DT_0.33           \n [5] kableExtra_1.4.0   knitr_1.47         latex2exp_0.9.6    nlstools_2.1-0    \n [9] lsmeans_2.30-0     emmeans_1.10.3     Hmisc_5.1-3        car_3.1-2         \n[13] carData_3.0-5      modelsummary_2.2.0 extrafont_0.19     gridExtra_2.3     \n[17] ggpubr_0.6.0       plotly_4.10.4      ggtext_0.1.2       ggbreak_0.1.2     \n[21] cowplot_1.1.3      patchwork_1.2.0    ggdist_3.3.2       nord_1.0.0        \n[25] RColorBrewer_1.1-3 wesanderson_0.3.7  viridis_0.6.5      viridisLite_0.4.2 \n[29] ggthemes_5.1.0     see_0.8.4.3        report_0.5.8       parameters_0.22.2 \n[33] performance_0.12.0 modelbased_0.8.8   insight_0.20.4     effectsize_0.8.8  \n[37] datawizard_0.11.0  correlation_0.8.5  bayestestR_0.13.2  easystats_0.7.2   \n[41] deSolve_1.40       priorsense_1.0.4   truncnorm_1.0-9    tmvtnorm_1.6      \n[45] gmm_1.8            sandwich_3.1-0     Matrix_1.6-5       mvtnorm_1.2-5     \n[49] fdrtool_1.2.17     tidybayes_3.0.6    ggmcmc_1.5.1.1     glmmTMB_1.1.9     \n[53] rstan_2.32.6       StanHeaders_2.32.9 cmdstanr_0.8.0     brms_2.22.0       \n[57] Rcpp_1.0.12        plan_0.4-5         reshape2_1.4.4     lubridate_1.9.3   \n[61] forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2       \n[65] readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1     \n[69] tidyverse_2.0.0    here_1.0.1        \n\nloaded via a namespace (and not attached):\n  [1] utf8_1.2.4           tidyselect_1.2.1     lme4_1.1-31         \n  [4] htmlwidgets_1.6.4    munsell_0.5.1        codetools_0.2-20    \n  [7] future_1.33.2        miniUI_0.1.1.1       withr_3.0.0         \n [10] Brobdingnag_1.2-9    colorspace_2.1-0     tables_0.9.28       \n [13] rstudioapi_0.16.0    ggsignif_0.6.4       Rttf2pt1_1.3.12     \n [16] listenv_0.9.1        bayesplot_1.11.1     labeling_0.4.3      \n [19] farver_2.1.2         bridgesampling_1.1-2 rprojroot_2.0.4     \n [22] parallelly_1.37.1    coda_0.19-4.1        vctrs_0.6.5         \n [25] generics_0.1.3       TH.data_1.1-2        xfun_0.45           \n [28] timechange_0.3.0     R6_2.5.1             cachem_1.1.0        \n [31] gridGraphics_0.5-1   promises_1.3.0       scales_1.3.0        \n [34] multcomp_1.4-25      nnet_7.3-19          gtable_0.3.5        \n [37] globals_0.16.3       processx_3.8.4       rlang_1.1.4         \n [40] systemfonts_1.1.0    splines_4.2.2        rstatix_0.7.2       \n [43] extrafontdb_1.0      TMB_1.9.11           lazyeval_0.2.2      \n [46] broom_1.0.6          checkmate_2.3.1      inline_0.3.19       \n [49] yaml_2.3.8           abind_1.4-5          crosstalk_1.2.1     \n [52] backports_1.5.0      httpuv_1.6.15        gridtext_0.1.5      \n [55] tensorA_0.36.2.1     tools_4.2.2          ggplotify_0.1.2     \n [58] ellipsis_0.3.2       jquerylib_0.1.4      posterior_1.6.0     \n [61] sessioninfo_1.2.2    plyr_1.8.9           base64enc_0.1-3     \n [64] ps_1.7.6             rpart_4.1.23         urlchecker_1.0.1    \n [67] zoo_1.8-12           cluster_2.1.6        fs_1.6.4            \n [70] magrittr_2.0.3       data.table_1.15.4    matrixStats_1.3.0   \n [73] pkgload_1.4.0        mime_0.12            hms_1.1.3           \n [76] evaluate_0.24.0      arrayhelpers_1.1-0   xtable_1.8-4        \n [79] rstantools_2.4.0     compiler_4.2.2       V8_4.4.2            \n [82] minqa_1.2.7          htmltools_0.5.8.1    later_1.3.2         \n [85] ggfun_0.1.6          mgcv_1.9-1           tzdb_0.4.0          \n [88] Formula_1.2-5        aplot_0.2.3          RcppParallel_5.1.7  \n [91] MASS_7.3-58.1        boot_1.3-30          cli_3.6.3           \n [94] tinytable_0.4.0      pkgconfig_2.0.3      numDeriv_2016.8-1.1 \n [97] foreign_0.8-87       xml2_1.3.6           svUnit_1.0.6        \n[100] svglite_2.1.3        bslib_0.7.0          QuickJSR_1.2.2      \n[103] ggstats_0.6.0        estimability_1.5.1   yulab.utils_0.1.7   \n[106] distributional_0.4.0 digest_0.6.36        cellranger_1.1.0    \n[109] rmarkdown_2.27       htmlTable_2.4.2      curl_5.2.1          \n[112] shiny_1.8.1.1        nloptr_2.0.3         lifecycle_1.0.4     \n[115] nlme_3.1-160         jsonlite_1.8.8       fansi_1.0.6         \n[118] pillar_1.9.0         lattice_0.22-6       loo_2.8.0           \n[121] GGally_2.2.1         fastmap_1.2.0        httr_1.4.7          \n[124] pkgbuild_1.4.4       survival_3.7-0       remotes_2.5.0       \n[127] glue_1.7.0           png_0.1-8            sass_0.4.9          \n[130] profvis_0.3.8        stringi_1.8.4        memoise_2.0.1       \n[133] future.apply_1.11.2",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Supplementary information</span>"
    ]
  },
  {
    "objectID": "quarto/references.html",
    "href": "quarto/references.html",
    "title": "References",
    "section": "",
    "text": "Bart, S. (2018). Impacts comportementaux, démographiques et\nfonctionnels des pesticides sur des annélides oligochètes du sol.\nUniversité Paris-Saclay.\n\n\nBart, S., Amossé, J., Lowe, C. N., Mougin, C., Péry, A. R. R., &\nPelosi, C. (2018). Aporrectodea caliginosa, a relevant earthworm species\nfor a posteriori pesticide risk assessment: Current knowledge and\nrecommendations for culture and experimental design. Environmental\nScience and Pollution Research, 25(34), 33867–33881. https://doi.org/10.1007/s11356-018-2579-9\n\n\nBart, S., Barraud, A., Amossé, J., Péry, A. R. R., & Mougin, C.\n(2019). Effects of two common fungicides on the reproduction of\nAporrectodea caliginosa in natural soil. Ecotoxicology\nand Environmental Safety, 181, 518–524. https://doi.org/10.1016/j.ecoenv.2019.06.049\n\n\nBart, S., Pelosi, C., Nélieu, S., Lamy, I., & Péry, A. R. R. (2020).\nAn energy-based model to analyze growth data of earthworms exposed to\ntwo fungicides. Environmental Science and Pollution Research,\n27(1), 741–750. https://doi.org/10.1007/s11356-019-06985-z\n\n\nBertrand, C., Aviron, S., Pelosi, C., Faburé, J., Le Perchec, S., Mamy,\nL., & Rault, M. (2024). Effects of plant protection products on\necosystem functions provided by terrestrial invertebrates.\nEnvironmental Science and Pollution Research. https://doi.org/10.1007/s11356-024-34534-w\n\n\nChabauty, F., Pot, V., Bourdat-Deschamps, M., Bernet, N., Labat, C.,\n& Benoit, P. (2016). Transport of organic contaminants in subsoil\nhorizons and effects of dissolved organic matter related to organic\nwaste recycling practices. Environmental Science and Pollution\nResearch, 23(7), 6907–6918. https://doi.org/10.1007/s11356-015-5938-9\n\n\nDebecker, S., & Stoks, R. (2019). Pace of life syndrome under\nwarming and pollution: Integrating life history, behavior, and\nphysiology across latitudes. Ecological Monographs,\n89(1), e01332. https://doi.org/10.1002/ecm.1332\n\n\nDes Roches, S., Post, D. M., Turley, N. E., Bailey, J. K., Hendry, A.\nP., Kinnison, M. T., Schweitzer, J. A., & Palkovacs, E. P. (2018).\nThe ecological importance of intraspecific variation. Nature Ecology\n& Evolution, 2(1, 1), 57–64. https://doi.org/10.1038/s41559-017-0402-5\n\n\nDingemanse, N. J., & Dochtermann, N. A. (2013). Quantifying\nindividual variation in behaviour: Mixed‐effect modelling approaches.\nJournal of Animal Ecology, 82(1), 39–54. https://doi.org/10.1111/1365-2656.12013\n\n\nFeller, A., & Gelman, A. (2015). Hierarchical Models\nfor Causal Effects. In R. A. Scott & S. M. Kosslyn\n(Eds.), Emerging Trends in the Social and\nBehavioral Sciences (1st ed., pp. 1–16). Wiley. https://doi.org/10.1002/9781118900772.etrds0160\n\n\nHendry, A. P. (2020). Eco-evolutionary dynamics. Princeton\nUniversity Press.\n\n\nHolmstrup, M., Ostergaard, I. K., Nielsen, A., & Hansen, B. T.\n(1991). The relationship between temperature and cocoon incubation time\nfor some lumbricid earthworm species. Pedobiologia. http://archive.org/details/holmstrup-et-al.-1991\n\n\nJager, T. (2013). All Individuals Are Not Created Equal;\nAccounting for Interindividual Variation in\nFitting Life-History Responses to Toxicants.\nEnvironmental Science & Technology, 47, 1664–1669.\nhttps://doi.org/10.1021/es303870g\n\n\nKeith, A. M., & Robinson, D. A. (2012). Earthworms as\nNatural Capital: Ecosystem Service Providers\nin Agricultural Soils.\n\n\nKillen, S. S., Marras, S., Metcalfe, N. B., McKenzie, D. J., &\nDomenici, P. (2013). Environmental stressors alter relationships between\nphysiology and behaviour. Trends in Ecology & Evolution,\n28(11), 651–658. https://doi.org/10.1016/j.tree.2013.05.005\n\n\nLowe, C. N., & Butt, K. R. (2005). Culture techniques for soil\ndwelling earthworms: A review. Pedobiologia,\n49(5), 401–413. https://doi.org/10.1016/j.pedobi.2005.04.005\n\n\nMcDonald, J., Gaston, L., Elbana, T., Andres, K., & Cranfield, E.\n(2013). Dimoxystrobin sorption and degradation in sandy loam soil:\nImpact of different landscape positions. Soil\nScience, 178, 662–670. https://doi.org/10.1097/SS.0000000000000030\n\n\nNikinmaa, M., & Anttila, K. (2019). Individual variation in aquatic\ntoxicology: Not only unwanted noise. Aquatic\nToxicology, 207, 29–33. https://doi.org/10.1016/j.aquatox.2018.11.021\n\n\nOziolor, E. M., DeSchamphelaere, K., Lyon, D., Nacci, D., & Poynton,\nH. (2020). Evolutionary Toxicology—An Informational\nTool for Chemical Regulation? Environmental\nToxicology and Chemistry, 39(2), 257–268. https://doi.org/10.1002/etc.4611\n\n\nPelosi, C., Joimel, S., & Makowski, D. (2013). Searching for a more\nsensitive earthworm species to be used in pesticide homologation tests –\nA meta-analysis. Chemosphere, 90(3),\n895–900. https://doi.org/10.1016/j.chemosphere.2012.09.034\n\n\nPelosi, C., Thiel, P., Bart, S., Amossé, J., Jean-Jacques, J., Thoisy,\nJ.-C., & Crouzet, O. (2021). The contributions of enchytraeids and\nearthworms to the soil mineralization process in soils with fungicide.\nEcotoxicology, 30(9), 1910–1921. https://doi.org/10.1007/s10646-021-02452-z\n\n\nPolverino, G., Martin, J. M., Bertram, M. G., Soman, V. R., Tan, H.,\nBrand, J. A., Mason, R. T., & Wong, B. B. M. (2021). Psychoactive\npollution suppresses individual differences in fish behaviour.\nProceedings of the Royal Society B: Biological Sciences,\n288(1944), 20202294. https://doi.org/10.1098/rspb.2020.2294\n\n\nRoyauté, R., Buddle, C. M., & Vincent, C. (2015). Under the\ninfluence: Sublethal exposure to an insecticide affects personality\nexpression in a jumping spider. Functional Ecology,\n29(7), 962–970. https://doi.org/10.1111/1365-2435.12413",
    "crumbs": [
      "References"
    ]
  }
]