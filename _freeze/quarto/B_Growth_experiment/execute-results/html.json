{
  "hash": "838c43491081d3bb9f9222ded9dfd58a",
  "result": {
    "engine": "knitr",
    "markdown": "\n\n\n\n\n\n# Longitudinal monitoring of earthworm growth exposed to a fungicide\n\n## Earthworms\n\n### Earthworm model - *Aporrectodea caliginosa*\n\n*Aporrectodea caliginosa* (@fig-cali) was the chosen biological model for it is considered highly representative of agricultural soil [@bart_2018] and is part of the most sensitive agricultural species to pesticides [@pelosi_2013]. It is also a species we are able to cultivate under laboratory conditions (@sec-ewcultivation).\n\n![Adult *A. caliginosa* individual.](../photos/vdt_cali.png){#fig-cali width=\"50%\"}\n\nIts life cycle at 15°C is presented @fig-AcaliLC.\n\n![*Aporrectodea caliginosa* life cycle. Figure taken from @bart_2018](../photos/Acali_lifecycle.png){#fig-AcaliLC}\n\n### Eartworm cultivation {#sec-ewcultivation}\n\nIndividuals used were bred in the laboratory from individuals initially collected from an agricultural field in Estrée-Mons, France (49°52' N, 3°01’ E) in 2019.\n\nIndividuals are bred at 18°C in 1 L vessels in groups of five individuals (@fig-ewculti) using a loamy soil texture called Closeaux soil (based on the texture definition of the Food and Agriculture Organization of the United Nations (FAO)) (@tbl-clx), sampled from a permanent grassland in Versailles (48°48′ N, 2°5′ E) where no pesticides have been applied for more than 25 years. Pesticides found in the soil are summarized in @fig-closeauxPPP. The soil was collected from the top 0-20 cm, air-dried and crushed to pass a 2 mm mesh. Soil culture is kept with a soil water-holding capacity (WHC) of 60-70% and individuals are fed with horse dung frost and defrosted twice before being milled (\\> 1mm) as presented in @lowe_2005.\n\n![Earthworm culture at the EcoSys laboratory in Palaiseau.](../photos/ew_cultivation.jpeg){#fig-ewculti width=\"50%\"}\n\n\n\n\n\n::: {.cell title='Pesticides found in the cultivation soil'}\n\n```{.r .cell-code}\n# Data of measured pesticides concentrations in the Closeaux soil \ndf_PPPclx <- read_excel(\n  here::here(\"data/Data_pesticides_closeaux_soil.xlsx\"), \n  sheet=\"Clx\"\n  ) |>\n  mutate(Conc = round(C_calc, 2))\n\n# Separation per scale\ndf_PPPclx <- df_PPPclx |>                                     # <1>\n  mutate(Molecule = fct_reorder(Molecule, Conc)) |>           # <1>\n  mutate(facet = case_when(Conc <= 10 ~ 1,                    # <1>\n                           Conc <= 100 & Conc > 10 ~ 2,       # <1>\n                           Conc <= 1000 & Conc > 100 ~ 3,     # <1>\n                           Conc <= 10000 & Conc > 1000 ~ 4,   # <1>\n                           Conc <= 100000 & Conc > 10000 ~5)) # <1>\n\ndf_PPPclx_10     <- df_PPPclx |> subset(facet==1)\ndf_PPPclx_100    <- df_PPPclx |> subset(facet==2)\ndf_PPPclx_1000   <- df_PPPclx |> subset(facet==3)\ndf_PPPclx_10000  <- df_PPPclx |> subset(facet==4)\ndf_PPPclx_100000 <- df_PPPclx |> subset(facet==5)\n\nSize_text <- 10\nsize_label <- 2\n\nplot_1 <- ggplot(\n  data=df_PPPclx_10, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x     = \"Pesticides\", \n    y     = \"Soil concentration (ng/kg)\",\n    title = \"Concentration of searched pesticides found in the cultivation soil\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(face=\"bold\", size=14)\n    )\n\n\nplot_2 <- ggplot(\n  data=df_PPPclx_100, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x=\"Pesticides\", \n    y=\"Soil concentration (ng/kg)\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\nplot_3 <- ggplot(\n  data=df_PPPclx_1000, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x=\"Pesticides\", \n    y=\"Soil concentration\\n (ng/kg)\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\nplot_4 <- ggplot(\n  data=df_PPPclx_10000, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x=\"Pesticides\", \n    y=\"Soil concentration\\n (ng/kg)\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nplot_5 <- ggplot(\n  data=df_PPPclx_100000, \n  aes(\n    x=Molecule, \n    y=Conc\n    )\n  )+\n  \n  geom_col(\n    color=col_blue, \n    fill=col_blue, \n    alpha=0.4\n    )+\n  geom_text(\n    aes(\n      label = round(Conc)\n      ), \n    vjust = -0.5, \n    color=col_blue, \n    size=size_label\n    )+\n  \n  labs(\n    x=\"Pesticides\", \n    y=\"Soil concentration\\n (ng/kg)\"\n    )+\n  \n  theme_minimal(Size_text)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n#plot\ngrid.arrange(plot_1, plot_2, plot_3, plot_4, plot_5,\n             ncol=3, \n             layout_matrix = cbind(c(1,1,2,2), \n                                   c(1,1,2,2), \n                                   c(1,1,3,4), \n                                   c(1,1,3,5)))\n```\n\n::: {.cell-output-display}\n![Concentrations of pesticides found in the cultivation soil for our earthworms.](B_Growth_experiment_files/figure-html/fig-closeauxPPP-1.png){#fig-closeauxPPP width=768}\n:::\n:::\n\n\n\n\n\n1.  Division of the pesticides in groups of similar concentration levels.\n\n| Characteristics                 | Value |\n|:--------------------------------|:------|\n| Clay (\\< 2 µm, g/kg)            | 226.0 |\n| Fine silt (2-20 µm, g/kg)       | 174.1 |\n| Coarse silt (20-50 µm, g/kg)    | 298.9 |\n| Fine sand (50-200 µm, g/kg)     | 239.1 |\n| Coarse sand (200-2000 µm, g/kg) | 47.9  |\n| CaCO3 total (g/kg)              | 23.3  |\n| Organic matter (g/kg)           | 32.6  |\n| P2O5 (g/kg)                     | 0.1   |\n| Organic carbon (g/kg)           | 18.9  |\n| Total nitrogen (N) (g/kg)       | 1.5   |\n| C/N                             | 12.7  |\n| pH                              | 7.5   |\n| Total Cu (mg/kg)                | 25.2  |\n\n: Closeaux soil characteristics {#tbl-clx .hover tbl-colwidths=\"\\[50,50\\]\"}\n\nTo get synchronized cohorts of hatchlings, cocoons were collected in the breeding culture by wet sieving the soil through a 1-mm mesh size [@bart_2018], and incubated at 18°C in Petri dishes on wet filter papers [@holmstrup_1991] (@fig-cocoons). Everyday, new hatchlings were collected and stored in soil at 4°C, to slow their development until the start of the experiment.\n\n![Newly hatched juvenile ready to be put in a small cosm of soil.](../photos/cocoons_handling.jpeg){#fig-cocoons width=\"30%\"}\n\n## Growth experiment protocol\n\n### Overview\n\nThe growth experiment was performed based on an adaptation of the protocol of @bart_2020a. We monitored the growth of 60 earthworms, each randomly allocated to exposed or unexposed conditions (30 individuals per treatment) in individual vessels, during a total of 56 days. Earthworms were individually weighted every 14 days (with their gut content).\n\nThe experiment was performed using the LUFA 2.4 soil, a standardized soil from Speyer. This soil was chosen for it is a loamy soil close to agricultural soils, with a pH of 7.5 and an organic carbon percentage of 1.83% (@tbl-lufa). It was maintained at 70% WHC by adding water from the surface. The soil was renewed after 28 days to keep earthworms in fresh soil and therefore in ideal conditions for growth. For the exposed cohort, it meant the pesticides concentrations were renewed after 28 days. We fed individuals every 14 days with 3 g of horse dung mixed to the soil, corresponding to ad libitum conditions. Similarly to our rearing protocol, individuals were kept in a thermoregulated enclosure at 18°C in complete darkness. Earthworms were individually placed in small High Density PolyEthylene vessels (5 cm x 5∅ cm) with 50 g of soil (dry weight).\n\n| **Physicochemical characteristics** |   | **Particle size (mm) distribution according to german DIN (%)** |   | **Particle size (mm) distribution according to german USDA (%)** |   |\n|:---|:--:|:--:|:--:|:--:|:--:|\n| **Organic carbon (% C)** | 1.83 ± 0.17 | \\< 0.002 | 23.5 ± 1.0 | \\< 0.002 | 23.7 ± 1.4 |\n| **Nitrogen (% N)** | 0.23 ± 0.02 | 0.002 - 0.006 | 7.5 ± 0.7 | 0.002 - 0.05 | 42.2 ± 1.4 |\n| **pH value (0.01 M CaCl2)** | 7.5 ± 0.1 | 0.006 - 0.02 | 14.4 ± 1.2 | 0.05 - 2 | 33.1 ± 1.7 |\n| **Cation exchange capacity (meq/100 g)** | 17.4 ± 0.8 | 0.02 - 0.063 | 25.9 ± 1.7 | **Soil type** | loam |\n| **Water holding capacity (g/100 g)** | 47.1 ± 1.9 | 0.063 - 0.2 | 21.5 ± 1.3 |  |  |\n| **Weight per volume (g/1000 mL)** | 1182 ± 38 | 0.2 - 0.63 | 5.9 ± 1.9 |  |  |\n|  |  | 0.63 - 2.0 | 1.3 ± 0.4 |  |  |\n|  |  | **Soil type** | sandy loam (sL) |  |  |\n\n: LUFA 2.4 soil characteristics {#tbl-lufa .hover}\n\nIn the pesticide treatment, we used a mixture of two molecules, , epoxiconazole (EPX) and dimoxystrobin (DMX), which are the main active substances of several pesticides, including the now banned, but largely used in the past, Swing® Gold (BASF Agro SAS, dimoxystrobin 133 g.L-1, epoxiconazole 50 g.L-1), a broad spectrum fungicide for cereal crops. Epoxiconazole is still frequently found in agricultural soils in France because of its persistance [@pelosi_2021]. Pesticide exposure in the exposed cohort was done by adding a diluted solution of DMX and EPX equivalent to 3 RD of Swing® Gold, a dose shown to have sublethal effects on A. caliginosa growth [@bart_2020a]. Swing® Gold recommended dose (RD) is 1.5 L.ha-1. Considering that active substances of pesticides are mainly found in the first ten centimeters of soil [@chabauty_2016; @mcdonald_2013], and that the LUFA 2.4 soil has a density of 1.18, we calculated that the corresponding concentrations of the two molecules should be 165.0 µg of DMX per kg of dry soil and 190.3 µg of EPX per kg of dry soil. The dry soil was spiked with aqueous solutions of the mixture for contamination and to adjust its water holding capacity (WHC) to 70%.\n\n### Detailed processes\n\n#### Preparation of soils and cosms\n\nThe soil is prepared the day prior to the day it is really renewed (D-1 and D27). To do so, we had primary solutions of epoxiconazole and dimoxystrobin in acetonitrile (396.0 mg/L and 384.61 mg/L respectively).\n\nWe used the following procedure to prepare the soils (@fig-prepasmallcosm) :\n\nTo prepare the control soil :\n\n1.  In a large recipient, weight 2 kg of LUFA 2.4 soil previously put in an oven at 80°C for 48h to dry it;\n2.  Prepare a solution of 659 mL of water with 3.5 µL of acetonitrile (to match the amount put in the contaminated soil);\n3.  Add this solution to the soil, do not mix;\n4.  Cover the recipient with an aluminum sheet and put it in a thermoregulated chamber at 18°C.\n\nTo prepare the contaminated soil :\n\n1.  Prepare the secondary solutions of DMX and EPX (diluted 100 times) : The primary solution are taken out of the fridge for at least 30 min so the solutions go back to room temperature. For each molecule, take a 5 mL volumetric flask 3/4 filled with water, add 50 µL of the corresponding primary solution, mix and complete the volumetric flask with water.\n2.  In a large recipient, weight 2 kg of LUFA 2.4 soil previously put in an oven at 80°C for 48h to dry it;\n3.  Put 500 mL of water in a 1l beaker;\n4.  In this beaker, add 257 µL of the secondary solution of DMX and 96 µL of the secondary solution of EPX;\n5.  Homogeneously spray these 500 mL on top of the soil;\n6.  Use 160 mL of water to rince the sprayer and spray it too;\n7.  Cover the recipient with an aluminum sheet and put it in a thermoregulated chamber at 18°C.\n\nAt D0 and D28, individual cosms are prepared with the soil preparations and the addition of horse dung.\n\nTo prepare the cosms :\n\n1.  Weight and humidify horse dung at 70% of its WHC (WHC 100% = 304 mL);\n2.  Add, in each cosm, 9.1 g of this horse dung preparation;\n3.  Mix the prepared soil;\n4.  Add 66.5 g of soil in each cosm;\n5.  Mix the soil with the horse dung;\n6.  Weigth the earthworm. To do so, earthworms are rinced in a cup of water to remove any soil particules and then softely dried on paper towel before being weighted on a precision balance (@fig-weightingew).\n7.  Put the earthworm in its corresponding cosm;\n8.  Weight the overall weight of the cosm and note it on its lid;\n9.  Put the cosms in thermoregulated chambers at 18°C.\n\nEach time, soil samples are kept at 20°C for chemical analysis.\n\n![Preparation of the small cosms.](../photos/prepa_small_cosm.jpeg){#fig-prepasmallcosm width=\"30%\"}\n\n#### Maintenance\n\nEach week, the WHC is adjusted thanks to the overall weight of the cosm noted right after it was prepared. Water is added to the surface of the soil to reach this weight again.\n\nEach 14 days, earthworms are weighted.\n\n![Weighting of a juvenile earthworm.](../photos/weighting_ew.jpeg){#fig-weightingew width=\"40%\"}\n\n## Results of the growth experiment\n\nData from this experiment can be found in this repository : \"data\\\\Data_growth_EPX_DMX.xlsx\"\n\nVariables names :\n\n-   `date` : Date of the measurement\n-   `ID` : Identification number of the earthworm\n-   `birth_date`: Birthday of the earthworm\n-   `t` : Number of days since the start of the exposition\n-   `w` : Fresh weight of the earthworm (mg)\n-   `exposition` :\n    -   \"Ctrl\" : non exposed\n    -   \"Trt\" : exposed\n-   `status` :\n    -   \"J\" : Juvenile\n    -   \"A\" : Adulte\n    -   \"D\" : Dead\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_growth <- read_excel(                                     # <1>\n  here::here(\"data/Data_growth_EPX_DMX.xlsx\"),               # <1>\n  sheet=\"Growth\"                                             # <1>\n  ) |>                                                       # <1>\n  mutate(L=w^(1/3))                                          # <1>\n\ndf_growth$ID <- as.factor(df_growth$ID)\n\ndf_growth_mean <- df_growth |>                               # <2>\n  aggregate(w~t+exposition, mean)                            # <2>\n\ndf_growth_t0 <- df_growth |> subset(t==0)                    # <3>\n```\n:::\n\n\n\n\n\n1.  Raw data importation and calculation of structural lengths\n2.  Creation of a dataset with the mean growth per exposition group\n3.  Initial weights dataset\n\n### Initial state\n\nWe can first take a look at the initial weights of individuals in each cohort (@fig-initweightdistrib).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- ggplot(\n  data=df_growth_t0, \n  aes(\n    x=exposition, \n    y=w, \n    color=exposition, \n    fill=exposition\n    )\n  )+\n  geom_boxplot(alpha=0)+\n  geom_dotplot(\n    binaxis='y', \n    stackdir='center', \n    dotsize=0.7, \n    alpha=0.5\n    )+\n  \n  labs(\n    x=\"\", \n    y=\"Weight (mg)\",\n    title = \"The <span style = 'color:#5E81AC;'>non exposed</span> and <span style = 'color:#f42404;'>exposed</span> cohorts have <br/> similar initial weight distributions\"\n    )+\n  \n  scale_color_manual(\n    name=\"Exposition\",\n    values=pal_col, \n    labels=c(\"Non exposed\", \"Exposed\")\n    )+\n  scale_fill_manual(\n    name=\"Exposition\",\n    values=pal_col, \n    labels=c(\"Non exposed\", \"Exposed\")\n    )+\n  \n  theme_classic(14)+\n  theme(\n    \n    plot.title = element_markdown(face=\"bold\"),\n    title=element_text(size=sizetitle, face=\"bold\"), \n    \n    legend.position = \"none\",\n    legend.title=element_text(size=sizetitle-2,face=\"bold\"),\n    legend.text = element_text(size=sizetitle-2,face=\"plain\"),\n    \n    axis.title.x = element_blank(),\n    axis.text.x = element_blank(),\n    axis.line.x=element_blank(),\n    axis.ticks.x=element_blank(),\n    \n    axis.title.y = element_text(size=sizetitle,face=\"plain\")\n    )\np\n```\n\n::: {.cell-output-display}\n![Initial weight distribution in each group.](B_Growth_experiment_files/figure-html/fig-initweightdistrib-1.png){#fig-initweightdistrib width=576}\n:::\n:::\n\n\n\n\n\nWe can test the normality of the weight distribution in each cohort :\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(subset(df_growth_t0, exposition==\"Ctrl\")$w) #<1>\nshapiro.test(subset(df_growth_t0,exposition==\"Trt\")$w) #<1>\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  subset(df_growth_t0, exposition == \"Ctrl\")$w\nW = 0.93247, p-value = 0.05714\n\n\n\tShapiro-Wilk normality test\n\ndata:  subset(df_growth_t0, exposition == \"Trt\")$w\nW = 0.9873, p-value = 0.9696\n```\n\n\n:::\n:::\n\n\n\n\n\n1.  Normality tests with the shapiro test. If the test isn't sinificant, the dataset is not inconsistent with a Gaussian distribution.\n\nTherefore, these two datasets are not inconsistent with a Gaussian distribution.\n\nWe can test for variance homogeneity :\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(\n  subset(df_growth_t0, exposition==\"Ctrl\")$w, \n  subset(df_growth_t0, exposition==\"Trt\")$w\n  ) # <1>\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  subset(df_growth_t0, exposition == \"Ctrl\")$w and subset(df_growth_t0, exposition == \"Trt\")$w\nF = 1.1901, num df = 29, denom df = 29, p-value = 0.6424\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.5664681 2.5004941\nsample estimates:\nratio of variances \n          1.190147 \n```\n\n\n:::\n:::\n\n\n\n\n\n1.  Variance homogeneity test with a F-test. If the test isn't sinificant, the dataset is not inconsistent with a ratio of variances equal to 1.\n\nThe datasets are not inconsistent with a ratio of variances equal to 1.\n\nThen, we can test if there is an effect of the cohort on the initial weight of individuals with a t-test :\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(df_growth_t0$w~df_growth_t0$exposition, var.equal=T) # <1>\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  df_growth_t0$w by df_growth_t0$exposition\nt = -0.024192, df = 58, p-value = 0.9808\nalternative hypothesis: true difference in means between group Ctrl and group Trt is not equal to 0\n95 percent confidence interval:\n -1.953987  1.907321\nsample estimates:\nmean in group Ctrl  mean in group Trt \n          12.41333           12.43667 \n```\n\n\n:::\n:::\n\n\n\n\n\n1.  T-test : If the test is significant, the dataset is not inconsistent with an effect of the group on the initial weight of individuals.\n\nWe can conclude there is no effect of the cohort on the initial weight of the individuals.\n\n### Growth of individuals\n\n\n\n\n\n::: {#tbl-growth .cell .plain tbl-cap='Summary of the collected growth data.'}\n\n```{.r .cell-code}\n# We go back from the raw data to do a general summary\ndf_growth_ctrl <- subset(df_growth,exposition==\"Ctrl\")\ndf_growth_trt <- subset(df_growth,exposition==\"Trt\")\n\ndf_growth_ctrl_mean <- subset(df_growth_mean,exposition==\"Ctrl\")\ndf_growth_trt_mean <- subset(df_growth_mean,exposition==\"Trt\")\n\nN_Sample <- c(\n  n_distinct(df_growth_ctrl[df_growth_ctrl$t==0,]$ID),\n  n_distinct(df_growth_trt[df_growth_trt$t==0,]$ID)\n  )\n \nN_dead_D56 <- c(\n  n_distinct(subset(df_growth_ctrl, t==56 & status==\"D\")$ID), \n  n_distinct(subset(df_growth_trt, t==56 & status==\"D\")$ID)\n  )\n\nMean_w_init <- c(\n  subset(df_growth_ctrl_mean, t==0)$w, \n  subset(df_growth_trt_mean, t==0)$w\n  )\n\nC95_w_init <- c(\n  quantile(subset(df_growth_ctrl, t==0)$w, c(0.025, 0.975)), \n  quantile(subset(df_growth_trt, t==0)$w, c(0.025, 0.975))\n  )\n\nMean_w_D56 <- c(\n  subset(df_growth_ctrl_mean, t==56)$w, \n  subset(df_growth_trt_mean, t==56)$w\n  )\n\nC95_w_D56 <- c(\n  quantile(subset(df_growth_ctrl, t==56)$w, c(0.025, 0.975), na.rm=TRUE), \n  quantile(subset(df_growth_trt, t==56)$w, c(0.025, 0.975), na.rm=TRUE)\n  )\n\nAbsolute_growth_rates <- cbind(\n  (subset(df_growth_ctrl, t==56)$w-subset(df_growth_ctrl, t==0)$w)/56, \n  (subset(df_growth_trt, t==56)$w-subset(df_growth_trt, t==0)$w)/56\n  )\n\nMean_a <- c(\n  mean(Absolute_growth_rates[,1], na.rm=TRUE), \n  mean(Absolute_growth_rates[,2], na.rm=TRUE)\n  )\n\nC95_a <- c(\n  quantile(Absolute_growth_rates[,1], c(0.025, 0.975), na.rm=TRUE), \n  quantile(Absolute_growth_rates[,2], c(0.025, 0.975), na.rm=TRUE)\n  )\n\n\ndf_summary <- data.frame(\n  Cohort = c(\"Non exposed\", \"Exposed\"),\n  N_sample=N_Sample,\n  N_dead=N_dead_D56,\n  w_init=paste(\n    round(Mean_w_init,1), \n    \" [\",round(C95_w_init[1],1),\n    \" ; \",round(C95_w_init[2],1),\"]\"\n    , sep=\"\"\n   ),\n  Mean_w_D56=paste(\n    round(Mean_w_D56,1),\n    \" [\",round(C95_w_D56[1],1),\n    \" ; \",round(C95_w_D56[2],1),\"]\"\n    , sep=\"\"\n    ),\n  Mean_a=paste(\n    round(Mean_a,1),\n    \" [\",round(C95_a[1],1),\n    \" ; \",round(C95_a[2],1),\"]\"\n    , sep=\"\"\n    )\n  )\n\ncolnames(df_summary) <- c(\n  \"Cohort\", \n  \"Sample size\", \n  \"Number of dead individuals\", \n  \"Initial weight {2.5% ; 97.5%  quantiles} (mg)\", \n  \"Weight after 56 days (mg)\", \n  \"Absolute growth rate (mg/d)\"\n  )\n\ndf_summary <- as.data.frame(t(df_summary)) \nnames(df_summary) <- as.character(df_summary[1,])\ndf_summary <- df_summary[-1,]\n\ndf_summary |> datatable(options = list(dom = 't'), class=\"hover\")%>%\n  formatStyle(columns = colnames(df_summary), textAlign = \"left\") \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-5c048a1ee4603b9c5bce\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5c048a1ee4603b9c5bce\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"Sample size\",\"Number of dead individuals\",\"Initial weight {2.5% ; 97.5%  quantiles} (mg)\",\"Weight after 56 days (mg)\",\"Absolute growth rate (mg/d)\"],[\"30\",\"3\",\"12.4 [6.4 ; 21.2]\",\"360.3 [213.3 ; 495.9]\",\"6.2 [3.6 ; 8.7]\"],[\"30\",\"5\",\"12.4 [6.4 ; 21.2]\",\"343.2 [213.3 ; 495.9]\",\"5.9 [3.6 ; 8.7]\"]],\"container\":\"<table class=\\\"hover\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Non exposed<\\/th>\\n      <th>Exposed<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"dom\":\"t\",\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Non exposed\",\"targets\":1},{\"name\":\"Exposed\",\"targets\":2}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"rowCallback\":\"function(row, data, displayNum, displayIndex, dataIndex) {\\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'text-align':'left'});\\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'text-align':'left'});\\n}\"},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[\"options.rowCallback\"],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Survival curves\ndf_growth <- df_growth |>          # <1>\n  mutate(dead = case_when(                 # <1>\n    status == \"D\" ~ 1,                     # <1>\n    status %in% c(\"J\", \"S\", \"A\") ~ 0)      # <1>\n    )                                      # <1>\n\ndf_surv <- df_growth |>                # <2>\n  arrange(t) |>                            # <2>\n  group_by(t,exposition) |>                # <2>\n  summarise(                               # <2>\n    n = n(),                               # <2>\n    n_dead = sum(dead),                    # <2>\n    n_alive = n - n_dead,                  # <2>\n    survival_prob = cumprod((n_alive/n))   # <2>\n  ) |>                                     # <2>\n  ungroup()                                # <2>\n\n\n# Survival curve plot\np_surv <- ggplot(\n  df_surv, \n  aes(\n    x = t, \n    y = n_alive, \n    color=exposition\n    )\n  ) +\n  \n  geom_step(linewidth = 1.2) +\n  \n  scale_color_manual(values=c(col_blue, col_red), labels = c(\"Non-exposed\", \"Exposed\"))+\n  scale_fill_manual(name = \"Exposition\", values=c(col_blue, col_red))+\n  \n  lims(\n    y=c(0,30), \n    x=c(0,56)\n      ) +\n  \n  labs(\n    #title = \"Survival curves\",\n    x = \"Time (days)\",\n    y = \"Number of alive earthworms\"\n    ) +\n  \n  scale_y_continuous(\n    limits = c(0, 30),  \n    breaks = seq(0, 30, by = 5),  \n    minor_breaks = seq(0, 30, by = 1) \n  ) +\n  \n  scale_x_continuous(\n    limits = c(0, 56),       \n    breaks = seq(0, 56, by = 28),\n    minor_breaks = seq(0, 56, by = 14) \n  ) +\n  \n  theme_minimal(12)+\n  theme(\n    legend.position = \"bottom\", \n    \n    plot.title=element_text(size=sizetitle, face=\"bold\"),\n    \n    axis.title.x = element_text(face=\"plain\"), \n    axis.title.y = element_text(face=\"plain\"),\n    \n    panel.grid.major.y = element_line(color = \"gray70\", size = 0.3),\n    panel.grid.minor.y = element_line(color = \"gray90\", size = 0.2), \n    )\n\np_surv\n```\n\n::: {.cell-output-display}\n![Survival curves for both cohorts.](B_Growth_experiment_files/figure-html/fig-survcurves-1.png){#fig-survcurves width=576}\n:::\n:::\n\n\n\n\n\n1.  Addition of dead status column.\n2.  Calculation of number of alive individual per group throughout time.\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalpha_point <- 0.5\nalpha_line <- 0.3\n\nplot <- ggplot(\n  data=df_growth, \n  aes(\n    x=t, \n    y=w, \n    color=exposition, \n    group=as.factor(ID)\n    )\n  )+\n  \n  facet_wrap(~exposition)+\n  \n  geom_point(alpha=alpha_point, size=2)+\n  geom_line(lwd=0.8, alpha=alpha_line)+\n  \n  scale_color_manual(\n    values = pal_col, \n    label  = c(\"Non exposed\", \"Exposed\"), \n    name   = \"\"\n    )+\n  \n  labs(\n    x=\"Time (days)\", \n    y=\"Weight (mg)\",\n    title = \"Growth monitoring of the first 56 days\",\n    subtitle = \"For the <span style = 'color:#5E81AC;'>non exposed</span> and <span style = 'color:#f42404;'>exposed</span> groups\"\n    )+\n  scale_x_continuous(\n    limits = c(0, 56),        \n    breaks = seq(0, 56, by = 28),        \n    minor_breaks = seq(0, 56, by = 14)\n  ) +\n  ylim(0, max(df_growth$w, na.rm=T))+\n  \n  theme_minimal(12) +\n  theme(\n    legend.position = \"none\",\n    \n    title=element_markdown(face=\"bold\"),\n    plot.subtitle=element_markdown(face=\"plain\"),\n    \n    axis.title=element_text(face=\"plain\"),\n    \n    strip.background = element_blank(),\n    strip.text = element_blank()\n    )\n\nplot\n```\n\n::: {.cell-output-display}\n![Evolution of fresh body weight of non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points and thin lines, each line corresponding to one individual).](B_Growth_experiment_files/figure-html/fig-growthdataset-1.png){#fig-growthdataset width=576}\n:::\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Comparison of the final mean weight in the two groups\n\nvar.test(                                                   # <1>\n  subset(df_growth, exposition==\"Ctrl\" & t==56)$w,          # <1>\n  subset(df_growth, exposition==\"Trt\"& t==56)$w             # <1>\n  )                                                         # <1>\n\nTest <- t.test(                                                     # <2>\n  df_growth$w ~ df_growth$exposition,                               # <2>\n  var.equal=F                                                       # <2>\n  )                                                                 # <2>\n\nTest\nTest_p_val <- round(Test$p.value,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  subset(df_growth, exposition == \"Ctrl\" & t == 56)$w and subset(df_growth, exposition == \"Trt\" & t == 56)$w\nF = 0.40594, num df = 26, denom df = 24, p-value = 0.02697\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.1807097 0.9001427\nsample estimates:\nratio of variances \n         0.4059418 \n\n\n\tWelch Two Sample t-test\n\ndata:  df_growth$w by df_growth$exposition\nt = 0.10208, df = 266.67, p-value = 0.9188\nalternative hypothesis: true difference in means between group Ctrl and group Trt is not equal to 0\n95 percent confidence interval:\n -30.40347  33.72831\nsample estimates:\nmean in group Ctrl  mean in group Trt \n          127.4268           125.7644 \n```\n\n\n:::\n:::\n\n\n\n\n\n1.  Test of the variance homogeneity hypothesis.\n2.  Welsh two sample t-test\n\nThe final mean weights do not differ significatively between the two cohorts (Welsh Two Sample t-test, p-value = 0.92).\n\n<button class=\"accordion-button\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#collapseOne\">\n\n<b> Session Information </b>\n\n</button>\n\n:::: {#collapseOne .accordion-collapse .collapse}\n<div>\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.2.2 (2022-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS 14.0\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n [1] parallel  grid      stats4    stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] devtools_2.4.5     usethis_2.2.3      readxl_1.4.3       DT_0.33           \n [5] kableExtra_1.4.0   knitr_1.47         latex2exp_0.9.6    nlstools_2.1-0    \n [9] lsmeans_2.30-0     emmeans_1.10.3     Hmisc_5.1-3        car_3.1-2         \n[13] carData_3.0-5      modelsummary_2.2.0 extrafont_0.19     gridExtra_2.3     \n[17] ggpubr_0.6.0       plotly_4.10.4      ggtext_0.1.2       ggbreak_0.1.2     \n[21] cowplot_1.1.3      patchwork_1.2.0    ggdist_3.3.2       nord_1.0.0        \n[25] RColorBrewer_1.1-3 wesanderson_0.3.7  viridis_0.6.5      viridisLite_0.4.2 \n[29] ggthemes_5.1.0     see_0.8.4.3        report_0.5.8       parameters_0.22.2 \n[33] performance_0.12.0 modelbased_0.8.8   insight_0.20.4     effectsize_0.8.8  \n[37] datawizard_0.11.0  correlation_0.8.5  bayestestR_0.13.2  easystats_0.7.2   \n[41] deSolve_1.40       priorsense_1.0.4   truncnorm_1.0-9    tmvtnorm_1.6      \n[45] gmm_1.8            sandwich_3.1-0     Matrix_1.6-5       mvtnorm_1.2-5     \n[49] fdrtool_1.2.17     tidybayes_3.0.6    ggmcmc_1.5.1.1     glmmTMB_1.1.9     \n[53] rstan_2.32.6       StanHeaders_2.32.9 cmdstanr_0.8.0     brms_2.22.0       \n[57] Rcpp_1.0.12        plan_0.4-5         reshape2_1.4.4     lubridate_1.9.3   \n[61] forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2       \n[65] readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1     \n[69] tidyverse_2.0.0    here_1.0.1        \n\nloaded via a namespace (and not attached):\n  [1] utf8_1.2.4           tidyselect_1.2.1     lme4_1.1-31         \n  [4] htmlwidgets_1.6.4    munsell_0.5.1        ragg_1.3.2          \n  [7] codetools_0.2-20     miniUI_0.1.1.1       withr_3.0.0         \n [10] Brobdingnag_1.2-9    colorspace_2.1-0     tables_0.9.28       \n [13] rstudioapi_0.16.0    ggsignif_0.6.4       Rttf2pt1_1.3.12     \n [16] bayesplot_1.11.1     labeling_0.4.3       farver_2.1.2        \n [19] bridgesampling_1.1-2 rprojroot_2.0.4      coda_0.19-4.1       \n [22] vctrs_0.6.5          generics_0.1.3       TH.data_1.1-2       \n [25] xfun_0.45            timechange_0.3.0     markdown_1.13       \n [28] R6_2.5.1             cachem_1.1.0         gridGraphics_0.5-1  \n [31] promises_1.3.0       scales_1.3.0         multcomp_1.4-25     \n [34] nnet_7.3-19          gtable_0.3.5         processx_3.8.4      \n [37] rlang_1.1.4          systemfonts_1.1.0    splines_4.2.2       \n [40] rstatix_0.7.2        extrafontdb_1.0      TMB_1.9.11          \n [43] lazyeval_0.2.2       broom_1.0.6          checkmate_2.3.1     \n [46] inline_0.3.19        yaml_2.3.8           abind_1.4-5         \n [49] crosstalk_1.2.1      backports_1.5.0      httpuv_1.6.15       \n [52] gridtext_0.1.5       tensorA_0.36.2.1     tools_4.2.2         \n [55] ggplotify_0.1.2      ellipsis_0.3.2       jquerylib_0.1.4     \n [58] posterior_1.6.0      sessioninfo_1.2.2    plyr_1.8.9          \n [61] base64enc_0.1-3      ps_1.7.6             rpart_4.1.23        \n [64] urlchecker_1.0.1     zoo_1.8-12           cluster_2.1.6       \n [67] fs_1.6.4             magrittr_2.0.3       data.table_1.15.4   \n [70] matrixStats_1.3.0    pkgload_1.4.0        mime_0.12           \n [73] hms_1.1.3            evaluate_0.24.0      arrayhelpers_1.1-0  \n [76] xtable_1.8-4         rstantools_2.4.0     compiler_4.2.2      \n [79] V8_4.4.2             minqa_1.2.7          htmltools_0.5.8.1   \n [82] later_1.3.2          ggfun_0.1.6          mgcv_1.9-1          \n [85] tzdb_0.4.0           Formula_1.2-5        aplot_0.2.3         \n [88] RcppParallel_5.1.7   MASS_7.3-58.1        boot_1.3-30         \n [91] cli_3.6.3            pkgconfig_2.0.3      numDeriv_2016.8-1.1 \n [94] foreign_0.8-87       xml2_1.3.6           svUnit_1.0.6        \n [97] svglite_2.1.3        bslib_0.7.0          QuickJSR_1.2.2      \n[100] ggstats_0.6.0        estimability_1.5.1   yulab.utils_0.1.7   \n[103] distributional_0.4.0 digest_0.6.36        cellranger_1.1.0    \n[106] rmarkdown_2.27       htmlTable_2.4.2      curl_5.2.1          \n[109] commonmark_1.9.1     shiny_1.8.1.1        nloptr_2.0.3        \n[112] lifecycle_1.0.4      nlme_3.1-160         jsonlite_1.8.8      \n[115] fansi_1.0.6          pillar_1.9.0         lattice_0.22-6      \n[118] loo_2.8.0            GGally_2.2.1         fastmap_1.2.0       \n[121] httr_1.4.7           pkgbuild_1.4.4       survival_3.7-0      \n[124] remotes_2.5.0        glue_1.7.0           sass_0.4.9          \n[127] profvis_0.3.8        stringi_1.8.4        textshaping_0.4.0   \n[130] memoise_2.0.1       \n```\n\n\n:::\n:::\n\n\n\n\n\n</div>\n::::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}