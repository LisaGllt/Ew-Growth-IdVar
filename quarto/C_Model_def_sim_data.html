<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; A model for earthworm growth and its individual variation – Reavealing Hidden Sensitivity - Inter-Individual Growth Variation in Earthworms Exposed to a Fungicide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../quarto/D_Growth_modeling.html" rel="next">
<link href="../quarto/B_Growth_experiment.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-a1a99922ddb087a1e1a87053fc057468.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-054d38c073f43d039fb4455aed9f4408.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../quarto/C_Model_def_sim_data.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">A model for earthworm growth and its individual variation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Reavealing Hidden Sensitivity - Inter-Individual Growth Variation in Earthworms Exposed to a Fungicide</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">How to use this repository ?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/A_Context_of_the_study.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Context of the study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/B_Growth_experiment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Longitudinal monitoring of earthworm growth exposed to a fungicide</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/C_Model_def_sim_data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">A model for earthworm growth and its individual variation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/D_Growth_modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analysis of experimental data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/E_Less_replicates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Can we ignore individual differences? Bias, type M and type S errors in OECD guidelines using a simulation study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/F_SuppInfo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Supplementary information</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#model-definition" id="toc-model-definition" class="nav-link active" data-scroll-target="#model-definition"><span class="header-section-number">4.1</span> Model definition</a></li>
  <li><a href="#parameter-recovery-with-simulated-data" id="toc-parameter-recovery-with-simulated-data" class="nav-link" data-scroll-target="#parameter-recovery-with-simulated-data"><span class="header-section-number">4.2</span> Parameter recovery with simulated data</a>
  <ul class="collapse">
  <li><a href="#data-simulation" id="toc-data-simulation" class="nav-link" data-scroll-target="#data-simulation"><span class="header-section-number">4.2.1</span> Data simulation</a></li>
  <li><a href="#model-definition-with-brms" id="toc-model-definition-with-brms" class="nav-link" data-scroll-target="#model-definition-with-brms"><span class="header-section-number">4.2.2</span> Model definition with <code>brms</code></a></li>
  <li><a href="#sec-Cpriorsdef" id="toc-sec-Cpriorsdef" class="nav-link" data-scroll-target="#sec-Cpriorsdef"><span class="header-section-number">4.2.3</span> Priors definitions</a></li>
  <li><a href="#prior-predictive-check" id="toc-prior-predictive-check" class="nav-link" data-scroll-target="#prior-predictive-check"><span class="header-section-number">4.2.4</span> Prior predictive check</a></li>
  <li><a href="#posterior-predictive-check" id="toc-posterior-predictive-check" class="nav-link" data-scroll-target="#posterior-predictive-check"><span class="header-section-number">4.2.5</span> Posterior predictive check</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">A model for earthworm growth and its individual variation</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="model-definition" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="model-definition"><span class="header-section-number">4.1</span> Model definition</h2>
<p>To evaluate individual variations in growth and fungicide sensitivity parameters, a simplified version of the bioenergetic model from <span class="citation" data-cites="bart_2020a">Bart et al. (<a href="references.html#ref-bart_2020a" role="doc-biblioref">2020</a>)</span> was developed.</p>
<p>We used an individual reaction norm approach <span class="citation" data-cites="dingemanse_2013">(<a href="references.html#ref-dingemanse_2013" role="doc-biblioref">Dingemanse &amp; Dochtermann, 2013</a>)</span> to compare growth rate across exposed and non-exposed individuals. As indicated by <span class="citation" data-cites="bart_2020a">(<a href="references.html#ref-bart_2020a" role="doc-biblioref">Bart et al., 2020</a>)</span>, <em>A. caliginosa</em> growth is approximately linear with the structural volumetric length <span class="math inline">\(L\)</span> during the juvenile phase of the life-cycle. This structural volumetric length can be calculated as the cubic root of the wet weight of the organisms.</p>
<p>Here, we assume that both cohorts can have a different growth rate <span class="math inline">\(\alpha\)</span> (mg<span class="math inline">\(^{1/3}\)</span>/d). We suppose the structural volumetric length at the start of the experiment (<span class="math inline">\(L0\)</span>) does not depend on the treatment as individuals came from the same pool of individuals.</p>
<p>To take individual variations for both parameters, we assume that each parameter can be considered as a random variable described by a normal distribution whose mean is the population-level value of the parameter and the standard deviation is the individual variation of the parameter. Each individual can then have a parameter value that is taken from this normal distribution.</p>
<p>This gives us <a href="#eq-growth" class="quarto-xref">Equation&nbsp;<span>4.1</span></a>.</p>
<p><span id="eq-growth"><span class="math display">\[
\begin{aligned}
L_{c,i} &amp;\sim \mathcal{N}(L_{\mu,c,i}, \sigma_L)\\
L_{\mu,c,i}(t)&amp;=L0_i+a_{c,i}\times t \\
\text{With}\\
L0_{i} &amp;\sim \mathcal{N}(L0_{\mu}, L0_{\sigma})\\
a_{c,i} &amp;\sim \mathcal{N}(a_{c,\mu}, a_{c,\sigma})
\end{aligned}
\tag{4.1}\]</span></span></p>
<p>With :</p>
<ul>
<li><span class="math inline">\(i\)</span> : the individual under a certain exposure <span class="math inline">\((i \in [\![1,60]\!]),\)</span></li>
<li><span class="math inline">\(c\)</span> : the exposition concentration (0 or 3 RD),</li>
<li><span class="math inline">\(L_{c,i}(t)\)</span> : the cubic root of the wet body weight of individual i exposed to the concentration <span class="math inline">\(c\)</span> at a given time <span class="math inline">\(t\)</span> (mg<span class="math inline">\(^{1/3}\)</span>),</li>
<li><span class="math inline">\(L_{\mu,c,i}(t)\)</span> : the expected cubic root of the wet body weight of individual <span class="math inline">\(i\)</span> exposed to the concentration <span class="math inline">\(c\)</span> at time <span class="math inline">\(t\)</span>,</li>
<li><span class="math inline">\(\sigma_L\)</span> : standard deviation of residuals on <span class="math inline">\(L_{c,i}\)</span>, representing the variability not captured by the growth model,</li>
<li><span class="math inline">\(L0_i\)</span> : the cubic root of the wet body weight at t=0 (mg<span class="math inline">\(^{1/3}\)</span>),</li>
<li><span class="math inline">\(a_{c,i}\)</span> : the growth rate (mg<span class="math inline">\(^{1/3}\)</span>/d) of the individual <span class="math inline">\(i\)</span> exposed to the concentration <span class="math inline">\(c\)</span>,</li>
<li><span class="math inline">\(L0_{\mu}\)</span> : mean of the normal distribution for the initial wet body weight (<span class="math inline">\(L0_i\)</span>),</li>
<li><span class="math inline">\(L0_{\sigma}\)</span> : standard deviation of the normal distribution for the initial wet body weight (<span class="math inline">\(L0_i\)</span>),</li>
<li><span class="math inline">\(a_{c,\mu}\)</span> : mean of the normal distribution for the growth rate (<span class="math inline">\(a_{c,i}\)</span>),</li>
<li><span class="math inline">\(a_{c,\sigma}\)</span> : standard deviation of the normal distribution for the growth rate (<span class="math inline">\(a_{c,i}\)</span>).</li>
</ul>
<p>Our model is implemented with the <code>brms</code> package which means this mathematical formulation translate to the following formula in the <code>brms</code> language :</p>
<ol type="1">
<li><code>L  ~ L0+a*t</code><br>
</li>
<li><code>L0 ~ 1 + (1||ID)</code><br>
</li>
<li><code>a  ~ 0 + exposition+(0+exposition||ID)</code></li>
</ol>
<ul>
<li>Ligne 1 specify the general formula for <span class="math inline">\(L\)</span>,</li>
<li>Ligne 2 specify there is an intercept plus a random effect of ID on <span class="math inline">\(L0\)</span>, in other words that <span class="math inline">\(L0\)</span> is definied by a population mean and inter-individual variation,</li>
<li>Ligne 3 specify that a depend on exposition and that there is a random effect on <span class="math inline">\(a\)</span> that depends on the exposition, in other words that <span class="math inline">\(a\)</span> is definied by a population mean and inter-individual variation and these depend on the exposition.</li>
</ul>
</section>
<section id="parameter-recovery-with-simulated-data" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="parameter-recovery-with-simulated-data"><span class="header-section-number">4.2</span> Parameter recovery with simulated data</h2>
<p>A first step is to look at the parameter recovery with a fit on simulated data.</p>
<section id="data-simulation" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="data-simulation"><span class="header-section-number">4.2.1</span> Data simulation</h3>
<p>According to <span class="citation" data-cites="bart_2020a">Bart et al. (<a href="references.html#ref-bart_2020a" role="doc-biblioref">2020</a>)</span>, earthworm initial size is 2.25 mg<span class="math inline">\(^{1/3}\)</span> (<span class="math inline">\(L0\)</span>) and grow at xxx mg<span class="math inline">\(^{1/3}\)</span>/day (<span class="math inline">\(a\)</span>). Next, we simulate data according to a variation attenuation scenario. To do so, we assume that the average growth rate in earthworms exposed to 3 RD of Swing Gold decreases by 10 % compared to a control cohort, as shown in <span class="citation" data-cites="bart_2020a">Bart et al. (<a href="references.html#ref-bart_2020a" role="doc-biblioref">2020</a>)</span>. We set the individual variability in the control group to 10% around the average growth rate which is coherent with Bart’s data. We set the change in among-individiual variance to 50 %, which would correspond to a moderate effect size of pesticide exposure on growth rate variation.</p>
<p>This gives us the following simulation parameters :</p>
<ul>
<li><span class="math inline">\(L0_{\mu}\)</span> = 2.25 mg<span class="math inline">\(^{1/3}\)</span></li>
<li><span class="math inline">\(a_{ctrl,\mu}\)</span> = 0.075 mg<span class="math inline">\(^{1/3}\)</span>/d</li>
<li><span class="math inline">\(a_{trt,\mu}\)</span> = 0.0675 mg<span class="math inline">\(^{1/3}\)</span>/d</li>
<li><span class="math inline">\(a_{ctrl,\sigma}\)</span> = 0.0075 mg<span class="math inline">\(^{1/3}\)</span>/d</li>
<li><span class="math inline">\(a_{trt,\sigma}\)</span> = 0.008775 mg<span class="math inline">\(^{1/3}\)</span>/d</li>
</ul>
<p>In parallele, the simulated pesticides effect can be expressed with a response ratio (Ln(RR), <a href="D_Growth_modeling.html#eq-LnRR" class="quarto-xref">Equation&nbsp;<span>5.1</span></a>) and a coefficient of variation ratio (Ln(CVi), <a href="D_Growth_modeling.html#eq-LnCVi" class="quarto-xref">Equation&nbsp;<span>5.2</span></a>).</p>
<p><span id="eq-LnRR"><span class="math display">\[
\text{Ln}(\text{RR}) = \text{Ln}\left( \frac{a_{ctrl,\mu}}{a_{trt,\mu}} \right)
\tag{4.2}\]</span></span></p>
<p><span id="eq-LnCVi"><span class="math display">\[
\text{Ln}(\text{CVi}) = \text{Ln}\left( \frac{CV_{ctrl}}{CV_{trt}} \right) - \frac{1}{2(n_{trt}-1)}-\frac{1}{2(n_{ctrl}-1)}\\
\tag{4.3}\]</span></span></p>
<p>With :</p>
<p><span class="math display">\[
CV_{x}=\frac{a_{x,\sigma}}{a_{x,\mu}}
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-1" class="code-annotation-target"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a>nb_ind_sim <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-3"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">242412</span>)</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-5"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a>a_ctrl_mu_mu <span class="ot">&lt;-</span> <span class="fl">0.075</span></span>
<span id="annotated-cell-1-6"><a href="#annotated-cell-1-6" aria-hidden="true" tabindex="-1"></a>a_ctrl_mu_sd <span class="ot">&lt;-</span> a_ctrl_mu_mu<span class="sc">*</span><span class="fl">0.1</span></span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7" aria-hidden="true" tabindex="-1"></a>a_trt_mu_mu <span class="ot">&lt;-</span> <span class="fl">0.0675</span></span>
<span id="annotated-cell-1-8"><a href="#annotated-cell-1-8" aria-hidden="true" tabindex="-1"></a>a_trt_mu_sd <span class="ot">&lt;-</span> a_ctrl_mu_mu<span class="sc">*</span><span class="fl">0.1</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">+0.5</span>)</span>
<span id="annotated-cell-1-9"><a href="#annotated-cell-1-9" aria-hidden="true" tabindex="-1"></a>L0_mu <span class="ot">&lt;-</span> <span class="fl">2.25</span></span>
<span id="annotated-cell-1-10"><a href="#annotated-cell-1-10" aria-hidden="true" tabindex="-1"></a>L0_sd <span class="ot">&lt;-</span> <span class="fl">0.45</span></span>
<span id="annotated-cell-1-11"><a href="#annotated-cell-1-11" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-12" class="code-annotation-target"><a href="#annotated-cell-1-12" aria-hidden="true" tabindex="-1"></a>List_a_i_ctrl <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(</span>
<span id="annotated-cell-1-13"><a href="#annotated-cell-1-13" aria-hidden="true" tabindex="-1"></a>  nb_ind_sim,</span>
<span id="annotated-cell-1-14"><a href="#annotated-cell-1-14" aria-hidden="true" tabindex="-1"></a>  a_ctrl_mu_mu,</span>
<span id="annotated-cell-1-15"><a href="#annotated-cell-1-15" aria-hidden="true" tabindex="-1"></a>  a_ctrl_mu_sd</span>
<span id="annotated-cell-1-16"><a href="#annotated-cell-1-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-1-17"><a href="#annotated-cell-1-17" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3">3</button><span id="annotated-cell-1-18" class="code-annotation-target"><a href="#annotated-cell-1-18" aria-hidden="true" tabindex="-1"></a>List_a_i_trt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(</span>
<span id="annotated-cell-1-19"><a href="#annotated-cell-1-19" aria-hidden="true" tabindex="-1"></a>  nb_ind_sim,</span>
<span id="annotated-cell-1-20"><a href="#annotated-cell-1-20" aria-hidden="true" tabindex="-1"></a>  a_trt_mu_mu,</span>
<span id="annotated-cell-1-21"><a href="#annotated-cell-1-21" aria-hidden="true" tabindex="-1"></a>  a_trt_mu_sd</span>
<span id="annotated-cell-1-22"><a href="#annotated-cell-1-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-1-23"><a href="#annotated-cell-1-23" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="4">4</button><span id="annotated-cell-1-24" class="code-annotation-target"><a href="#annotated-cell-1-24" aria-hidden="true" tabindex="-1"></a>List_L0_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(</span>
<span id="annotated-cell-1-25"><a href="#annotated-cell-1-25" aria-hidden="true" tabindex="-1"></a>  nb_ind_sim<span class="sc">*</span><span class="dv">2</span>,</span>
<span id="annotated-cell-1-26"><a href="#annotated-cell-1-26" aria-hidden="true" tabindex="-1"></a>  L0_mu,</span>
<span id="annotated-cell-1-27"><a href="#annotated-cell-1-27" aria-hidden="true" tabindex="-1"></a>  L0_sd</span>
<span id="annotated-cell-1-28"><a href="#annotated-cell-1-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-1-29"><a href="#annotated-cell-1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-30"><a href="#annotated-cell-1-30" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="5">5</button><span id="annotated-cell-1-31" class="code-annotation-target"><a href="#annotated-cell-1-31" aria-hidden="true" tabindex="-1"></a>df_pop_sim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="annotated-cell-1-32"><a href="#annotated-cell-1-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">seq</span>(<span class="dv">1</span>, nb_ind_sim<span class="sc">*</span><span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="annotated-cell-1-33"><a href="#annotated-cell-1-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">L0_i =</span> List_L0_i,</span>
<span id="annotated-cell-1-34"><a href="#annotated-cell-1-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">a_i =</span> <span class="fu">c</span>(List_a_i_ctrl, List_a_i_trt),</span>
<span id="annotated-cell-1-35"><a href="#annotated-cell-1-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposition =</span> <span class="fu">c</span>(</span>
<span id="annotated-cell-1-36"><a href="#annotated-cell-1-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="dv">0</span>, nb_ind_sim),</span>
<span id="annotated-cell-1-37"><a href="#annotated-cell-1-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="dv">1</span>, nb_ind_sim)</span>
<span id="annotated-cell-1-38"><a href="#annotated-cell-1-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="annotated-cell-1-39"><a href="#annotated-cell-1-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-1-40"><a href="#annotated-cell-1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-41"><a href="#annotated-cell-1-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Real pop values </span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="6">6</button><span id="annotated-cell-1-42" class="code-annotation-target"><a href="#annotated-cell-1-42" aria-hidden="true" tabindex="-1"></a>sim_a_ctrl_mu <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="fu">subset</span>(df_pop_sim, exposition <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">mean</span>(a_i))</span>
<span id="annotated-cell-1-43"><a href="#annotated-cell-1-43" aria-hidden="true" tabindex="-1"></a>sim_a_ctrl_sd <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="fu">subset</span>(df_pop_sim, exposition <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">sd</span>(a_i))</span>
<span id="annotated-cell-1-44"><a href="#annotated-cell-1-44" aria-hidden="true" tabindex="-1"></a>sim_a_trt_mu <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="fu">subset</span>(df_pop_sim, exposition <span class="sc">==</span> <span class="dv">1</span>), <span class="fu">mean</span>(a_i))</span>
<span id="annotated-cell-1-45"><a href="#annotated-cell-1-45" aria-hidden="true" tabindex="-1"></a>sim_a_trt_sd <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="fu">subset</span>(df_pop_sim, exposition <span class="sc">==</span> <span class="dv">1</span>), <span class="fu">sd</span>(a_i))</span>
<span id="annotated-cell-1-46"><a href="#annotated-cell-1-46" aria-hidden="true" tabindex="-1"></a>sim_L0_mu <span class="ot">&lt;-</span> <span class="fu">with</span>(df_pop_sim, <span class="fu">mean</span>(L0_i))</span>
<span id="annotated-cell-1-47"><a href="#annotated-cell-1-47" aria-hidden="true" tabindex="-1"></a>sim_L0_sd <span class="ot">&lt;-</span> <span class="fu">with</span>(df_pop_sim, <span class="fu">sd</span>(L0_i))</span>
<span id="annotated-cell-1-48"><a href="#annotated-cell-1-48" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="7">7</button><span id="annotated-cell-1-49" class="code-annotation-target"><a href="#annotated-cell-1-49" aria-hidden="true" tabindex="-1"></a>sim_LnRR <span class="ot">&lt;-</span> <span class="fu">log</span>(sim_a_trt_mu<span class="sc">/</span>sim_a_ctrl_mu)</span>
<span id="annotated-cell-1-50"><a href="#annotated-cell-1-50" aria-hidden="true" tabindex="-1"></a>sim_LnCVi <span class="ot">&lt;-</span> <span class="fu">log</span>((sim_a_trt_sd<span class="sc">/</span>sim_a_trt_mu)<span class="sc">/</span>(sim_a_ctrl_sd<span class="sc">/</span>sim_a_ctrl_mu))</span>
<span id="annotated-cell-1-51"><a href="#annotated-cell-1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-52"><a href="#annotated-cell-1-52" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> sim_a_trt_sd<span class="sc">/</span>sim_a_ctrl_sd</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="1" data-code-annotation="1">Number of individuals in each populations.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="12,13,14,15,16" data-code-annotation="2">Simulation of the growth rates of non exposed individuals.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="18,19,20,21,22" data-code-annotation="3">Simulation of the growth rates of exposed individuals.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="24,25,26,27,28" data-code-annotation="4">Simulation of the initial structural length.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="31,32,33,34,35,36,37,38,39" data-code-annotation="5">Dataframe with all individuals from both populations. (0 = Non exposed, 1 = Exposed)</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="42,43,44,45,46,47" data-code-annotation="6">Calculation of the real parameters values in the simulated population.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="49,50" data-code-annotation="7">Calculation of Ln(RR) and Ln(CVi).</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Times with weight measurements</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>t_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="dv">14</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Approximate error on L</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculation of each earthworm weight at each time point</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>df_sim <span class="ot">&lt;-</span> df_pop_sim <span class="sc">|&gt;</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">t =</span> t_values) <span class="sc">|&gt;</span>   </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lhat =</span> L0_i <span class="sc">+</span> a_i <span class="sc">*</span> t</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span>   </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">L =</span> <span class="fu">rtruncnorm</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">mean =</span> Lhat, <span class="at">sd =</span> sd, <span class="at">a =</span> <span class="dv">0</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">w =</span> L<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">exposition =</span> <span class="fu">as.factor</span>(exposition),</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">ID =</span> <span class="fu">as.factor</span>(ID)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>alpha_point <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>alpha_line <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>p_growth <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>t, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>w, </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">color=</span>exposition, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">group=</span>ID</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd=</span><span class="fl">0.8</span>, </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_line, </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey80"</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim, </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>t, </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>w, </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">color=</span>exposition, </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">group=</span>ID</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_point, </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">2</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>exposition) <span class="sc">+</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> pal_col, </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">label  =</span> <span class="fu">c</span>(<span class="st">"Non exposed"</span>, <span class="st">"Exposed"</span>), </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">name   =</span> <span class="st">""</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x         =</span> <span class="st">"Time (days)"</span>, </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y         =</span> <span class="st">"Weight (mg)"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">title     =</span> <span class="st">"Growth of simulated individuals"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle  =</span> <span class="st">"For the &lt;span style = 'color:#5E81AC;'&gt;non exposed&lt;/span&gt; </span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="st">       and &lt;span style = 'color:#f42404;'&gt;exposed&lt;/span&gt; groups"</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">56</span>),        </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">28</span>),        </span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">14</span>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="fu">element_markdown</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle=</span><span class="fu">element_markdown</span>(<span class="at">face=</span><span class="st">"plain"</span>),</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>),</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>p_growth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-growthdatasim" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-growthdatasim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-growthdatasim-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-growthdatasim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Growth of simulated individuals
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model-definition-with-brms" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="model-definition-with-brms"><span class="header-section-number">4.2.2</span> Model definition with <code>brms</code></h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model definition</span></span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a>bf.mod <span class="ot">&lt;-</span> </span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-4-4"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-5" class="code-annotation-target"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>    L  <span class="sc">~</span> L0<span class="sc">+</span>a<span class="sc">*</span>t,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-6" class="code-annotation-target"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>    L0 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">||</span>ID),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3">3</button><span id="annotated-cell-4-7" class="code-annotation-target"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a>    a  <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> exposition<span class="sc">+</span>(<span class="dv">0</span><span class="sc">+</span>exposition<span class="sc">||</span>ID),</span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a>    </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="4">4</button><span id="annotated-cell-4-9" class="code-annotation-target"><a href="#annotated-cell-4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">center=</span>F,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="5">5</button><span id="annotated-cell-4-10" class="code-annotation-target"><a href="#annotated-cell-4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">nl=</span>T</span>
<span id="annotated-cell-4-11"><a href="#annotated-cell-4-11" aria-hidden="true" tabindex="-1"></a>  )                              </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="5" data-code-annotation="1">Equation of L depending on t</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="6" data-code-annotation="2">Each individual can have its own L0 value but L0 does not depend on the exposition</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="7" data-code-annotation="3">Each individual can have its own a value and a depend on the exposition</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="9" data-code-annotation="4">Data are centered in the calculation process</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="10" data-code-annotation="5">Our parameters have non-linear definitions</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>List_parameters <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_L0_Intercept"</span>,       <span class="co"># L0_mu</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sd_ID__L0_Intercept"</span>,  <span class="co"># L0_sd</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_a_exposition0"</span>,      <span class="co"># a_ctrl_mu</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"b_a_exposition1"</span>,      <span class="co"># a_trt_mu</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sd_ID__a_exposition0"</span>, <span class="co"># a_ctrl_sd</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sd_ID__a_exposition1"</span>, <span class="co"># a_trt_sd</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sigma"</span>                 <span class="co"># Residuals variance</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The model parameters are named as follows by <code>brms</code> :</p>
<ul>
<li><span class="math inline">\(L0_{\mu}\)</span> : <code>b_L0_Intercept</code></li>
<li><span class="math inline">\(L0_{\sigma}\)</span> : <code>sd_ID__L0_Intercept</code></li>
<li><span class="math inline">\(a_{\text{ctrl},\mu}\)</span> : <code>b_a_exposition0</code></li>
<li><span class="math inline">\(a_{\text{trt},\mu}\)</span> : <code>b_a_exposition1</code></li>
<li><span class="math inline">\(a_{\text{ctrl},\sigma}\)</span> : <code>sd_ID__a_exposition0</code></li>
<li><span class="math inline">\(a_{\text{trt},\sigma}\)</span> : <code>sd_ID__a_exposition1</code></li>
</ul>
</section>
<section id="sec-Cpriorsdef" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="sec-Cpriorsdef"><span class="header-section-number">4.2.3</span> Priors definitions</h3>
<p>The priors cannot be defined according to the results of <span class="citation" data-cites="bart_2020a">Bart et al. (<a href="references.html#ref-bart_2020a" role="doc-biblioref">2020</a>)</span>. Therefore we base the prior to our general knowledge about <em>A. caliginosa</em> :</p>
<ul>
<li>Weight at birth is often around 10 to 15 mg and might range from 8 to 20. The prior on <span class="math inline">\(L0_{\mu}\)</span> can be a normal distribution with a mean of 12.5<span class="math inline">\(^{1/3}\)</span> = 2.32 mg<span class="math inline">\(^{1/3}\)</span> and coefficient of variation of 20%. The prior on <span class="math inline">\(L0_{\sigma}\)</span> can be a normal distribution with a mean of 2.32 <span class="math inline">\(\times\)</span> 0.2 and a coefficient of variation of 100%. We also know that <span class="math inline">\(L0_{\mu}\)</span> cannot</li>
<li>An individual typically takes 4 months to be an adult weighting around 600 mg. It gives us a growth rate of 600<span class="math inline">\(^{1/3}\)</span>/(30 <span class="math inline">\(\times\)</span> 4) = 0.070 mg<span class="math inline">\(^{1/3}\)</span>/d.&nbsp;The prior on <span class="math inline">\(a_{ctrl,\mu}\)</span> can be a normal distribution with a mean of 0.070 and a coefficient of variation of 20% so our prior is less restrictive.</li>
<li>We have no real <em>a priori</em> knowledge about the inter-individual variation of growth. We therefore want a large prior such as a normal distribution with a mean of 15% of the mean growth rate and a coefficient of variation of 100%.</li>
</ul>
<p>The same priors are given to the two cohorts. A growth rate individual variation of 20% was given as a prior for the two cohort.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Priors definition</span></span>
<span id="annotated-cell-6-2"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-3" class="code-annotation-target"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">2.32</span>, <span class="fl">2.32</span><span class="sc">*</span><span class="fl">0.2</span>), <span class="at">class =</span> b, <span class="at">nlpar =</span> L0, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2">2</button><span id="annotated-cell-6-4" class="code-annotation-target"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">2.32</span><span class="sc">*</span><span class="fl">0.2</span>, <span class="fl">2.32</span><span class="sc">*</span><span class="fl">0.2</span>), <span class="at">class =</span> sd, <span class="at">nlpar =</span> L0)<span class="sc">+</span></span>
<span id="annotated-cell-6-5"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="3">3</button><span id="annotated-cell-6-6" class="code-annotation-target"><a href="#annotated-cell-6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.070</span>, <span class="fl">0.070</span><span class="sc">*</span><span class="fl">0.2</span>), <span class="at">class=</span>b, <span class="at">coef=</span>exposition0, <span class="at">nlpar =</span> a) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="4">4</button><span id="annotated-cell-6-7" class="code-annotation-target"><a href="#annotated-cell-6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.070</span>,  <span class="fl">0.070</span><span class="sc">*</span><span class="fl">0.2</span>), <span class="at">class=</span>b, <span class="at">coef=</span>exposition1, <span class="at">nlpar =</span> a) <span class="sc">+</span></span>
<span id="annotated-cell-6-8"><a href="#annotated-cell-6-8" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="5">5</button><span id="annotated-cell-6-9" class="code-annotation-target"><a href="#annotated-cell-6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.070</span><span class="sc">*</span><span class="fl">0.2</span>,  <span class="fl">0.070</span>), <span class="at">class=</span>sd,</span>
<span id="annotated-cell-6-10"><a href="#annotated-cell-6-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">coef=</span>exposition0, <span class="at">group=</span>ID, <span class="at">nlpar =</span> a)<span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="6">6</button><span id="annotated-cell-6-11" class="code-annotation-target"><a href="#annotated-cell-6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.070</span><span class="sc">*</span><span class="fl">0.2</span>,  <span class="fl">0.070</span>), <span class="at">class=</span>sd,</span>
<span id="annotated-cell-6-12"><a href="#annotated-cell-6-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">coef=</span>exposition1, <span class="at">group=</span>ID, <span class="at">nlpar =</span> a)<span class="sc">+</span></span>
<span id="annotated-cell-6-13"><a href="#annotated-cell-6-13" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="7">7</button><span id="annotated-cell-6-14" class="code-annotation-target"><a href="#annotated-cell-6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), sigma, <span class="at">nlpar=</span><span class="st">""</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="3" data-code-annotation="1">Prior on <span class="math inline">\(L0_{\mu}\)</span></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="4" data-code-annotation="2">Prior on <span class="math inline">\(L0_{\sigma}\)</span></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="6" data-code-annotation="3">Prior on <span class="math inline">\(a_{\text{ctrl},\mu}\)</span></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="7" data-code-annotation="4">Prior on <span class="math inline">\(a_{\text{trt},\mu}\)</span></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="9,10" data-code-annotation="5">Prior on <span class="math inline">\(a_{\text{ctrl},\sigma}\)</span></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="11,12" data-code-annotation="6">Prior on <span class="math inline">\(a_{\text{trt},\sigma}\)</span></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="14" data-code-annotation="7">Prior on residuals</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>col_dens <span class="ot">&lt;-</span> Nord_polar[<span class="dv">1</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>alpha_dens <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sizetitle <span class="ot">&lt;-</span> <span class="dv">18</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>priors<span class="sc">$</span>nlpar <span class="ot">&lt;-</span> <span class="fu">factor</span>(priors<span class="sc">$</span>nlpar, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"L0"</span>, <span class="st">"a"</span>)) </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"b"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj, </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">format</span>(.dist_obj),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> coef,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> coef</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>nlpar<span class="sc">+</span>coef, </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"free"</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(Nord_polar[<span class="dv">4</span>], Nord_frost[<span class="dv">4</span>], col_red))<span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(Nord_polar[<span class="dv">4</span>], Nord_frost[<span class="dv">4</span>], col_red))<span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Intercepts"</span>) <span class="sc">+</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> sizetitle),</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>, <span class="at">size =</span> sizetitle<span class="dv">-2</span>),</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"sd"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj, </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">format</span>(.dist_obj),</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> coef,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> coef</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>nlpar<span class="sc">+</span>coef, </span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"free"</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(Nord_polar[<span class="dv">4</span>], Nord_frost[<span class="dv">4</span>], col_red))<span class="sc">+</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(Nord_polar[<span class="dv">4</span>], Nord_frost[<span class="dv">4</span>], col_red))<span class="sc">+</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Inter-individual variances"</span>) <span class="sc">+</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> sizetitle),</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>, <span class="at">size =</span> sizetitle<span class="dv">-2</span>),</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"sigma"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj, </span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">format</span>(.dist_obj),</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> coef,</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> coef</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = col_dens,</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># color = col_dens,</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>nlpar, </span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"free"</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(Nord_polar[<span class="dv">4</span>], Nord_frost[<span class="dv">4</span>], col_red))<span class="sc">+</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(Nord_polar[<span class="dv">4</span>], Nord_frost[<span class="dv">4</span>], col_red))<span class="sc">+</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Residual variance"</span>) <span class="sc">+</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> sizetitle),</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>, <span class="at">size =</span> sizetitle<span class="dv">-2</span>),</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>  p1, p2, p3, </span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"v"</span>, <span class="at">axis =</span> <span class="st">"l"</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-priorplot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-priorplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-priorplot-1.png" class="img-fluid figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-priorplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Priors of our model.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="prior-predictive-check" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="prior-predictive-check"><span class="header-section-number">4.2.4</span> Prior predictive check</h3>
<p>In bayesian modeling, we first perform a prior predictive check before fitting the model to our data. This allows us to check on the rationnality of the chosen priors.</p>
<p>Results of the model with the sampling of priors :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a>m.sim.prior <span class="ot">&lt;-</span> </span>
<span id="annotated-cell-8-2"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-8-3"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_sim,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-5" class="code-annotation-target"><a href="#annotated-cell-8-5" aria-hidden="true" tabindex="-1"></a>    bf.mod,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="3">3</button><span id="annotated-cell-8-6" class="code-annotation-target"><a href="#annotated-cell-8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="4">4</button><span id="annotated-cell-8-7" class="code-annotation-target"><a href="#annotated-cell-8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> priors,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="5">5</button><span id="annotated-cell-8-8" class="code-annotation-target"><a href="#annotated-cell-8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_prior =</span> <span class="st">"only"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="6">6</button><span id="annotated-cell-8-9" class="code-annotation-target"><a href="#annotated-cell-8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">4</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="7">7</button><span id="annotated-cell-8-10" class="code-annotation-target"><a href="#annotated-cell-8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">1212</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="8">8</button><span id="annotated-cell-8-11" class="code-annotation-target"><a href="#annotated-cell-8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">warmup =</span> <span class="dv">500</span>,</span>
<span id="annotated-cell-8-12"><a href="#annotated-cell-8-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="9">9</button><span id="annotated-cell-8-13" class="code-annotation-target"><a href="#annotated-cell-8-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">adapt_delta =</span> .<span class="dv">95</span>,</span>
<span id="annotated-cell-8-14"><a href="#annotated-cell-8-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_treedepth =</span> <span class="dv">12</span></span>
<span id="annotated-cell-8-15"><a href="#annotated-cell-8-15" aria-hidden="true" tabindex="-1"></a>      ), </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="10">10</button><span id="annotated-cell-8-16" class="code-annotation-target"><a href="#annotated-cell-8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">file=</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"mod/m_brms_prior_sim"</span>)</span>
<span id="annotated-cell-8-17"><a href="#annotated-cell-8-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-8-18"><a href="#annotated-cell-8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-8-19"><a href="#annotated-cell-8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m.sim.prior)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="4" data-code-annotation="1">Data used</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="5" data-code-annotation="2">Model to be used</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="6" data-code-annotation="3">Type of backend for calculations</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="7" data-code-annotation="4">Priors to be used</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="8" data-code-annotation="5">Work only done with priors and not the data</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="9" data-code-annotation="6">Cores for calculations</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="10" data-code-annotation="7">Seed for reproducibility</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="11" data-code-annotation="8">A total of 1000 interations are done with 500 that are part of the warmup phase</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="13,14" data-code-annotation="9">Control parameters on the iterations</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="16" data-code-annotation="10">Path where the model results are saved</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: L ~ L0 + a * t 
         L0 ~ 1 + (1 || ID)
         a ~ 0 + exposition + (0 + exposition || ID)
   Data: df_sim (Number of observations: 300) 
  Draws: 4 chains, each with iter = 1000; warmup = 500; thin = 1;
         total post-warmup draws = 2000

Multilevel Hyperparameters:
~ID (Number of levels: 60) 
                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(L0_Intercept)      0.61      0.35     0.05     1.35 1.00     1206      916
sd(a_exposition0)     0.06      0.04     0.00     0.16 1.00     1337      934
sd(a_exposition1)     0.06      0.04     0.00     0.17 1.00     1361      794

Regression Coefficients:
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
L0_Intercept      2.32      0.46     1.41     3.19 1.00     2449      980
a_exposition0     0.07      0.01     0.04     0.10 1.00     2637     1272
a_exposition1     0.07      0.01     0.04     0.10 1.00     3378     1323

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.99      1.01     0.03     3.89 1.00     1644      818

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>We can then plot the predictions of this model and see if they represent at least the full range of our experimental data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-1" class="code-annotation-target"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predicted_draws</span>(m.sim.prior, <span class="at">newdata=</span>df_sim)</span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a>y_max <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="annotated-cell-9-4"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-5"><a href="#annotated-cell-9-5" aria-hidden="true" tabindex="-1"></a>p_ctrl <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-7"><a href="#annotated-cell-9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(</span>
<span id="annotated-cell-9-8"><a href="#annotated-cell-9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(pred, exposition <span class="sc">==</span> <span class="dv">0</span>), </span>
<span id="annotated-cell-9-9"><a href="#annotated-cell-9-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> .prediction<span class="sc">^</span><span class="dv">3</span>, <span class="at">group =</span> exposition),</span>
<span id="annotated-cell-9-10"><a href="#annotated-cell-9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width=</span><span class="fu">c</span>(.<span class="dv">99</span>,.<span class="dv">95</span>,.<span class="dv">8</span>,.<span class="dv">5</span>),</span>
<span id="annotated-cell-9-11"><a href="#annotated-cell-9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"black"</span></span>
<span id="annotated-cell-9-12"><a href="#annotated-cell-9-12" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="annotated-cell-9-13"><a href="#annotated-cell-9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="annotated-cell-9-14"><a href="#annotated-cell-9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_sim, exposition <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="annotated-cell-9-15"><a href="#annotated-cell-9-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> w, <span class="at">group=</span>ID),</span>
<span id="annotated-cell-9-16"><a href="#annotated-cell-9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="annotated-cell-9-17"><a href="#annotated-cell-9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="annotated-cell-9-18"><a href="#annotated-cell-9-18" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="annotated-cell-9-19"><a href="#annotated-cell-9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="annotated-cell-9-20"><a href="#annotated-cell-9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_sim, exposition <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="annotated-cell-9-21"><a href="#annotated-cell-9-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> w, <span class="at">group =</span> ID),</span>
<span id="annotated-cell-9-22"><a href="#annotated-cell-9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="annotated-cell-9-23"><a href="#annotated-cell-9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="annotated-cell-9-24"><a href="#annotated-cell-9-24" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="annotated-cell-9-25"><a href="#annotated-cell-9-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-26"><a href="#annotated-cell-9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">rev</span>(pal_blue))<span class="sc">+</span></span>
<span id="annotated-cell-9-27"><a href="#annotated-cell-9-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-28"><a href="#annotated-cell-9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Weight (mg)"</span>, <span class="at">x=</span><span class="st">"Time (days)"</span>)<span class="sc">+</span></span>
<span id="annotated-cell-9-29"><a href="#annotated-cell-9-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-30"><a href="#annotated-cell-9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, y_max)<span class="sc">+</span></span>
<span id="annotated-cell-9-31"><a href="#annotated-cell-9-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-32"><a href="#annotated-cell-9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="annotated-cell-9-33"><a href="#annotated-cell-9-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">56</span>),        </span>
<span id="annotated-cell-9-34"><a href="#annotated-cell-9-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">28</span>),        </span>
<span id="annotated-cell-9-35"><a href="#annotated-cell-9-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">14</span>)</span>
<span id="annotated-cell-9-36"><a href="#annotated-cell-9-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="annotated-cell-9-37"><a href="#annotated-cell-9-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-38"><a href="#annotated-cell-9-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="dv">14</span>)<span class="sc">+</span></span>
<span id="annotated-cell-9-39"><a href="#annotated-cell-9-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="annotated-cell-9-40"><a href="#annotated-cell-9-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-41"><a href="#annotated-cell-9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-42"><a href="#annotated-cell-9-42" aria-hidden="true" tabindex="-1"></a>p_trt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="annotated-cell-9-43"><a href="#annotated-cell-9-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-44"><a href="#annotated-cell-9-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(</span>
<span id="annotated-cell-9-45"><a href="#annotated-cell-9-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(pred, exposition <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="annotated-cell-9-46"><a href="#annotated-cell-9-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y=</span>.prediction<span class="sc">^</span><span class="dv">3</span>, <span class="at">group=</span>exposition),</span>
<span id="annotated-cell-9-47"><a href="#annotated-cell-9-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width=</span><span class="fu">c</span>(.<span class="dv">99</span>,.<span class="dv">95</span>,.<span class="dv">8</span>,.<span class="dv">5</span>),</span>
<span id="annotated-cell-9-48"><a href="#annotated-cell-9-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"black"</span></span>
<span id="annotated-cell-9-49"><a href="#annotated-cell-9-49" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="annotated-cell-9-50"><a href="#annotated-cell-9-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="annotated-cell-9-51"><a href="#annotated-cell-9-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_sim, exposition <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="annotated-cell-9-52"><a href="#annotated-cell-9-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> w, <span class="at">group =</span> ID),</span>
<span id="annotated-cell-9-53"><a href="#annotated-cell-9-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="annotated-cell-9-54"><a href="#annotated-cell-9-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="annotated-cell-9-55"><a href="#annotated-cell-9-55" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="annotated-cell-9-56"><a href="#annotated-cell-9-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="annotated-cell-9-57"><a href="#annotated-cell-9-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_sim, exposition <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="annotated-cell-9-58"><a href="#annotated-cell-9-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> w, <span class="at">group =</span> ID),</span>
<span id="annotated-cell-9-59"><a href="#annotated-cell-9-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="annotated-cell-9-60"><a href="#annotated-cell-9-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="annotated-cell-9-61"><a href="#annotated-cell-9-61" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="annotated-cell-9-62"><a href="#annotated-cell-9-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-63"><a href="#annotated-cell-9-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">rev</span>(pal_red))<span class="sc">+</span></span>
<span id="annotated-cell-9-64"><a href="#annotated-cell-9-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-65"><a href="#annotated-cell-9-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Weight (mg)"</span>, <span class="at">x=</span><span class="st">"Time (days)"</span>)<span class="sc">+</span></span>
<span id="annotated-cell-9-66"><a href="#annotated-cell-9-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-67"><a href="#annotated-cell-9-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, y_max)<span class="sc">+</span></span>
<span id="annotated-cell-9-68"><a href="#annotated-cell-9-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="annotated-cell-9-69"><a href="#annotated-cell-9-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">56</span>),        </span>
<span id="annotated-cell-9-70"><a href="#annotated-cell-9-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">28</span>),        </span>
<span id="annotated-cell-9-71"><a href="#annotated-cell-9-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">14</span>)</span>
<span id="annotated-cell-9-72"><a href="#annotated-cell-9-72" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="annotated-cell-9-73"><a href="#annotated-cell-9-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-9-74"><a href="#annotated-cell-9-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="dv">14</span>)<span class="sc">+</span></span>
<span id="annotated-cell-9-75"><a href="#annotated-cell-9-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="annotated-cell-9-76"><a href="#annotated-cell-9-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-77"><a href="#annotated-cell-9-77" aria-hidden="true" tabindex="-1"></a>plot.prior_pred <span class="ot">&lt;-</span> p_ctrl <span class="sc">+</span> p_trt <span class="sc">+</span> </span>
<span id="annotated-cell-9-78"><a href="#annotated-cell-9-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span> </span>
<span id="annotated-cell-9-79"><a href="#annotated-cell-9-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="annotated-cell-9-80"><a href="#annotated-cell-9-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>, </span>
<span id="annotated-cell-9-81"><a href="#annotated-cell-9-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>), </span>
<span id="annotated-cell-9-82"><a href="#annotated-cell-9-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>),</span>
<span id="annotated-cell-9-83"><a href="#annotated-cell-9-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>)</span>
<span id="annotated-cell-9-84"><a href="#annotated-cell-9-84" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="annotated-cell-9-85"><a href="#annotated-cell-9-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-86"><a href="#annotated-cell-9-86" aria-hidden="true" tabindex="-1"></a>plot.prior_pred</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="1" data-code-annotation="1">Predictions from the model</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-priorpredVIsim" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-priorpredVIsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-priorpredVIsim-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-priorpredVIsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: Prior predictive check.Fresh body weight of simulated non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed every 28 days (red points and thin lines, each line corresponding to one individual). Colored ribbons correspond to the different credibility intervals for the mean growth for each cohort under the prior distribution. The thicker black lines represent the predicted mean body weight based solely on prior assumptions.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The <a href="#fig-priorpredVIsim" class="quarto-xref">Figure&nbsp;<span>4.3</span></a> shows the chosen priors are realistic.</p>
<p>The prior sensitivity of our model is explored <a href="F_SuppInfo.html#sec-Fpriorsens" class="quarto-xref"><span>Section 7.2</span></a>.</p>
</section>
<section id="posterior-predictive-check" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="posterior-predictive-check"><span class="header-section-number">4.2.5</span> Posterior predictive check</h3>
<section id="model-fit" class="level4" data-number="4.2.5.1">
<h4 data-number="4.2.5.1" class="anchored" data-anchor-id="model-fit"><span class="header-section-number">4.2.5.1</span> Model fit</h4>
<p>We can now fit the model to our simulated data.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1" aria-hidden="true" tabindex="-1"></a>m.sim.post <span class="ot">&lt;-</span></span>
<span id="annotated-cell-10-2"><a href="#annotated-cell-10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-10-3"><a href="#annotated-cell-10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-4" class="code-annotation-target"><a href="#annotated-cell-10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_sim,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-5" class="code-annotation-target"><a href="#annotated-cell-10-5" aria-hidden="true" tabindex="-1"></a>    bf.mod,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="3">3</button><span id="annotated-cell-10-6" class="code-annotation-target"><a href="#annotated-cell-10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="4">4</button><span id="annotated-cell-10-7" class="code-annotation-target"><a href="#annotated-cell-10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> priors,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="5">5</button><span id="annotated-cell-10-8" class="code-annotation-target"><a href="#annotated-cell-10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="6">6</button><span id="annotated-cell-10-9" class="code-annotation-target"><a href="#annotated-cell-10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="7">7</button><span id="annotated-cell-10-10" class="code-annotation-target"><a href="#annotated-cell-10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">12121212</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="8">8</button><span id="annotated-cell-10-11" class="code-annotation-target"><a href="#annotated-cell-10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="9">9</button><span id="annotated-cell-10-12" class="code-annotation-target"><a href="#annotated-cell-10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">6000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="10">10</button><span id="annotated-cell-10-13" class="code-annotation-target"><a href="#annotated-cell-10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">95</span>,</span>
<span id="annotated-cell-10-14"><a href="#annotated-cell-10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_treedepth =</span> <span class="dv">12</span>),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="11">11</button><span id="annotated-cell-10-15" class="code-annotation-target"><a href="#annotated-cell-10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">file=</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"mod/m_brms_post_sim"</span>)</span>
<span id="annotated-cell-10-16"><a href="#annotated-cell-10-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-10-17"><a href="#annotated-cell-10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-10-18"><a href="#annotated-cell-10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m.sim.post)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="4" data-code-annotation="1">Data used</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="5" data-code-annotation="2">Model to be used</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="6" data-code-annotation="3">Type of backend for calculations</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="7" data-code-annotation="4">Priors to be used</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="8" data-code-annotation="5">We want all parameters to be saved</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="9" data-code-annotation="6">Work done with priors and the data</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="10" data-code-annotation="7">Number of chains and cores for calculations</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="11" data-code-annotation="8">Seed for reproducibility</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="12" data-code-annotation="9">A total of 6000 interations are done with 1000 that are part of the warmup phase</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="13,14" data-code-annotation="10">Control parameters on the iterations</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="11">11</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="15" data-code-annotation="11">Path where the model results are saved</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: L ~ L0 + a * t 
         L0 ~ 1 + (1 || ID)
         a ~ 0 + exposition + (0 + exposition || ID)
   Data: df_sim (Number of observations: 300) 
  Draws: 4 chains, each with iter = 6000; warmup = 1000; thin = 1;
         total post-warmup draws = 20000

Multilevel Hyperparameters:
~ID (Number of levels: 60) 
                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(L0_Intercept)      0.41      0.04     0.34     0.49 1.00     4727     8913
sd(a_exposition0)     0.01      0.00     0.01     0.01 1.00     8096    12231
sd(a_exposition1)     0.01      0.00     0.01     0.01 1.00     6808    11548

Regression Coefficients:
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
L0_Intercept      2.28      0.05     2.18     2.39 1.00     2420     5015
a_exposition0     0.07      0.00     0.07     0.08 1.00     5502     9989
a_exposition1     0.07      0.00     0.06     0.07 1.00     3997     8397

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.10      0.01     0.09     0.11 1.00    13705    15182

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section id="parameter-estimation-results" class="level4" data-number="4.2.5.2">
<h4 data-number="4.2.5.2" class="anchored" data-anchor-id="parameter-estimation-results"><span class="header-section-number">4.2.5.2</span> Parameter estimation results</h4>
<p>Chains recuperation and calculation of additional parameters :</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-11"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="1">1</button><span id="annotated-cell-11-1" class="code-annotation-target"><a href="#annotated-cell-11-1" aria-hidden="true" tabindex="-1"></a>df_chains <span class="ot">&lt;-</span> <span class="fu">ggs</span>(m.sim.post, <span class="at">burnin =</span> T) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-11-2"><a href="#annotated-cell-11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Parameter <span class="sc">%in%</span> List_parameters) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-11-3"><a href="#annotated-cell-11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="annotated-cell-11-4"><a href="#annotated-cell-11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chain=</span><span class="fu">as.factor</span>(Chain),</span>
<span id="annotated-cell-11-5"><a href="#annotated-cell-11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">value=</span>value</span>
<span id="annotated-cell-11-6"><a href="#annotated-cell-11-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="annotated-cell-11-7"><a href="#annotated-cell-11-7" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="2">2</button><span id="annotated-cell-11-8" class="code-annotation-target"><a href="#annotated-cell-11-8" aria-hidden="true" tabindex="-1"></a>df_chains_post <span class="ot">&lt;-</span> df_chains <span class="sc">|&gt;</span></span>
<span id="annotated-cell-11-9"><a href="#annotated-cell-11-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(Iteration<span class="sc">&gt;</span><span class="dv">1000</span>)</span>
<span id="annotated-cell-11-10"><a href="#annotated-cell-11-10" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="3">3</button><span id="annotated-cell-11-11" class="code-annotation-target"><a href="#annotated-cell-11-11" aria-hidden="true" tabindex="-1"></a>df_chains_median <span class="ot">&lt;-</span> df_chains_post <span class="sc">|&gt;</span></span>
<span id="annotated-cell-11-12"><a href="#annotated-cell-11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(value <span class="sc">~</span> Parameter, median) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-11-13"><a href="#annotated-cell-11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">median =</span> value)</span>
<span id="annotated-cell-11-14"><a href="#annotated-cell-11-14" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="4">4</button><span id="annotated-cell-11-15" class="code-annotation-target"><a href="#annotated-cell-11-15" aria-hidden="true" tabindex="-1"></a>df_chains_post_large <span class="ot">&lt;-</span></span>
<span id="annotated-cell-11-16"><a href="#annotated-cell-11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dcast</span>(</span>
<span id="annotated-cell-11-17"><a href="#annotated-cell-11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_chains_post,</span>
<span id="annotated-cell-11-18"><a href="#annotated-cell-11-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> Iteration <span class="sc">+</span> Chain <span class="sc">~</span> Parameter,</span>
<span id="annotated-cell-11-19"><a href="#annotated-cell-11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">value.var =</span> <span class="st">'value'</span></span>
<span id="annotated-cell-11-20"><a href="#annotated-cell-11-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-11-21"><a href="#annotated-cell-11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-11-22"><a href="#annotated-cell-11-22" aria-hidden="true" tabindex="-1"></a>df_chains_post_large <span class="ot">&lt;-</span> df_chains_post_large <span class="sc">|&gt;</span></span>
<span id="annotated-cell-11-23"><a href="#annotated-cell-11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="annotated-cell-11-24"><a href="#annotated-cell-11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Delta_a_mu =</span> b_a_exposition1<span class="sc">-</span>b_a_exposition0,</span>
<span id="annotated-cell-11-25"><a href="#annotated-cell-11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ratio_a_mu =</span> b_a_exposition1<span class="sc">/</span>b_a_exposition0,</span>
<span id="annotated-cell-11-26"><a href="#annotated-cell-11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Delta_a_sd =</span> sd_ID__a_exposition1<span class="sc">-</span>sd_ID__a_exposition0,</span>
<span id="annotated-cell-11-27"><a href="#annotated-cell-11-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ratio_a_sd =</span> sd_ID__a_exposition1<span class="sc">/</span>sd_ID__a_exposition0,</span>
<span id="annotated-cell-11-28"><a href="#annotated-cell-11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">LnRR =</span> <span class="fu">log</span>(b_a_exposition1<span class="sc">/</span>b_a_exposition0),</span>
<span id="annotated-cell-11-29"><a href="#annotated-cell-11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">LnCVi =</span> <span class="fu">log</span>((sd_ID__a_exposition1<span class="sc">/</span>b_a_exposition1)<span class="sc">/</span>(sd_ID__a_exposition0<span class="sc">/</span>b_a_exposition0))</span>
<span id="annotated-cell-11-30"><a href="#annotated-cell-11-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-11-31"><a href="#annotated-cell-11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-11-32"><a href="#annotated-cell-11-32" aria-hidden="true" tabindex="-1"></a>df_chains_post_long <span class="ot">&lt;-</span> df_chains_post_large <span class="sc">|&gt;</span></span>
<span id="annotated-cell-11-33"><a href="#annotated-cell-11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(</span>
<span id="annotated-cell-11-34"><a href="#annotated-cell-11-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">id.vars=</span><span class="fu">c</span>(<span class="st">"Iteration"</span>, <span class="st">"Chain"</span>),</span>
<span id="annotated-cell-11-35"><a href="#annotated-cell-11-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure.vars=</span><span class="fu">colnames</span>(df_chains_post_large)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)],</span>
<span id="annotated-cell-11-36"><a href="#annotated-cell-11-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable.name=</span><span class="st">"Parameter"</span>,</span>
<span id="annotated-cell-11-37"><a href="#annotated-cell-11-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">value.name=</span><span class="st">"value"</span></span>
<span id="annotated-cell-11-38"><a href="#annotated-cell-11-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-11-39"><a href="#annotated-cell-11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-11-40"><a href="#annotated-cell-11-40" aria-hidden="true" tabindex="-1"></a>Param_a_mu <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="annotated-cell-11-41"><a href="#annotated-cell-11-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"b_a_exposition0"</span>,</span>
<span id="annotated-cell-11-42"><a href="#annotated-cell-11-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">"b_a_exposition1"</span></span>
<span id="annotated-cell-11-43"><a href="#annotated-cell-11-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-11-44"><a href="#annotated-cell-11-44" aria-hidden="true" tabindex="-1"></a>Param_a_sd <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="annotated-cell-11-45"><a href="#annotated-cell-11-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sd_ID__a_exposition0"</span>,</span>
<span id="annotated-cell-11-46"><a href="#annotated-cell-11-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sd_ID__a_exposition1"</span></span>
<span id="annotated-cell-11-47"><a href="#annotated-cell-11-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-11-48"><a href="#annotated-cell-11-48" aria-hidden="true" tabindex="-1"></a>Param_ctrl <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="annotated-cell-11-49"><a href="#annotated-cell-11-49" aria-hidden="true" tabindex="-1"></a>  <span class="st">"b_a_exposition0"</span>,</span>
<span id="annotated-cell-11-50"><a href="#annotated-cell-11-50" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sd_ID__a_exposition0"</span></span>
<span id="annotated-cell-11-51"><a href="#annotated-cell-11-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-11-52"><a href="#annotated-cell-11-52" aria-hidden="true" tabindex="-1"></a>Param_trt <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="annotated-cell-11-53"><a href="#annotated-cell-11-53" aria-hidden="true" tabindex="-1"></a>  <span class="st">"b_a_exposition1"</span>,</span>
<span id="annotated-cell-11-54"><a href="#annotated-cell-11-54" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sd_ID__a_exposition1"</span></span>
<span id="annotated-cell-11-55"><a href="#annotated-cell-11-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-11-56"><a href="#annotated-cell-11-56" aria-hidden="true" tabindex="-1"></a>Param_t0 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="annotated-cell-11-57"><a href="#annotated-cell-11-57" aria-hidden="true" tabindex="-1"></a>  <span class="st">"b_L0_Intercept"</span>,</span>
<span id="annotated-cell-11-58"><a href="#annotated-cell-11-58" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sd_ID__L0_Intercept"</span>,</span>
<span id="annotated-cell-11-59"><a href="#annotated-cell-11-59" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Delta_a_mu"</span>,</span>
<span id="annotated-cell-11-60"><a href="#annotated-cell-11-60" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Delta_a_sd"</span></span>
<span id="annotated-cell-11-61"><a href="#annotated-cell-11-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-11-62"><a href="#annotated-cell-11-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-11-63"><a href="#annotated-cell-11-63" aria-hidden="true" tabindex="-1"></a>df_chains_post_long <span class="ot">&lt;-</span> df_chains_post_long <span class="sc">|&gt;</span></span>
<span id="annotated-cell-11-64"><a href="#annotated-cell-11-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="annotated-cell-11-65"><a href="#annotated-cell-11-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">exposition =</span> <span class="fu">case_when</span>(</span>
<span id="annotated-cell-11-66"><a href="#annotated-cell-11-66" aria-hidden="true" tabindex="-1"></a>      Parameter <span class="sc">%in%</span> Param_ctrl <span class="sc">~</span> <span class="st">"Non exposed"</span>,</span>
<span id="annotated-cell-11-67"><a href="#annotated-cell-11-67" aria-hidden="true" tabindex="-1"></a>      Parameter <span class="sc">%in%</span> Param_trt <span class="sc">~</span> <span class="st">"Exposed"</span>,</span>
<span id="annotated-cell-11-68"><a href="#annotated-cell-11-68" aria-hidden="true" tabindex="-1"></a>      Parameter <span class="sc">%in%</span> Param_t0 <span class="sc">~</span> <span class="st">"General"</span>)</span>
<span id="annotated-cell-11-69"><a href="#annotated-cell-11-69" aria-hidden="true" tabindex="-1"></a>    )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-11" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="1,2,3,4,5,6" data-code-annotation="1">Extraction of each chain iterations values for each parameters</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="8,9" data-code-annotation="2">Only iterations after the warmup phase</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="11,12,13" data-code-annotation="3">Adding medians from each distribution</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="15,16,17,18,19,20,22,23,24,25,26,27,28,29,32,33,34,35,36,37,38" data-code-annotation="4">Calculation delta and ratios between non-exposed and exposed individuals</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>alpha_dens <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>alpha_dens_prior <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>font_size <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>col_dens <span class="ot">&lt;-</span> Nord_polar[<span class="dv">1</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>col_dens_ctrl <span class="ot">&lt;-</span> Nord_frost[<span class="dv">4</span>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>col_dens_trt <span class="ot">&lt;-</span> col_red</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>size_norm <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>prior_L0_mu <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"b"</span> <span class="sc">&amp;</span> nlpar <span class="sc">==</span> <span class="st">"L0"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>prior_L0_sd <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"sd"</span> <span class="sc">&amp;</span> nlpar <span class="sc">==</span> <span class="st">"L0"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>prior_a_ctrl_mu <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"b"</span> <span class="sc">&amp;</span> nlpar <span class="sc">==</span> <span class="st">"a"</span> <span class="sc">&amp;</span> coef <span class="sc">==</span> <span class="st">"exposition0"</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>prior_a_ctrl_sd <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"sd"</span> <span class="sc">&amp;</span> nlpar <span class="sc">==</span> <span class="st">"a"</span> <span class="sc">&amp;</span> coef <span class="sc">==</span> <span class="st">"exposition0"</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>prior_a_trt_mu <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"b"</span> <span class="sc">&amp;</span> nlpar <span class="sc">==</span> <span class="st">"a"</span> <span class="sc">&amp;</span> coef <span class="sc">==</span> <span class="st">"exposition1"</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>prior_a_trt_sd <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"sd"</span> <span class="sc">&amp;</span> nlpar <span class="sc">==</span> <span class="st">"a"</span> <span class="sc">&amp;</span> coef <span class="sc">==</span> <span class="st">"exposition1"</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>prior_sigma <span class="ot">&lt;-</span> priors <span class="sc">%&gt;%</span> </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"sigma"</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>plot_L0_mu <span class="ot">&lt;-</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> prior_L0_mu,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens_prior</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"b_L0_Intercept"</span>),</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>value,</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="st">"Mean initial structural length "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>})))</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>plot_L0_sd <span class="ot">&lt;-</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> prior_L0_sd,</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens_prior</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"sd_ID__L0_Intercept"</span>),</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>value,</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="st">"Individual variation of</span><span class="sc">\n</span><span class="st">initial structural length "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>})))</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>plot_a_ctrl_mu <span class="ot">&lt;-</span></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> prior_a_ctrl_mu,</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens_prior</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"b_a_exposition0"</span>),</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>value,</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens_ctrl,</span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens_ctrl,</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="st">"Mean growth rate "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>}<span class="sc">/</span>d))),</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Non-exposed"</span></span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>plot_a_trt_mu <span class="ot">&lt;-</span></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> prior_a_trt_mu,</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens_prior</span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"b_a_exposition1"</span>),</span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>value,</span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens_trt,</span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens_trt,</span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="st">"Mean growth rate "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>}<span class="sc">/</span>d))),</span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Exposed"</span></span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a>plot_a_ctrl_sd <span class="ot">&lt;-</span></span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> prior_a_ctrl_sd,</span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj</span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens_prior</span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"sd_ID__a_exposition0"</span>),</span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>value,</span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens_ctrl,</span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens_ctrl,</span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="st">"Inter-individual variation</span><span class="sc">\n</span><span class="st">of growth rate "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>}<span class="sc">/</span>d))),</span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Non-exposed"</span></span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>plot_a_trt_sd <span class="ot">&lt;-</span></span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> prior_a_trt_sd,</span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj</span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens_prior</span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"sd_ID__a_exposition1"</span>),</span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>value,</span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens_trt,</span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens_trt,</span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="st">"Inter-individual variation</span><span class="sc">\n</span><span class="st">of growth rate "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>}<span class="sc">/</span>d))),</span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Exposed"</span></span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a>plot_sigma <span class="ot">&lt;-</span></span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dist_halfeye</span>(</span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> prior_sigma,</span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a>      <span class="at">xdist =</span> .dist_obj</span>
<span id="cb7-230"><a href="#cb7-230" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb7-231"><a href="#cb7-231" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens_prior</span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"sigma"</span>),</span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>value,</span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_dens,</span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_dens,</span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha_dens</span>
<span id="cb7-243"><a href="#cb7-243" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-244"><a href="#cb7-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-245"><a href="#cb7-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb7-246"><a href="#cb7-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb7-247"><a href="#cb7-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">bquote</span>(<span class="fu">bold</span>(<span class="st">"Residual variance"</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>})))</span>
<span id="cb7-248"><a href="#cb7-248" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb7-249"><a href="#cb7-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-250"><a href="#cb7-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-251"><a href="#cb7-251" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb7-252"><a href="#cb7-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb7-253"><a href="#cb7-253" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-254"><a href="#cb7-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-255"><a href="#cb7-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-256"><a href="#cb7-256" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> (plot_L0_mu<span class="sc">+</span> plot_a_ctrl_mu <span class="sc">+</span> plot_a_trt_mu)<span class="sc">/</span>(plot_L0_sd <span class="sc">+</span> plot_a_ctrl_sd   <span class="sc">+</span> plot_a_trt_sd) <span class="sc">/</span> plot_sigma </span>
<span id="cb7-257"><a href="#cb7-257" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-priorpost" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-priorpost-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-priorpost-1.png" class="img-fluid figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-priorpost-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: Prior (light grey) and posterior distributions for each parameter.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Parameters estimation results :</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_res_VI <span class="ot">&lt;-</span> <span class="fu">summarise_draws</span>(<span class="fu">tidy_draws</span>(m.sim.post))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df_res_VI_show <span class="ot">&lt;-</span> df_res_VI[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>df_res_VI_show <span class="sc">|&gt;</span> <span class="fu">datatable</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'t'</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-left'</span>, <span class="at">targets =</span> <span class="st">"_all"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">class=</span><span class="st">"hover"</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatRound</span>(<span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(df_res_VI_show), <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-compvalposttheoVI" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-compvalposttheoVI-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.1: Different statistical values of the posterior distributions
</figcaption>
<div aria-describedby="tbl-compvalposttheoVI-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-9c8383572df8abc40ecb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9c8383572df8abc40ecb">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7"],["b_L0_Intercept","b_a_exposition0","b_a_exposition1","sd_ID__L0_Intercept","sd_ID__a_exposition0","sd_ID__a_exposition1","sigma"],[2.2840637695,0.074111805155,0.066567989245,0.40788810815,0.0078017668675,0.009824141066,0.101592260835],[2.28364,0.07411295,0.06655045,0.4049355,0.007683189999999999,0.009675359999999999,0.1013405],[0.05342610403300514,0.001490568346392975,0.001817289740963439,0.03970896018796034,0.001186966899870926,0.001443021530353666,0.00532213978123564],[0.05372942399999974,0.001443978270000002,0.001776896100000007,0.03871884030000002,0.001130415783000001,0.001384036751999998,0.00528628443],[2.196818,0.071676895,0.06361152,0.348307,0.006071366000000001,0.0077610985,0.09319029999999999],[2.3715015,0.07655784,0.06956783999999999,0.4788662499999999,0.0099378325,0.012411035,0.1107922],[1.00115687070321,1.000581078915969,1.001058652757698,1.000742546200306,0.9999686677188684,1.000619072589337,0.999989925088307],[2419.978571129914,5502.490078825916,3997.412082753256,4726.732380457339,8096.473721849127,6808.436104703797,13704.88191997441],[5015.486898311762,9988.602818481137,8396.665697002139,8913.452358623461,12231.14072588999,11548.10795671979,15181.50100245386]],"container":"<table class=\"hover\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>variable<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>sd<\/th>\n      <th>mad<\/th>\n      <th>q5<\/th>\n      <th>q95<\/th>\n      <th>rhat<\/th>\n      <th>ess_bulk<\/th>\n      <th>ess_tail<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-left","targets":"_all"},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"variable","targets":1},{"name":"mean","targets":2},{"name":"median","targets":3},{"name":"sd","targets":4},{"name":"mad","targets":5},{"name":"q5","targets":6},{"name":"q95","targets":7},{"name":"rhat","targets":8},{"name":"ess_bulk","targets":9},{"name":"ess_tail","targets":10}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render"],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculation of the results for Ln(RR) and Ln(CVi)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Median_LnRR <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"LnRR"</span>)<span class="sc">$</span>value)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>Median_LnCVi <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"LnCVi"</span>)<span class="sc">$</span>value)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>Median_LnRR_print <span class="ot">&lt;-</span> <span class="fu">round</span>(Median_LnRR, <span class="dv">2</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>Median_LnCVi_print <span class="ot">&lt;-</span> <span class="fu">round</span>(Median_LnCVi, <span class="dv">2</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>Median_Ratio_a_mu <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"Ratio_a_mu"</span>)<span class="sc">$</span>value)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>Median_Ratio_a_sd <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"Ratio_a_sd"</span>)<span class="sc">$</span>value)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>CI_Ratio_a_mu <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">ci</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"Ratio_a_mu"</span>)<span class="sc">$</span>value, <span class="at">method =</span> <span class="st">"ETI"</span>, <span class="at">ci =</span> <span class="fl">0.90</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>CI_Ratio_a_mu_p <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"["</span>, <span class="fu">round</span>(CI_Ratio_a_mu<span class="sc">$</span>CI_low,<span class="dv">2</span>), <span class="st">" ; "</span>, <span class="fu">round</span>(CI_Ratio_a_mu<span class="sc">$</span>CI_high,<span class="dv">2</span>), <span class="st">"]"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>CI_Ratio_a_sd <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">ci</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"Ratio_a_sd"</span>)<span class="sc">$</span>value, <span class="at">method =</span> <span class="st">"ETI"</span>, <span class="at">ci =</span> <span class="fl">0.90</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>CI_Ratio_a_sd_p <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"["</span>, <span class="fu">round</span>(CI_Ratio_a_sd<span class="sc">$</span>CI_low,<span class="dv">2</span>), <span class="st">" ; "</span>, <span class="fu">round</span>(CI_Ratio_a_sd<span class="sc">$</span>CI_high,<span class="dv">2</span>), <span class="st">"]"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>CI_LnRR <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">ci</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"LnRR"</span>)<span class="sc">$</span>value, <span class="at">method =</span> <span class="st">"ETI"</span>, <span class="at">ci =</span> <span class="fl">0.90</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>CI_LnRR_p <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"["</span>, <span class="fu">round</span>(CI_LnRR<span class="sc">$</span>CI_low,<span class="dv">2</span>), <span class="st">" ; "</span>, <span class="fu">round</span>(CI_LnRR<span class="sc">$</span>CI_high,<span class="dv">2</span>), <span class="st">"]"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>CI_LnCVi <span class="ot">&lt;-</span> bayestestR<span class="sc">::</span><span class="fu">ci</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"LnCVi"</span>)<span class="sc">$</span>value, <span class="at">ci =</span> <span class="fl">0.90</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>CI_LnCVi_p <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"["</span>, <span class="fu">round</span>(CI_LnCVi<span class="sc">$</span>CI_low,<span class="dv">2</span>), <span class="st">" ; "</span>, <span class="fu">round</span>(CI_LnCVi<span class="sc">$</span>CI_high,<span class="dv">2</span>), <span class="st">"]"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>pd_LnRR <span class="ot">&lt;-</span> <span class="fu">p_direction</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"LnRR"</span>)<span class="sc">$</span>value)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>pd_LnCVi <span class="ot">&lt;-</span> <span class="fu">p_direction</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"LnCVi"</span>)<span class="sc">$</span>value)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>pd_Ratio_a_mu <span class="ot">&lt;-</span> <span class="fu">p_direction</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"Ratio_a_mu"</span>)<span class="sc">$</span>value)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>pd_Ratio_a_sd <span class="ot">&lt;-</span> <span class="fu">p_direction</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter<span class="sc">==</span><span class="st">"Ratio_a_sd"</span>)<span class="sc">$</span>value)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>df_res_Ln <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"LnRR"</span>, <span class="st">"LnCVi"</span>, <span class="st">"Ratio a_mu"</span>, <span class="st">"Ratio a_sd"</span>),</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median =</span> <span class="fu">c</span>(Median_LnRR, Median_LnCVi, Median_Ratio_a_mu, Median_Ratio_a_sd),</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI =</span> <span class="fu">c</span>(CI_LnRR_p, CI_LnCVi_p, CI_Ratio_a_mu_p, CI_Ratio_a_sd_p),</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">pd =</span> <span class="fu">c</span>(pd_LnRR<span class="sc">$</span>pd, pd_LnCVi<span class="sc">$</span>pd, pd_Ratio_a_mu<span class="sc">$</span>pd, pd_Ratio_a_sd<span class="sc">$</span>pd)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> <span class="fu">round</span>(Median, <span class="dv">3</span>)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Results expressed as LnRR and LnCVi</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>df_res_Ln <span class="sc">|&gt;</span> <span class="fu">datatable</span>(</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'t'</span>,</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-left'</span>, <span class="at">targets =</span> <span class="st">"_all"</span>)</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">class=</span><span class="st">"hover"</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatRound</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-lnRRCVI" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lnRRCVI-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.2: Effect size results
</figcaption>
<div aria-describedby="tbl-lnRRCVI-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f40baa128f49de41b012" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f40baa128f49de41b012">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],["LnRR","LnCVi","Ratio a_mu","Ratio a_sd"],[-0.107,0.341,0.898,1.264],["[-0.16 ; -0.05]","[0 ; 0.69]","[0.85 ; 0.95]","[0.9 ; 1.78]"],[0.9988125,0.9499375,1,1]],"container":"<table class=\"hover\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>Median<\/th>\n      <th>CI<\/th>\n      <th>pd<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","autoWidth":true,"columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-left","targets":"_all"},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Variable","targets":1},{"name":"Median","targets":2},{"name":"CI","targets":3},{"name":"pd","targets":4}],"order":[],"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="chains" class="level4" data-number="4.2.5.3">
<h4 data-number="4.2.5.3" class="anchored" data-anchor-id="chains"><span class="header-section-number">4.2.5.3</span> Chains</h4>
<p>We can check if the chains look good (<a href="D_Growth_modeling.html#fig-chainsVI" class="quarto-xref">Figure&nbsp;<span>5.4</span></a>).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_chains_post,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Iteration, <span class="at">y =</span> value, <span class="at">color =</span> Chain, <span class="at">group =</span> Chain)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha=</span><span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Parameter, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">nord</span>(<span class="at">palette =</span> <span class="st">"frost"</span>))<span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">face=</span><span class="st">"plain"</span>),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-chainsVI" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chainsVI-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-chainsVI-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chainsVI-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: Parameters chains (without the first 1000 iterations of warmup).
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can also check on the parameters correlations (<a href="#fig-pairsVIsim" class="quarto-xref">Figure&nbsp;<span>4.6</span></a>).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">color_scheme_set</span>(<span class="st">"gray"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pairs</span>(m.sim.post, <span class="at">regex=</span>T)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pairsVIsim" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pairsVIsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-pairsVIsim-1.png" class="img-fluid figure-img" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pairsVIsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.6: Parameters correlations
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model-predictions" class="level4" data-number="4.2.5.4">
<h4 data-number="4.2.5.4" class="anchored" data-anchor-id="model-predictions"><span class="header-section-number">4.2.5.4</span> Model predictions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predicted_draws</span>(m.sim.post, <span class="at">newdata=</span>df_sim)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>post_i <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">posterior_summary</span>(m.sim.post))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">&lt;-</span> <span class="fu">subset</span>(df_sim, t<span class="sc">==</span><span class="dv">0</span>)<span class="sc">$</span>ID</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>expo <span class="ot">&lt;-</span> <span class="fu">subset</span>(df_sim, t<span class="sc">==</span><span class="dv">0</span>)<span class="sc">$</span>exposition</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>df_estimates <span class="ot">&lt;-</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ID                =</span> ID,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">exposition        =</span> expo,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_L0_i            =</span> post_i<span class="sc">$</span>Estimate[<span class="dv">8</span><span class="sc">:</span>(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">-</span><span class="dv">1</span>)],</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_a_i_expo_0      =</span> post_i<span class="sc">$</span>Estimate[(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID))<span class="sc">:</span>(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">*</span><span class="dv">2-1</span>)],</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_a_i_expo_1      =</span> post_i<span class="sc">$</span>Estimate[(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">*</span><span class="dv">2</span>)<span class="sc">:</span>(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">*</span><span class="dv">3-1</span>)],</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_a_i_2.5_expo_0  =</span> post_i<span class="sc">$</span>Q2<span class="fl">.5</span>[(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID))<span class="sc">:</span>(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">*</span><span class="dv">2-1</span>)],</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_a_i_2.5_expo_1  =</span> post_i<span class="sc">$</span>Q2<span class="fl">.5</span>[(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">*</span><span class="dv">2</span>)<span class="sc">:</span>(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">*</span><span class="dv">3-1</span>)],</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_a_i_97.5_expo_0 =</span> post_i<span class="sc">$</span>Q97<span class="fl">.5</span>[(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID))<span class="sc">:</span>(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">*</span><span class="dv">2-1</span>)],</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">r_a_i_97.5_expo_1 =</span> post_i<span class="sc">$</span>Q97<span class="fl">.5</span>[(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">*</span><span class="dv">2</span>)<span class="sc">:</span>(<span class="dv">8</span><span class="sc">+</span><span class="fu">length</span>(ID)<span class="sc">*</span><span class="dv">3-1</span>)]</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">L0_i =</span> post_i<span class="sc">$</span>Estimate[<span class="dv">1</span>]<span class="sc">+</span>r_L0_i,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">a_i =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      exposition <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> post_i<span class="sc">$</span>Estimate[<span class="dv">2</span>]<span class="sc">+</span>r_a_i_expo_0,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      exposition <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> post_i<span class="sc">$</span>Estimate[<span class="dv">3</span>]<span class="sc">+</span>r_a_i_expo_1</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">a_i_2.5 =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>      exposition<span class="sc">==</span><span class="dv">0</span> <span class="sc">~</span> post_i<span class="sc">$</span>Q2<span class="fl">.5</span>[<span class="dv">2</span>]<span class="sc">+</span>r_a_i_expo_0,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>      exposition<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> post_i<span class="sc">$</span>Q2<span class="fl">.5</span>[<span class="dv">3</span>]<span class="sc">+</span>r_a_i_expo_1</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">a_i_97.5 =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>      exposition<span class="sc">==</span><span class="dv">0</span> <span class="sc">~</span> post_i<span class="sc">$</span>Q97<span class="fl">.5</span>[<span class="dv">2</span>]<span class="sc">+</span>r_a_i_expo_0,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>      exposition<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> post_i<span class="sc">$</span>Q97<span class="fl">.5</span>[<span class="dv">3</span>]<span class="sc">+</span>r_a_i_expo_1</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, exposition, L0_i, a_i, a_i_2<span class="fl">.5</span>, a_i_97<span class="fl">.5</span>)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>df_pred_mean <span class="ot">&lt;-</span> pred <span class="sc">|&gt;</span> </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    .prediction <span class="sc">~</span> t <span class="sc">+</span> ID <span class="sc">+</span> exposition, </span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN=</span>mean</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>df_pred_Q <span class="ot">&lt;-</span> pred <span class="sc">|&gt;</span> </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    .prediction <span class="sc">~</span> t <span class="sc">+</span> ID <span class="sc">+</span> exposition, </span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN=</span><span class="st">'quantile'</span>, </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">probs=</span><span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">97.5</span>)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>df_pred <span class="ot">&lt;-</span> df_pred_mean <span class="sc">|&gt;</span> </span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df_pred_Q<span class="sc">$</span>.prediction[,<span class="dv">1</span>]) <span class="sc">|&gt;</span> </span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df_pred_Q<span class="sc">$</span>.prediction[,<span class="dv">2</span>]) <span class="sc">|&gt;</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expo=</span><span class="fu">case_when</span>(exposition<span class="sc">==</span><span class="dv">0</span> <span class="sc">~</span> <span class="st">"Non exposed"</span>,</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>                        exposition<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"Exposed"</span>))</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_pred) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"t"</span>, <span class="st">"ID"</span>, <span class="st">"exposition"</span>, </span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"pred_L_mean"</span>, <span class="st">"pred_L_Q2.5"</span>, <span class="st">"pred_L_Q97.5"</span>, <span class="st">"Expo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We now check the predictions of the model at the population level (<a href="#fig-postpredVIsim" class="quarto-xref">Figure&nbsp;<span>4.7</span></a>) and the individual level (<a href="#fig-postpredVIindctrlsim" class="quarto-xref">Figure&nbsp;<span>4.8</span></a> &amp; <a href="#fig-postpredVIindtrtsim" class="quarto-xref">Figure&nbsp;<span>4.9</span></a>) :</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>y_max <span class="ot">&lt;-</span> <span class="dv">480</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>p_ctrl <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred[pred<span class="sc">$</span>exposition <span class="sc">==</span> <span class="dv">0</span>,],</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>t, <span class="at">y=</span>.prediction<span class="sc">^</span><span class="dv">3</span>, <span class="at">group=</span>exposition),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width=</span><span class="fu">c</span>(.<span class="dv">99</span>,.<span class="dv">95</span>,.<span class="dv">8</span>,.<span class="dv">5</span>),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"black"</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_sim[df_sim<span class="sc">$</span>exposition <span class="sc">==</span> <span class="dv">0</span>,], </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> L<span class="sc">^</span><span class="dv">3</span>, <span class="at">group =</span> ID), </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#141c44"</span>, </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_sim[df_sim<span class="sc">$</span>exposition <span class="sc">==</span> <span class="dv">0</span>,], </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> L<span class="sc">^</span><span class="dv">3</span>, <span class="at">group =</span> ID), <span class="at">color =</span> <span class="st">"#141c44"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, y_max)<span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">56</span>),        </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">28</span>),        </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">14</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">rev</span>(pal_blue))<span class="sc">+</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Weight (mg)"</span>, <span class="at">x=</span><span class="st">"Time (days)"</span>)<span class="sc">+</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>p_trt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred[pred<span class="sc">$</span>exposition <span class="sc">==</span> <span class="dv">1</span>,], </span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>t, <span class="at">y =</span> .prediction<span class="sc">^</span><span class="dv">3</span>, <span class="at">group =</span> exposition),</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">99</span>,.<span class="dv">95</span>,.<span class="dv">8</span>,.<span class="dv">5</span>),</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_sim[df_sim<span class="sc">$</span>exposition <span class="sc">==</span> <span class="dv">1</span>,], </span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> L<span class="sc">^</span><span class="dv">3</span>, <span class="at">group =</span> ID), </span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#380000"</span>, </span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_sim[df_sim<span class="sc">$</span>exposition <span class="sc">==</span> <span class="dv">1</span>,], </span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> L<span class="sc">^</span><span class="dv">3</span>, <span class="at">group =</span> ID), </span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#380000"</span>, </span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">56</span>),        </span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">28</span>),        </span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">14</span>)</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, y_max)<span class="sc">+</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">rev</span>(pal_red))<span class="sc">+</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Weight (mg)"</span>, <span class="at">x =</span> <span class="st">"Time (days)"</span>)<span class="sc">+</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>plot.estimates.grp <span class="ot">&lt;-</span> p_ctrl <span class="sc">+</span> p_trt <span class="sc">+</span> </span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">guides=</span><span class="st">"collect"</span>) <span class="sc">&amp;</span> </span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>, </span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>), </span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>),</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>)</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>plot.estimates.grp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-postpredVIsim" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-postpredVIsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-postpredVIsim-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-postpredVIsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.7: Posterior predictive check. Fresh body weight of simulated non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points and thin lines, each line corresponding to one individual). Colored ribbons correspond to the different credibility intervals for the mean growth for each cohort. The thicker black lines represent the predicted mean body weight.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Non-exposed</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Exposed</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>p_ctrl <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred[pred<span class="sc">$</span>exposition<span class="sc">==</span><span class="dv">0</span>,], </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y=</span>.prediction<span class="sc">^</span><span class="dv">3</span>, <span class="at">color=</span>exposition, <span class="at">group=</span>ID),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width=</span><span class="fu">c</span>(.<span class="dv">99</span>,.<span class="dv">95</span>,.<span class="dv">8</span>,.<span class="dv">5</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"black"</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim[df_sim<span class="sc">$</span>exposition<span class="sc">==</span><span class="dv">0</span>,], </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>t, <span class="at">y=</span>L<span class="sc">^</span><span class="dv">3</span>, <span class="at">group=</span>ID), </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"#141c44"</span>, </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.25</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim[df_sim<span class="sc">$</span>exposition<span class="sc">==</span><span class="dv">0</span>,],</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>t, <span class="at">y=</span>L<span class="sc">^</span><span class="dv">3</span>, <span class="at">group=</span>ID), </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"#141c44"</span>, </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.3</span>, </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="fl">2.5</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID, <span class="at">ncol=</span><span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">rev</span>(pal_blue))<span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Weight (mg)"</span>, <span class="at">x=</span><span class="st">"Time (days)"</span>)<span class="sc">+</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, y_max)<span class="sc">+</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">56</span>),        </span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">28</span>),        </span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">14</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>, </span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">face=</span><span class="st">"plain"</span>), </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>),</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>p_ctrl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-postpredVIindctrlsim" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-postpredVIindctrlsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-postpredVIindctrlsim-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-postpredVIindctrlsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.8: Posterior predictive check. Fresh body weight of simulated non-exposed earthworms (blue points). Colored ribbons correspond to the different credibility intervals for the predicted growth for each individual. The thicker black lines represent the predicted body weight.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>p_trt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred[pred<span class="sc">$</span>exposition<span class="sc">==</span><span class="dv">1</span>,],</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y=</span>.prediction<span class="sc">^</span><span class="dv">3</span>, <span class="at">color=</span>exposition, <span class="at">group=</span>ID),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width=</span><span class="fu">c</span>(.<span class="dv">99</span>,.<span class="dv">95</span>,.<span class="dv">8</span>,.<span class="dv">5</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"black"</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim[df_sim<span class="sc">$</span>exposition<span class="sc">==</span><span class="dv">1</span>,], </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>t, <span class="at">y=</span>L<span class="sc">^</span><span class="dv">3</span>, <span class="at">group=</span>ID), </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"#380000"</span>, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.3</span>, </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="fl">2.5</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim[df_sim<span class="sc">$</span>exposition<span class="sc">==</span><span class="dv">1</span>,], </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>t, <span class="at">y=</span>L<span class="sc">^</span><span class="dv">3</span>, <span class="at">group=</span>ID), </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"#380000"</span>, </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.25</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID, <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">nrow=</span><span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">rev</span>(pal_red))<span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Weight (mg)"</span>, <span class="at">x=</span><span class="st">"Time (days)"</span>)<span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, y_max)<span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">56</span>),        </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">28</span>),        </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">56</span>, <span class="at">by =</span> <span class="dv">14</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>, </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">face=</span><span class="st">"plain"</span>), </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"plain"</span>),</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>)</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>p_trt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-postpredVIindtrtsim" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-postpredVIindtrtsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-postpredVIindtrtsim-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-postpredVIindtrtsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.9: Posterior predictive check. Fresh body weight of simulated exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points). Colored ribbons correspond to the different credibility intervals for the predicted growth for each individual. The thicker black lines represent the predicted body weight.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="comparison-of-the-simulated-and-estimated-parameters-values" class="level4" data-number="4.2.5.5">
<h4 data-number="4.2.5.5" class="anchored" data-anchor-id="comparison-of-the-simulated-and-estimated-parameters-values"><span class="header-section-number">4.2.5.5</span> Comparison of the simulated and estimated parameters values</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_sim_ordered <span class="ot">&lt;-</span> df_sim <span class="sc">|&gt;</span> <span class="fu">arrange</span>(t) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(ID))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>df_data_pred_obs <span class="ot">&lt;-</span> df_pred <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">w_obs =</span> df_sim_ordered<span class="sc">$</span>w,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_predobs =</span> pred_L_mean<span class="sc">^</span><span class="dv">3</span> <span class="sc">/</span> w_obs</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>fact_1 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>fact_2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>seq_line <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.1</span>, <span class="dv">600</span>, <span class="fl">0.1</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>df_line <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1  =</span> seq_line,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y1  =</span> seq_line<span class="sc">*</span>fact_1,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_1 =</span> seq_line,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_1 =</span> seq_line<span class="sc">/</span>fact_1,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2  =</span> seq_line,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y2  =</span> seq_line<span class="sc">*</span>fact_2,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_2 =</span> seq_line,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_2 =</span> seq_line<span class="sc">/</span>fact_2</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>plot_predobs_log <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span> </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_line, </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>x1, <span class="at">y=</span>y1), </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype=</span><span class="st">"dashed"</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_line, </span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>x_1, <span class="at">y=</span>y_1), </span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype=</span><span class="st">"dashed"</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_line, </span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>x2, <span class="at">y=</span>y2), </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype=</span><span class="st">"dotted"</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_line, </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>x_2, <span class="at">y=</span>y_2), </span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype=</span><span class="st">"dotted"</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_data_pred_obs, </span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>w_obs,</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>pred_L_mean<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin=</span>pred_L_Q2<span class="fl">.5</span><span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax=</span>pred_L_Q97<span class="fl">.5</span><span class="sc">^</span><span class="dv">3</span>, </span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">color=</span>Expo</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.5</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.6</span>, <span class="dv">700</span>))<span class="sc">+</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.6</span>, <span class="dv">700</span>))<span class="sc">+</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="st">"Observed weight (mg)"</span>, </span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="st">"Predicted weight (mg)"</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="dv">24</span>)<span class="sc">+</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>plot_predobs_log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-predobsw" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-predobsw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-predobsw-1.png" class="img-fluid figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-predobsw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.10: Results of the model fit on experimental data. Predicted values are represented with points with their respective credibility interval of 95%. Red points correspond to the predicted value for exposed individuals and blue points for the non exposed individuals. Dashed and dotted lines represent the 1.5-folds and 2-fold changes, respectively. The full line represents the identity line.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentage of points in the X-fold change area</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>f_fold <span class="ot">&lt;-</span> <span class="cf">function</span>(fold){</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">length</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">subset</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>      df_data_pred_obs, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>      ratio_predobs <span class="sc">&lt;</span> fold <span class="sc">&amp;</span> ratio_predobs <span class="sc">&gt;</span> <span class="sc">-</span>fold</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">$</span>w_obs</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">/</span><span class="fu">length</span>(<span class="fu">subset</span>(df_data_pred_obs, <span class="sc">!</span><span class="fu">is.na</span>(w_obs))<span class="sc">$</span>t)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>df_fold <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fold =</span> <span class="fu">c</span>(<span class="fl">1.05</span>, <span class="fl">1.075</span>, <span class="dv">1</span>, <span class="fl">1.25</span>, <span class="fl">1.5</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">per =</span> <span class="fu">signif</span>(<span class="fu">mapply</span>(f_fold, fold),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_fold) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fold"</span>, <span class="st">"Percentage of predictions within"</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>df_fold <span class="sc">|&gt;</span> <span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span> <span class="st">'t'</span>), <span class="at">class=</span><span class="st">"hover"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-foldpred" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-foldpred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.3: Percentage of points in the X-fold change area
</figcaption>
<div aria-describedby="tbl-foldpred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-1e2a3a805e68b3e9524f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1e2a3a805e68b3e9524f">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[1.05,1.075,1,1.25,1.5,2],[82,89,49,99,100,100]],"container":"<table class=\"hover\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Fold<\/th>\n      <th>Percentage of predictions within<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Fold","targets":1},{"name":"Percentage of predictions within","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>col_delta <span class="ot">&lt;-</span> Nord_polar[<span class="dv">4</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>font_size <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>alpha_dens <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>alpha_expo <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>plot_L0_mu <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span><span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"b_L0_Intercept"</span>),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>value</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> Nord_polar[<span class="dv">1</span>],</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> Nord_polar[<span class="dv">1</span>]</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">"Initial structural length "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>})))<span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust=</span><span class="fl">0.5</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_expo</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sim_L0_mu, <span class="at">color =</span> Nord_polar[<span class="dv">1</span>])<span class="sc">+</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(font_size)<span class="sc">+</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">"none"</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>plot_L0_sd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span><span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"sd_ID__L0_Intercept"</span>),</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>value</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> Nord_polar[<span class="dv">1</span>],</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> Nord_polar[<span class="dv">1</span>]</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">"Initial structural length individual variation "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>})))<span class="sc">+</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust=</span><span class="fl">0.5</span>,</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_expo</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sim_L0_sd, <span class="at">color =</span> Nord_polar[<span class="dv">1</span>])<span class="sc">+</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(font_size)<span class="sc">+</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>plot_res_mu <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span><span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">%in%</span> Param_a_mu),</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>    <span class="co">#x=Parameter,</span></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>value,</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>exposition,</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>exposition</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">"Mean growth rate "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>}<span class="sc">/</span>d)))<span class="sc">+</span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust=</span><span class="fl">0.5</span>,</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_expo</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sim_a_ctrl_mu, <span class="at">color =</span> pal_col[<span class="dv">1</span>])<span class="sc">+</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sim_a_trt_mu, <span class="at">color =</span> pal_col[<span class="dv">2</span>])<span class="sc">+</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(font_size)<span class="sc">+</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>plot_res_sd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span><span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">%in%</span> Param_a_sd),</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>value,</span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>exposition,</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>exposition</span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust=</span><span class="fl">0.5</span>,</span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_expo</span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sim_a_ctrl_sd, <span class="at">color =</span> pal_col[<span class="dv">1</span>])<span class="sc">+</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sim_a_trt_sd, <span class="at">color =</span> pal_col[<span class="dv">2</span>])<span class="sc">+</span></span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(</span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Growth rate individual variation "</span> (mg<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>}<span class="sc">/</span>d)</span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(font_size)<span class="sc">+</span></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">"none"</span></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>plot_LnRR <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span><span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"LnRR"</span>),</span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>value</span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> Nord_polar[<span class="dv">4</span>],</span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> Nord_polar[<span class="dv">4</span>]</span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">"Mean pesticides effect (LnRR)"</span>))<span class="sc">+</span></span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust=</span><span class="fl">0.5</span>,</span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_expo</span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sim_LnRR, <span class="at">color =</span> Nord_polar[<span class="dv">4</span>])<span class="sc">+</span></span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(font_size)<span class="sc">+</span></span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">"none"</span></span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a>plot_LnCVi <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span><span class="fu">subset</span>(df_chains_post_long,Parameter <span class="sc">==</span> <span class="st">"LnCVi"</span>),</span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>value</span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> Nord_polar[<span class="dv">4</span>],</span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> Nord_polar[<span class="dv">4</span>]</span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">"Pesticides effect on individual variation (LnCVi)"</span>))<span class="sc">+</span></span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust=</span><span class="fl">0.5</span>,</span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_expo</span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sim_LnCVi, <span class="at">color =</span> Nord_polar[<span class="dv">4</span>])<span class="sc">+</span></span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rev</span>(pal_col), <span class="at">name=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(font_size)<span class="sc">+</span></span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">"none"</span></span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot_L0_mu <span class="sc">+</span>plot_L0_sd <span class="sc">+</span>plot_res_mu <span class="sc">+</span> plot_res_sd <span class="sc">+</span> plot_LnRR <span class="sc">+</span> plot_LnCVi <span class="sc">+</span></span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">guides=</span><span class="st">"collect"</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-comppredsim" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comppredsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="C_Model_def_sim_data_files/figure-html/fig-comppredsim-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comppredsim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.11: Comparison of simulated vs predicted parameters values. Vertical lines represent the true values of the simulated population parameters.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-comppredsim" class="quarto-xref">Figure&nbsp;<span>4.11</span></a> shows the posterior distributions of estimated parameters, with vertical black lines indicating the true population values. The results demonstrate good parameter recovery, as the distributions are generally centered around the true values. Estimates for initial structural length, growth rate, and pesticide effects align well with the simulated data, indicating accurate inference.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_err <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="fu">as.list</span>(df_res_VI_show[<span class="dv">1</span>])<span class="sc">$</span>variable, <span class="st">"LnRR"</span>, <span class="st">"LnCVi"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Simulated =</span> <span class="fu">c</span>(sim_L0_mu, sim_a_ctrl_mu, sim_a_trt_mu, sim_L0_sd, sim_a_ctrl_sd, sim_a_trt_sd, sd, sim_LnRR, sim_LnCVi),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> <span class="fu">c</span>(<span class="fu">as.list</span>(df_res_VI_show[<span class="dv">2</span>])<span class="sc">$</span>mean, <span class="fu">mean</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter <span class="sc">==</span> <span class="st">"LnRR"</span>)<span class="sc">$</span>value), <span class="fu">mean</span>(<span class="fu">subset</span>(df_chains_post_long, Parameter <span class="sc">==</span> <span class="st">"LnCVi"</span>)<span class="sc">$</span>value))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>df_err <span class="ot">&lt;-</span> df_err <span class="sc">|&gt;</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Per_error =</span> (Predicted<span class="sc">-</span>Simulated)<span class="sc">/</span>Simulated<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>df_err <span class="sc">|&gt;</span> <span class="fu">datatable</span>(</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'t'</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-left'</span>, <span class="at">targets =</span> <span class="st">"_all"</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">class=</span><span class="st">"hover"</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatRound</span>(<span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(df_err), <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-err" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-err-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.4: Estimation errors on parameters
</figcaption>
<div aria-describedby="tbl-err-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c404cf398233e2c7d4ad" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c404cf398233e2c7d4ad">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9"],["b_L0_Intercept","b_a_exposition0","b_a_exposition1","sd_ID__L0_Intercept","sd_ID__a_exposition0","sd_ID__a_exposition1","sigma","LnRR","LnCVi"],[2.270116949027762,0.07486936910243548,0.06621820243980495,0.4112288318700272,0.007559970739262596,0.009974678529653735,0.1,-0.1227894631591187,0.3999718780960491],[2.2840637695,0.074111805155,0.066567989245,0.40788810815,0.0078017668675,0.009824141066,0.101592260835,-0.1073745828413052,0.3412858605808524],[0.61436572588084,-1.011847644126651,0.5282336159955787,-0.8123758504080431,3.198373863825152,-1.509196143075703,1.592260834999998,-12.55391132204711,-14.67253592791437]],"container":"<table class=\"hover\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Parameter<\/th>\n      <th>Simulated<\/th>\n      <th>Predicted<\/th>\n      <th>Per_error<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-left","targets":"_all"},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Parameter","targets":1},{"name":"Simulated","targets":2},{"name":"Predicted","targets":3},{"name":"Per_error","targets":4}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render"],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
<p>Parameter recovery is excellent at the population level, with absolute errors below 0.5%, and strong at the individual level, with absolute errors between 4 to 5%.</p>
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">
<p><b> Session Information </b></p>
</button>
<div id="collapseOne" class="accordion-collapse collapse">
<div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.2 (2022-10-31)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS 14.0

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
 [1] parallel  grid      stats4    stats     graphics  grDevices utils    
 [8] datasets  methods   base     

other attached packages:
 [1] devtools_2.4.5     usethis_2.2.3      readxl_1.4.3       DT_0.33           
 [5] kableExtra_1.4.0   knitr_1.47         latex2exp_0.9.6    nlstools_2.1-0    
 [9] lsmeans_2.30-0     emmeans_1.10.3     Hmisc_5.1-3        car_3.1-2         
[13] carData_3.0-5      modelsummary_2.2.0 extrafont_0.19     gridExtra_2.3     
[17] ggpubr_0.6.0       plotly_4.10.4      ggtext_0.1.2       ggbreak_0.1.2     
[21] cowplot_1.1.3      patchwork_1.2.0    ggdist_3.3.2       nord_1.0.0        
[25] RColorBrewer_1.1-3 wesanderson_0.3.7  viridis_0.6.5      viridisLite_0.4.2 
[29] ggthemes_5.1.0     see_0.8.4.3        report_0.5.8       parameters_0.22.2 
[33] performance_0.12.0 modelbased_0.8.8   insight_0.20.4     effectsize_0.8.8  
[37] datawizard_0.11.0  correlation_0.8.5  bayestestR_0.13.2  easystats_0.7.2   
[41] deSolve_1.40       priorsense_1.0.4   truncnorm_1.0-9    tmvtnorm_1.6      
[45] gmm_1.8            sandwich_3.1-0     Matrix_1.6-5       mvtnorm_1.2-5     
[49] fdrtool_1.2.17     tidybayes_3.0.6    ggmcmc_1.5.1.1     glmmTMB_1.1.9     
[53] rstan_2.32.6       StanHeaders_2.32.9 cmdstanr_0.8.0     brms_2.22.0       
[57] Rcpp_1.0.12        plan_0.4-5         reshape2_1.4.4     lubridate_1.9.3   
[61] forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2       
[65] readr_2.1.5        tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1     
[69] tidyverse_2.0.0    here_1.0.1        

loaded via a namespace (and not attached):
  [1] utf8_1.2.4           tidyselect_1.2.1     lme4_1.1-31         
  [4] htmlwidgets_1.6.4    munsell_0.5.1        ragg_1.3.2          
  [7] codetools_0.2-20     miniUI_0.1.1.1       withr_3.0.0         
 [10] Brobdingnag_1.2-9    colorspace_2.1-0     tables_0.9.28       
 [13] rstudioapi_0.16.0    ggsignif_0.6.4       Rttf2pt1_1.3.12     
 [16] bayesplot_1.11.1     labeling_0.4.3       farver_2.1.2        
 [19] bridgesampling_1.1-2 rprojroot_2.0.4      coda_0.19-4.1       
 [22] vctrs_0.6.5          generics_0.1.3       TH.data_1.1-2       
 [25] xfun_0.45            timechange_0.3.0     markdown_1.13       
 [28] R6_2.5.1             cachem_1.1.0         gridGraphics_0.5-1  
 [31] promises_1.3.0       scales_1.3.0         multcomp_1.4-25     
 [34] nnet_7.3-19          gtable_0.3.5         processx_3.8.4      
 [37] rlang_1.1.4          systemfonts_1.1.0    splines_4.2.2       
 [40] rstatix_0.7.2        extrafontdb_1.0      TMB_1.9.11          
 [43] lazyeval_0.2.2       broom_1.0.6          checkmate_2.3.1     
 [46] inline_0.3.19        yaml_2.3.8           abind_1.4-5         
 [49] crosstalk_1.2.1      backports_1.5.0      httpuv_1.6.15       
 [52] gridtext_0.1.5       tensorA_0.36.2.1     tools_4.2.2         
 [55] ggplotify_0.1.2      ellipsis_0.3.2       jquerylib_0.1.4     
 [58] posterior_1.6.0      sessioninfo_1.2.2    plyr_1.8.9          
 [61] base64enc_0.1-3      ps_1.7.6             rpart_4.1.23        
 [64] urlchecker_1.0.1     zoo_1.8-12           cluster_2.1.6       
 [67] fs_1.6.4             magrittr_2.0.3       data.table_1.15.4   
 [70] matrixStats_1.3.0    pkgload_1.4.0        mime_0.12           
 [73] hms_1.1.3            evaluate_0.24.0      arrayhelpers_1.1-0  
 [76] xtable_1.8-4         rstantools_2.4.0     compiler_4.2.2      
 [79] V8_4.4.2             minqa_1.2.7          htmltools_0.5.8.1   
 [82] later_1.3.2          ggfun_0.1.6          mgcv_1.9-1          
 [85] tzdb_0.4.0           Formula_1.2-5        aplot_0.2.3         
 [88] RcppParallel_5.1.7   MASS_7.3-58.1        boot_1.3-30         
 [91] cli_3.6.3            pkgconfig_2.0.3      numDeriv_2016.8-1.1 
 [94] foreign_0.8-87       xml2_1.3.6           svUnit_1.0.6        
 [97] svglite_2.1.3        bslib_0.7.0          QuickJSR_1.2.2      
[100] ggstats_0.6.0        estimability_1.5.1   yulab.utils_0.1.7   
[103] distributional_0.4.0 digest_0.6.36        cellranger_1.1.0    
[106] rmarkdown_2.27       htmlTable_2.4.2      curl_5.2.1          
[109] commonmark_1.9.1     shiny_1.8.1.1        nloptr_2.0.3        
[112] lifecycle_1.0.4      nlme_3.1-160         jsonlite_1.8.8      
[115] fansi_1.0.6          pillar_1.9.0         lattice_0.22-6      
[118] loo_2.8.0            GGally_2.2.1         fastmap_1.2.0       
[121] httr_1.4.7           pkgbuild_1.4.4       survival_3.7-0      
[124] remotes_2.5.0        glue_1.7.0           sass_0.4.9          
[127] profvis_0.3.8        stringi_1.8.4        textshaping_0.4.0   
[130] memoise_2.0.1       </code></pre>
</div>
</div>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-bart_2020a" class="csl-entry" role="listitem">
Bart, S., Pelosi, C., Nélieu, S., Lamy, I., &amp; Péry, A. R. R. (2020). An energy-based model to analyze growth data of earthworms exposed to two fungicides. <em>Environmental Science and Pollution Research</em>, <em>27</em>(1), 741–750. <a href="https://doi.org/10.1007/s11356-019-06985-z">https://doi.org/10.1007/s11356-019-06985-z</a>
</div>
<div id="ref-dingemanse_2013" class="csl-entry" role="listitem">
Dingemanse, N. J., &amp; Dochtermann, N. A. (2013). Quantifying individual variation in behaviour: Mixed‐effect modelling approaches. <em>Journal of Animal Ecology</em>, <em>82</em>(1), 39–54. <a href="https://doi.org/10.1111/1365-2656.12013">https://doi.org/10.1111/1365-2656.12013</a>
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../quarto/B_Growth_experiment.html" class="pagination-link" aria-label="Longitudinal monitoring of earthworm growth exposed to a fungicide">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Longitudinal monitoring of earthworm growth exposed to a fungicide</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../quarto/D_Growth_modeling.html" class="pagination-link" aria-label="Analysis of experimental data">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analysis of experimental data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb22" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r libraries, include=F, warning=F, message=F}</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="in">source(file = here::here("functions/functions.R"))</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="in">f_load_libraries_colors()</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu"># A model for earthworm growth and its individual variation</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model definition</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>To evaluate individual variations in growth and fungicide sensitivity parameters, a simplified version of the bioenergetic model from @bart_2020a was developed.</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>We used an individual reaction norm approach <span class="co">[</span><span class="ot">@dingemanse_2013</span><span class="co">]</span> to compare growth rate across exposed and non-exposed individuals. As indicated by <span class="co">[</span><span class="ot">@bart_2020a</span><span class="co">]</span>, *A. caliginosa* growth is approximately linear with the structural volumetric length $L$ during the juvenile phase of the life-cycle. This structural volumetric length can be calculated as the cubic root of the wet weight of the organisms.</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>Here, we assume that both cohorts can have a different growth rate $\alpha$ (mg$^{1/3}$/d). We suppose the structural volumetric length at the start of the experiment ($L0$) does not depend on the treatment as individuals came from the same pool of individuals.</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>To take individual variations for both parameters, we assume that each parameter can be considered as a random variable described by a normal distribution whose mean is the population-level value of the parameter and the standard deviation is the individual variation of the parameter. Each individual can then have a parameter value that is taken from this normal distribution.</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>This gives us @eq-growth.</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>L_{c,i} &amp;\sim \mathcal{N}(L_{\mu,c,i}, \sigma_L)<span class="sc">\\</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>L_{\mu,c,i}(t)&amp;=L0_i+a_{c,i}\times t <span class="sc">\\</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>\text{With}<span class="sc">\\</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>L0_{i} &amp;\sim \mathcal{N}(L0_{\mu}, L0_{\sigma})<span class="sc">\\</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>a_{c,i} &amp;\sim \mathcal{N}(a_{c,\mu}, a_{c,\sigma})</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>$$ {#eq-growth}</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>With :</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$i$ : the individual under a certain exposure $(i \in <span class="co">[</span><span class="ot">\![1,60]\!</span><span class="co">]</span>),$</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$c$ : the exposition concentration (0 or 3 RD),</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$L_{c,i}(t)$ : the cubic root of the wet body weight of individual i exposed to the concentration $c$ at a given time $t$ (mg$^{1/3}$),</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$L_{\mu,c,i}(t)$ : the expected cubic root of the wet body weight of individual $i$ exposed to the concentration $c$ at time $t$,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\sigma_L$ : standard deviation of residuals on $L_{c,i}$, representing the variability not captured by the growth model,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$L0_i$ : the cubic root of the wet body weight at t=0 (mg$^{1/3}$),</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{c,i}$ : the growth rate (mg$^{1/3}$/d) of the individual $i$ exposed to the concentration $c$,</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$L0_{\mu}$ : mean of the normal distribution for the initial wet body weight ($L0_i$),</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$L0_{\sigma}$ : standard deviation of the normal distribution for the initial wet body weight ($L0_i$),</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{c,\mu}$ : mean of the normal distribution for the growth rate ($a_{c,i}$),</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{c,\sigma}$ : standard deviation of the normal distribution for the growth rate ($a_{c,i}$).</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>Our model is implemented with the <span class="in">`brms`</span> package which means this mathematical formulation translate to the following formula in the <span class="in">`brms`</span> language :</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span><span class="in">`L  ~ L0+a*t`</span>\</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span><span class="in">`L0 ~ 1 + (1||ID)`</span>\</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span><span class="in">`a  ~ 0 + exposition+(0+exposition||ID)`</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ligne 1 specify the general formula for $L$,</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ligne 2 specify there is an intercept plus a random effect of ID on $L0$, in other words that $L0$ is definied by a population mean and inter-individual variation,</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ligne 3 specify that a depend on exposition and that there is a random effect on $a$ that depends on the exposition, in other words that $a$ is definied by a population mean and inter-individual variation and these depend on the exposition.</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parameter recovery with simulated data</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>A first step is to look at the parameter recovery with a fit on simulated data.</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data simulation</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>According to @bart_2020a, earthworm initial size is 2.25 mg$^{1/3}$ ($L0$) and grow at xxx mg$^{1/3}$/day ($a$). Next, we simulate data according to a variation attenuation scenario. To do so, we assume that the average growth rate in earthworms exposed to 3 RD of Swing Gold decreases by 10 % compared to a control cohort, as shown in @bart_2020a. We set the individual variability in the control group to 10% around the average growth rate which is coherent with Bart's data. We set the change in among-individiual variance to 50 %, which would correspond to a moderate effect size of pesticide exposure on growth rate variation.</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>This gives us the following simulation parameters :</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$L0_{\mu}$ = 2.25 mg$^{1/3}$</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{ctrl,\mu}$ = 0.075 mg$^{1/3}$/d</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{trt,\mu}$ = 0.0675 mg$^{1/3}$/d</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{ctrl,\sigma}$ = 0.0075 mg$^{1/3}$/d</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{trt,\sigma}$ = 0.008775 mg$^{1/3}$/d</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>In parallele, the simulated pesticides effect can be expressed with a response ratio (Ln(RR), @eq-LnRR) and a coefficient of variation ratio (Ln(CVi), @eq-LnCVi).</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>\text{Ln}(\text{RR}) = \text{Ln}\left( \frac{a_{ctrl,\mu}}{a_{trt,\mu}} \right)</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>$$ {#eq-LnRR}</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>\text{Ln}(\text{CVi}) = \text{Ln}\left( \frac{CV_{ctrl}}{CV_{trt}} \right) - \frac{1}{2(n_{trt}-1)}-\frac{1}{2(n_{ctrl}-1)}<span class="sc">\\</span></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>$$ {#eq-LnCVi}</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>With :</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>CV_{x}=\frac{a_{x,\sigma}}{a_{x,\mu}}</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r datasim1}</span></span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a><span class="in">nb_ind_sim &lt;- 30                                              # &lt;1&gt;</span></span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(242412)</span></span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a><span class="in">a_ctrl_mu_mu &lt;- 0.075</span></span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a><span class="in">a_ctrl_mu_sd &lt;- a_ctrl_mu_mu*0.1</span></span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a><span class="in">a_trt_mu_mu &lt;- 0.0675</span></span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a><span class="in">a_trt_mu_sd &lt;- a_ctrl_mu_mu*0.1*(1+0.5)</span></span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a><span class="in">L0_mu &lt;- 2.25</span></span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a><span class="in">L0_sd &lt;- 0.45</span></span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a><span class="in">List_a_i_ctrl &lt;- rnorm(                                        # &lt;2&gt;</span></span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a><span class="in">  nb_ind_sim,                                                  # &lt;2&gt;</span></span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a><span class="in">  a_ctrl_mu_mu,                                                # &lt;2&gt;</span></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a><span class="in">  a_ctrl_mu_sd                                                 # &lt;2&gt;</span></span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a><span class="in">  )                                                            # &lt;2&gt;</span></span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a><span class="in">List_a_i_trt &lt;- rnorm(                                         # &lt;3&gt;</span></span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a><span class="in">  nb_ind_sim,                                                  # &lt;3&gt;</span></span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a><span class="in">  a_trt_mu_mu,                                                 # &lt;3&gt;</span></span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a><span class="in">  a_trt_mu_sd                                                  # &lt;3&gt;</span></span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a><span class="in">  )                                                            # &lt;3&gt;</span></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a><span class="in">List_L0_i &lt;- rnorm(                                            # &lt;4&gt;</span></span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a><span class="in">  nb_ind_sim*2,                                                # &lt;4&gt;</span></span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a><span class="in">  L0_mu,                                                       # &lt;4&gt;</span></span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a><span class="in">  L0_sd                                                        # &lt;4&gt;</span></span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a><span class="in">  )                                                            # &lt;4&gt;</span></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a><span class="in">df_pop_sim &lt;- data.frame(                                      # &lt;5&gt;</span></span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a><span class="in">  ID = seq(1, nb_ind_sim*2, 1),                                # &lt;5&gt;</span></span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a><span class="in">  L0_i = List_L0_i,                                            # &lt;5&gt;</span></span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a><span class="in">  a_i = c(List_a_i_ctrl, List_a_i_trt),                        # &lt;5&gt;</span></span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a><span class="in">  exposition = c(                                              # &lt;5&gt;</span></span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a><span class="in">    rep(0, nb_ind_sim),                                        # &lt;5&gt;</span></span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a><span class="in">    rep(1, nb_ind_sim)                                         # &lt;5&gt;</span></span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a><span class="in">    )                                                          # &lt;5&gt;</span></span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a><span class="in">  )                                                            # &lt;5&gt;</span></span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a><span class="in"># Real pop values </span></span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a><span class="in">sim_a_ctrl_mu &lt;- with(subset(df_pop_sim, exposition == 0), mean(a_i))    # &lt;6&gt;</span></span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a><span class="in">sim_a_ctrl_sd &lt;- with(subset(df_pop_sim, exposition == 0), sd(a_i))      # &lt;6&gt;</span></span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a><span class="in">sim_a_trt_mu &lt;- with(subset(df_pop_sim, exposition == 1), mean(a_i))     # &lt;6&gt;</span></span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a><span class="in">sim_a_trt_sd &lt;- with(subset(df_pop_sim, exposition == 1), sd(a_i))       # &lt;6&gt;</span></span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a><span class="in">sim_L0_mu &lt;- with(df_pop_sim, mean(L0_i))                                # &lt;6&gt;</span></span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a><span class="in">sim_L0_sd &lt;- with(df_pop_sim, sd(L0_i))                                  # &lt;6&gt;</span></span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a><span class="in">sim_LnRR &lt;- log(sim_a_trt_mu/sim_a_ctrl_mu)                                 # &lt;7&gt;</span></span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a><span class="in">sim_LnCVi &lt;- log((sim_a_trt_sd/sim_a_trt_mu)/(sim_a_ctrl_sd/sim_a_ctrl_mu)) # &lt;7&gt;</span></span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a><span class="in">tmp &lt;- sim_a_trt_sd/sim_a_ctrl_sd</span></span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Number of individuals in each populations.</span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Simulation of the growth rates of non exposed individuals.</span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Simulation of the growth rates of exposed individuals.</span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Simulation of the initial structural length.</span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Dataframe with all individuals from both populations. (0 = Non exposed, 1 = Exposed)</span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Calculation of the real parameters values in the simulated population.</span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Calculation of Ln(RR) and Ln(CVi).</span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-152"><a href="#cb22-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r datasim2}</span></span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a><span class="in"># Times with weight measurements</span></span>
<span id="cb22-156"><a href="#cb22-156" aria-hidden="true" tabindex="-1"></a><span class="in">t_values &lt;- seq(0, 56, 14)</span></span>
<span id="cb22-157"><a href="#cb22-157" aria-hidden="true" tabindex="-1"></a><span class="in"># Approximate error on L</span></span>
<span id="cb22-158"><a href="#cb22-158" aria-hidden="true" tabindex="-1"></a><span class="in">sd &lt;- 0.1</span></span>
<span id="cb22-159"><a href="#cb22-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculation of each earthworm weight at each time point</span></span>
<span id="cb22-161"><a href="#cb22-161" aria-hidden="true" tabindex="-1"></a><span class="in">df_sim &lt;- df_pop_sim |&gt; </span></span>
<span id="cb22-162"><a href="#cb22-162" aria-hidden="true" tabindex="-1"></a><span class="in">  expand_grid(t = t_values) |&gt;   </span></span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a><span class="in">    Lhat = L0_i + a_i * t</span></span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a><span class="in">  ) |&gt;   </span></span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a><span class="in">    L = rtruncnorm(n = n(), mean = Lhat, sd = sd, a = 0),</span></span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a><span class="in">    w = L^3</span></span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a><span class="in">  ) |&gt;</span></span>
<span id="cb22-170"><a href="#cb22-170" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb22-171"><a href="#cb22-171" aria-hidden="true" tabindex="-1"></a><span class="in">    exposition = as.factor(exposition),</span></span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a><span class="in">    ID = as.factor(ID)</span></span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-175"><a href="#cb22-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-176"><a href="#cb22-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-177"><a href="#cb22-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r simdataplot, warning=F, message=F}</span></span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Growth of simulated individuals</span></span>
<span id="cb22-179"><a href="#cb22-179" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-growthdatasim</span></span>
<span id="cb22-180"><a href="#cb22-180" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 6</span></span>
<span id="cb22-181"><a href="#cb22-181" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 4</span></span>
<span id="cb22-182"><a href="#cb22-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-183"><a href="#cb22-183" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_point &lt;- 0.5</span></span>
<span id="cb22-184"><a href="#cb22-184" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_line &lt;- 0.3</span></span>
<span id="cb22-185"><a href="#cb22-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-186"><a href="#cb22-186" aria-hidden="true" tabindex="-1"></a><span class="in">p_growth &lt;- ggplot() +</span></span>
<span id="cb22-187"><a href="#cb22-187" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-188"><a href="#cb22-188" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-189"><a href="#cb22-189" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim, </span></span>
<span id="cb22-190"><a href="#cb22-190" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-191"><a href="#cb22-191" aria-hidden="true" tabindex="-1"></a><span class="in">      x=t, </span></span>
<span id="cb22-192"><a href="#cb22-192" aria-hidden="true" tabindex="-1"></a><span class="in">      y=w, </span></span>
<span id="cb22-193"><a href="#cb22-193" aria-hidden="true" tabindex="-1"></a><span class="in">      color=exposition, </span></span>
<span id="cb22-194"><a href="#cb22-194" aria-hidden="true" tabindex="-1"></a><span class="in">      group=ID</span></span>
<span id="cb22-195"><a href="#cb22-195" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-196"><a href="#cb22-196" aria-hidden="true" tabindex="-1"></a><span class="in">    lwd=0.8, </span></span>
<span id="cb22-197"><a href="#cb22-197" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_line, </span></span>
<span id="cb22-198"><a href="#cb22-198" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "grey80"</span></span>
<span id="cb22-199"><a href="#cb22-199" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb22-200"><a href="#cb22-200" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb22-201"><a href="#cb22-201" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim, </span></span>
<span id="cb22-202"><a href="#cb22-202" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-203"><a href="#cb22-203" aria-hidden="true" tabindex="-1"></a><span class="in">      x=t, </span></span>
<span id="cb22-204"><a href="#cb22-204" aria-hidden="true" tabindex="-1"></a><span class="in">      y=w, </span></span>
<span id="cb22-205"><a href="#cb22-205" aria-hidden="true" tabindex="-1"></a><span class="in">      color=exposition, </span></span>
<span id="cb22-206"><a href="#cb22-206" aria-hidden="true" tabindex="-1"></a><span class="in">      group=ID</span></span>
<span id="cb22-207"><a href="#cb22-207" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-208"><a href="#cb22-208" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_point, </span></span>
<span id="cb22-209"><a href="#cb22-209" aria-hidden="true" tabindex="-1"></a><span class="in">    size=2</span></span>
<span id="cb22-210"><a href="#cb22-210" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb22-211"><a href="#cb22-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-212"><a href="#cb22-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-213"><a href="#cb22-213" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~exposition) +</span></span>
<span id="cb22-214"><a href="#cb22-214" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-215"><a href="#cb22-215" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(</span></span>
<span id="cb22-216"><a href="#cb22-216" aria-hidden="true" tabindex="-1"></a><span class="in">    values = pal_col, </span></span>
<span id="cb22-217"><a href="#cb22-217" aria-hidden="true" tabindex="-1"></a><span class="in">    label  = c("Non exposed", "Exposed"), </span></span>
<span id="cb22-218"><a href="#cb22-218" aria-hidden="true" tabindex="-1"></a><span class="in">    name   = ""</span></span>
<span id="cb22-219"><a href="#cb22-219" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb22-220"><a href="#cb22-220" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-221"><a href="#cb22-221" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-222"><a href="#cb22-222" aria-hidden="true" tabindex="-1"></a><span class="in">    x         = "Time (days)", </span></span>
<span id="cb22-223"><a href="#cb22-223" aria-hidden="true" tabindex="-1"></a><span class="in">    y         = "Weight (mg)",</span></span>
<span id="cb22-224"><a href="#cb22-224" aria-hidden="true" tabindex="-1"></a><span class="in">    title     = "Growth of simulated individuals",</span></span>
<span id="cb22-225"><a href="#cb22-225" aria-hidden="true" tabindex="-1"></a><span class="in">    subtitle  = "For the &lt;span style = 'color:#5E81AC;'&gt;non exposed&lt;/span&gt; </span></span>
<span id="cb22-226"><a href="#cb22-226" aria-hidden="true" tabindex="-1"></a><span class="in">       and &lt;span style = 'color:#f42404;'&gt;exposed&lt;/span&gt; groups"</span></span>
<span id="cb22-227"><a href="#cb22-227" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-228"><a href="#cb22-228" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-229"><a href="#cb22-229" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(</span></span>
<span id="cb22-230"><a href="#cb22-230" aria-hidden="true" tabindex="-1"></a><span class="in">    limits = c(0, 56),        </span></span>
<span id="cb22-231"><a href="#cb22-231" aria-hidden="true" tabindex="-1"></a><span class="in">    breaks = seq(0, 56, by = 28),        </span></span>
<span id="cb22-232"><a href="#cb22-232" aria-hidden="true" tabindex="-1"></a><span class="in">    minor_breaks = seq(0, 56, by = 14)</span></span>
<span id="cb22-233"><a href="#cb22-233" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-234"><a href="#cb22-234" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-235"><a href="#cb22-235" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal(12)+</span></span>
<span id="cb22-236"><a href="#cb22-236" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-237"><a href="#cb22-237" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "none",</span></span>
<span id="cb22-238"><a href="#cb22-238" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb22-239"><a href="#cb22-239" aria-hidden="true" tabindex="-1"></a><span class="in">    title=element_markdown(face="bold"),</span></span>
<span id="cb22-240"><a href="#cb22-240" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.subtitle=element_markdown(face="plain"),</span></span>
<span id="cb22-241"><a href="#cb22-241" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb22-242"><a href="#cb22-242" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title=element_text(face="plain"),</span></span>
<span id="cb22-243"><a href="#cb22-243" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb22-244"><a href="#cb22-244" aria-hidden="true" tabindex="-1"></a><span class="in">    strip.background = element_blank(),</span></span>
<span id="cb22-245"><a href="#cb22-245" aria-hidden="true" tabindex="-1"></a><span class="in">    strip.text = element_blank()</span></span>
<span id="cb22-246"><a href="#cb22-246" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-247"><a href="#cb22-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-248"><a href="#cb22-248" aria-hidden="true" tabindex="-1"></a><span class="in">p_growth</span></span>
<span id="cb22-249"><a href="#cb22-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-250"><a href="#cb22-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-251"><a href="#cb22-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-252"><a href="#cb22-252" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model definition with `brms`</span></span>
<span id="cb22-253"><a href="#cb22-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-254"><a href="#cb22-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r moddef}</span></span>
<span id="cb22-255"><a href="#cb22-255" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb22-256"><a href="#cb22-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-257"><a href="#cb22-257" aria-hidden="true" tabindex="-1"></a><span class="in"># Model definition</span></span>
<span id="cb22-258"><a href="#cb22-258" aria-hidden="true" tabindex="-1"></a><span class="in">bf.mod &lt;- </span></span>
<span id="cb22-259"><a href="#cb22-259" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-260"><a href="#cb22-260" aria-hidden="true" tabindex="-1"></a><span class="in">  bf(</span></span>
<span id="cb22-261"><a href="#cb22-261" aria-hidden="true" tabindex="-1"></a><span class="in">    L  ~ L0+a*t,                            # &lt;1&gt; </span></span>
<span id="cb22-262"><a href="#cb22-262" aria-hidden="true" tabindex="-1"></a><span class="in">    L0 ~ 1 + (1||ID),                       # &lt;2&gt;</span></span>
<span id="cb22-263"><a href="#cb22-263" aria-hidden="true" tabindex="-1"></a><span class="in">    a  ~ 0 + exposition+(0+exposition||ID), # &lt;3&gt;</span></span>
<span id="cb22-264"><a href="#cb22-264" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb22-265"><a href="#cb22-265" aria-hidden="true" tabindex="-1"></a><span class="in">    center=F,                               # &lt;4&gt;</span></span>
<span id="cb22-266"><a href="#cb22-266" aria-hidden="true" tabindex="-1"></a><span class="in">    nl=T                                    # &lt;5&gt;</span></span>
<span id="cb22-267"><a href="#cb22-267" aria-hidden="true" tabindex="-1"></a><span class="in">  )                              </span></span>
<span id="cb22-268"><a href="#cb22-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-269"><a href="#cb22-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-270"><a href="#cb22-270" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Equation of L depending on t</span>
<span id="cb22-271"><a href="#cb22-271" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Each individual can have its own L0 value but L0 does not depend on the exposition</span>
<span id="cb22-272"><a href="#cb22-272" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Each individual can have its own a value and a depend on the exposition</span>
<span id="cb22-273"><a href="#cb22-273" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Data are centered in the calculation process</span>
<span id="cb22-274"><a href="#cb22-274" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Our parameters have non-linear definitions</span>
<span id="cb22-275"><a href="#cb22-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-276"><a href="#cb22-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r modparamlist}</span></span>
<span id="cb22-277"><a href="#cb22-277" aria-hidden="true" tabindex="-1"></a><span class="in">List_parameters &lt;- </span></span>
<span id="cb22-278"><a href="#cb22-278" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-279"><a href="#cb22-279" aria-hidden="true" tabindex="-1"></a><span class="in">  c(</span></span>
<span id="cb22-280"><a href="#cb22-280" aria-hidden="true" tabindex="-1"></a><span class="in">    "b_L0_Intercept",       # L0_mu</span></span>
<span id="cb22-281"><a href="#cb22-281" aria-hidden="true" tabindex="-1"></a><span class="in">    "sd_ID__L0_Intercept",  # L0_sd</span></span>
<span id="cb22-282"><a href="#cb22-282" aria-hidden="true" tabindex="-1"></a><span class="in">    "b_a_exposition0",      # a_ctrl_mu</span></span>
<span id="cb22-283"><a href="#cb22-283" aria-hidden="true" tabindex="-1"></a><span class="in">    "b_a_exposition1",      # a_trt_mu</span></span>
<span id="cb22-284"><a href="#cb22-284" aria-hidden="true" tabindex="-1"></a><span class="in">    "sd_ID__a_exposition0", # a_ctrl_sd</span></span>
<span id="cb22-285"><a href="#cb22-285" aria-hidden="true" tabindex="-1"></a><span class="in">    "sd_ID__a_exposition1", # a_trt_sd</span></span>
<span id="cb22-286"><a href="#cb22-286" aria-hidden="true" tabindex="-1"></a><span class="in">    "sigma"                 # Residuals variance</span></span>
<span id="cb22-287"><a href="#cb22-287" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-288"><a href="#cb22-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-289"><a href="#cb22-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-290"><a href="#cb22-290" aria-hidden="true" tabindex="-1"></a>The model parameters are named as follows by <span class="in">`brms`</span> :</span>
<span id="cb22-291"><a href="#cb22-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-292"><a href="#cb22-292" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$L0_{\mu}$ : <span class="in">`b_L0_Intercept`</span></span>
<span id="cb22-293"><a href="#cb22-293" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$L0_{\sigma}$ : <span class="in">`sd_ID__L0_Intercept`</span></span>
<span id="cb22-294"><a href="#cb22-294" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{\text{ctrl},\mu}$ : <span class="in">`b_a_exposition0`</span></span>
<span id="cb22-295"><a href="#cb22-295" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{\text{trt},\mu}$ : <span class="in">`b_a_exposition1`</span></span>
<span id="cb22-296"><a href="#cb22-296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{\text{ctrl},\sigma}$ : <span class="in">`sd_ID__a_exposition0`</span></span>
<span id="cb22-297"><a href="#cb22-297" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a_{\text{trt},\sigma}$ : <span class="in">`sd_ID__a_exposition1`</span></span>
<span id="cb22-298"><a href="#cb22-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-299"><a href="#cb22-299" aria-hidden="true" tabindex="-1"></a><span class="fu">### Priors definitions {#sec-Cpriorsdef}</span></span>
<span id="cb22-300"><a href="#cb22-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-301"><a href="#cb22-301" aria-hidden="true" tabindex="-1"></a>The priors cannot be defined according to the results of @bart_2020a. Therefore we base the prior to our general knowledge about *A. caliginosa* :</span>
<span id="cb22-302"><a href="#cb22-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-303"><a href="#cb22-303" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Weight at birth is often around 10 to 15 mg and might range from 8 to 20. The prior on $L0_{\mu}$ can be a normal distribution with a mean of 12.5$^{1/3}$ = 2.32 mg$^{1/3}$ and coefficient of variation of 20%. The prior on $L0_{\sigma}$ can be a normal distribution with a mean of 2.32 $\times$ 0.2 and a coefficient of variation of 100%. We also know that $L0_{\mu}$ cannot</span>
<span id="cb22-304"><a href="#cb22-304" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>An individual typically takes 4 months to be an adult weighting around 600 mg. It gives us a growth rate of 600$^{1/3}$/(30 $\times$ 4) = 0.070 mg$^{1/3}$/d. The prior on $a_{ctrl,\mu}$ can be a normal distribution with a mean of 0.070 and a coefficient of variation of 20% so our prior is less restrictive.</span>
<span id="cb22-305"><a href="#cb22-305" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We have no real *a priori* knowledge about the inter-individual variation of growth. We therefore want a large prior such as a normal distribution with a mean of 15% of the mean growth rate and a coefficient of variation of 100%.</span>
<span id="cb22-306"><a href="#cb22-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-307"><a href="#cb22-307" aria-hidden="true" tabindex="-1"></a>The same priors are given to the two cohorts. A growth rate individual variation of 20% was given as a prior for the two cohort.</span>
<span id="cb22-308"><a href="#cb22-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-309"><a href="#cb22-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r priorsdef}</span></span>
<span id="cb22-310"><a href="#cb22-310" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb22-311"><a href="#cb22-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-312"><a href="#cb22-312" aria-hidden="true" tabindex="-1"></a><span class="in"># Priors definition</span></span>
<span id="cb22-313"><a href="#cb22-313" aria-hidden="true" tabindex="-1"></a><span class="in">priors &lt;-</span></span>
<span id="cb22-314"><a href="#cb22-314" aria-hidden="true" tabindex="-1"></a><span class="in">  prior(normal(2.32, 2.32*0.2), class = b, nlpar = L0, lb = 0) +                       # &lt;1&gt;</span></span>
<span id="cb22-315"><a href="#cb22-315" aria-hidden="true" tabindex="-1"></a><span class="in">  prior(normal(2.32*0.2, 2.32*0.2), class = sd, nlpar = L0)+                           # &lt;2&gt;</span></span>
<span id="cb22-316"><a href="#cb22-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-317"><a href="#cb22-317" aria-hidden="true" tabindex="-1"></a><span class="in">  prior(normal(0.070, 0.070*0.2), class=b, coef=exposition0, nlpar = a) +              # &lt;3&gt;</span></span>
<span id="cb22-318"><a href="#cb22-318" aria-hidden="true" tabindex="-1"></a><span class="in">  prior(normal(0.070,  0.070*0.2), class=b, coef=exposition1, nlpar = a) +             # &lt;4&gt;</span></span>
<span id="cb22-319"><a href="#cb22-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-320"><a href="#cb22-320" aria-hidden="true" tabindex="-1"></a><span class="in">  prior(normal(0.070*0.2,  0.070), class=sd,                                           # &lt;5&gt;</span></span>
<span id="cb22-321"><a href="#cb22-321" aria-hidden="true" tabindex="-1"></a><span class="in">        coef=exposition0, group=ID, nlpar = a)+                                        # &lt;5&gt;</span></span>
<span id="cb22-322"><a href="#cb22-322" aria-hidden="true" tabindex="-1"></a><span class="in">  prior(normal(0.070*0.2,  0.070), class=sd,                                           # &lt;6&gt;</span></span>
<span id="cb22-323"><a href="#cb22-323" aria-hidden="true" tabindex="-1"></a><span class="in">        coef=exposition1, group=ID, nlpar = a)+                                        # &lt;6&gt;</span></span>
<span id="cb22-324"><a href="#cb22-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-325"><a href="#cb22-325" aria-hidden="true" tabindex="-1"></a><span class="in">  prior(exponential(1), sigma, nlpar="")                                                         # &lt;7&gt;</span></span>
<span id="cb22-326"><a href="#cb22-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-327"><a href="#cb22-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-328"><a href="#cb22-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-329"><a href="#cb22-329" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Prior on $L0_{\mu}$</span>
<span id="cb22-330"><a href="#cb22-330" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Prior on $L0_{\sigma}$</span>
<span id="cb22-331"><a href="#cb22-331" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Prior on $a_{\text{ctrl},\mu}$</span>
<span id="cb22-332"><a href="#cb22-332" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Prior on $a_{\text{trt},\mu}$</span>
<span id="cb22-333"><a href="#cb22-333" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Prior on $a_{\text{ctrl},\sigma}$</span>
<span id="cb22-334"><a href="#cb22-334" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Prior on $a_{\text{trt},\sigma}$</span>
<span id="cb22-335"><a href="#cb22-335" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Prior on residuals</span>
<span id="cb22-336"><a href="#cb22-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-337"><a href="#cb22-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r priorsplot}</span></span>
<span id="cb22-338"><a href="#cb22-338" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Priors of our model.</span></span>
<span id="cb22-339"><a href="#cb22-339" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-priorplot</span></span>
<span id="cb22-340"><a href="#cb22-340" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 12</span></span>
<span id="cb22-341"><a href="#cb22-341" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 12</span></span>
<span id="cb22-342"><a href="#cb22-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-343"><a href="#cb22-343" aria-hidden="true" tabindex="-1"></a><span class="in">col_dens &lt;- Nord_polar[1]</span></span>
<span id="cb22-344"><a href="#cb22-344" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_dens &lt;- 0.5</span></span>
<span id="cb22-345"><a href="#cb22-345" aria-hidden="true" tabindex="-1"></a><span class="in">sizetitle &lt;- 18</span></span>
<span id="cb22-346"><a href="#cb22-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-347"><a href="#cb22-347" aria-hidden="true" tabindex="-1"></a><span class="in">priors$nlpar &lt;- factor(priors$nlpar, levels = c("L0", "a")) </span></span>
<span id="cb22-348"><a href="#cb22-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-349"><a href="#cb22-349" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- priors %&gt;% </span></span>
<span id="cb22-350"><a href="#cb22-350" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-351"><a href="#cb22-351" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "b") %&gt;% </span></span>
<span id="cb22-352"><a href="#cb22-352" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(</span></span>
<span id="cb22-353"><a href="#cb22-353" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-354"><a href="#cb22-354" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj, </span></span>
<span id="cb22-355"><a href="#cb22-355" aria-hidden="true" tabindex="-1"></a><span class="in">      y = format(.dist_obj),</span></span>
<span id="cb22-356"><a href="#cb22-356" aria-hidden="true" tabindex="-1"></a><span class="in">      color = coef,</span></span>
<span id="cb22-357"><a href="#cb22-357" aria-hidden="true" tabindex="-1"></a><span class="in">      fill = coef</span></span>
<span id="cb22-358"><a href="#cb22-358" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb22-359"><a href="#cb22-359" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb22-360"><a href="#cb22-360" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-361"><a href="#cb22-361" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-362"><a href="#cb22-362" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-363"><a href="#cb22-363" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(</span></span>
<span id="cb22-364"><a href="#cb22-364" aria-hidden="true" tabindex="-1"></a><span class="in">    ~nlpar+coef, </span></span>
<span id="cb22-365"><a href="#cb22-365" aria-hidden="true" tabindex="-1"></a><span class="in">    scales = "free"</span></span>
<span id="cb22-366"><a href="#cb22-366" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb22-367"><a href="#cb22-367" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+</span></span>
<span id="cb22-368"><a href="#cb22-368" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+</span></span>
<span id="cb22-369"><a href="#cb22-369" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtitle("Intercepts") +</span></span>
<span id="cb22-370"><a href="#cb22-370" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-371"><a href="#cb22-371" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-372"><a href="#cb22-372" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density"</span></span>
<span id="cb22-373"><a href="#cb22-373" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-374"><a href="#cb22-374" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-375"><a href="#cb22-375" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-376"><a href="#cb22-376" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-377"><a href="#cb22-377" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face="bold", size = sizetitle),</span></span>
<span id="cb22-378"><a href="#cb22-378" aria-hidden="true" tabindex="-1"></a><span class="in">    strip.text = element_text(face="plain", size = sizetitle-2),</span></span>
<span id="cb22-379"><a href="#cb22-379" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb22-380"><a href="#cb22-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-381"><a href="#cb22-381" aria-hidden="true" tabindex="-1"></a><span class="in">p2 &lt;- priors %&gt;% </span></span>
<span id="cb22-382"><a href="#cb22-382" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-383"><a href="#cb22-383" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "sd") %&gt;% </span></span>
<span id="cb22-384"><a href="#cb22-384" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(</span></span>
<span id="cb22-385"><a href="#cb22-385" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-386"><a href="#cb22-386" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj, </span></span>
<span id="cb22-387"><a href="#cb22-387" aria-hidden="true" tabindex="-1"></a><span class="in">      y = format(.dist_obj),</span></span>
<span id="cb22-388"><a href="#cb22-388" aria-hidden="true" tabindex="-1"></a><span class="in">      color = coef,</span></span>
<span id="cb22-389"><a href="#cb22-389" aria-hidden="true" tabindex="-1"></a><span class="in">      fill = coef</span></span>
<span id="cb22-390"><a href="#cb22-390" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb22-391"><a href="#cb22-391" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb22-392"><a href="#cb22-392" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-393"><a href="#cb22-393" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-394"><a href="#cb22-394" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-395"><a href="#cb22-395" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(</span></span>
<span id="cb22-396"><a href="#cb22-396" aria-hidden="true" tabindex="-1"></a><span class="in">    ~nlpar+coef, </span></span>
<span id="cb22-397"><a href="#cb22-397" aria-hidden="true" tabindex="-1"></a><span class="in">    scales = "free"</span></span>
<span id="cb22-398"><a href="#cb22-398" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb22-399"><a href="#cb22-399" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+</span></span>
<span id="cb22-400"><a href="#cb22-400" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+</span></span>
<span id="cb22-401"><a href="#cb22-401" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtitle("Inter-individual variances") +</span></span>
<span id="cb22-402"><a href="#cb22-402" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-403"><a href="#cb22-403" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-404"><a href="#cb22-404" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density"</span></span>
<span id="cb22-405"><a href="#cb22-405" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-406"><a href="#cb22-406" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-407"><a href="#cb22-407" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-408"><a href="#cb22-408" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-409"><a href="#cb22-409" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face="bold", size = sizetitle),</span></span>
<span id="cb22-410"><a href="#cb22-410" aria-hidden="true" tabindex="-1"></a><span class="in">    strip.text = element_text(face="plain", size = sizetitle-2),</span></span>
<span id="cb22-411"><a href="#cb22-411" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-412"><a href="#cb22-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-413"><a href="#cb22-413" aria-hidden="true" tabindex="-1"></a><span class="in">p3 &lt;- priors %&gt;% </span></span>
<span id="cb22-414"><a href="#cb22-414" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-415"><a href="#cb22-415" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "sigma") %&gt;% </span></span>
<span id="cb22-416"><a href="#cb22-416" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(</span></span>
<span id="cb22-417"><a href="#cb22-417" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-418"><a href="#cb22-418" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj, </span></span>
<span id="cb22-419"><a href="#cb22-419" aria-hidden="true" tabindex="-1"></a><span class="in">      y = format(.dist_obj),</span></span>
<span id="cb22-420"><a href="#cb22-420" aria-hidden="true" tabindex="-1"></a><span class="in">      color = coef,</span></span>
<span id="cb22-421"><a href="#cb22-421" aria-hidden="true" tabindex="-1"></a><span class="in">      fill = coef</span></span>
<span id="cb22-422"><a href="#cb22-422" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb22-423"><a href="#cb22-423" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb22-424"><a href="#cb22-424" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-425"><a href="#cb22-425" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = col_dens,</span></span>
<span id="cb22-426"><a href="#cb22-426" aria-hidden="true" tabindex="-1"></a><span class="in">    # color = col_dens,</span></span>
<span id="cb22-427"><a href="#cb22-427" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-428"><a href="#cb22-428" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-429"><a href="#cb22-429" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(</span></span>
<span id="cb22-430"><a href="#cb22-430" aria-hidden="true" tabindex="-1"></a><span class="in">    ~nlpar, </span></span>
<span id="cb22-431"><a href="#cb22-431" aria-hidden="true" tabindex="-1"></a><span class="in">    scales = "free"</span></span>
<span id="cb22-432"><a href="#cb22-432" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb22-433"><a href="#cb22-433" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+</span></span>
<span id="cb22-434"><a href="#cb22-434" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c(Nord_polar[4], Nord_frost[4], col_red))+</span></span>
<span id="cb22-435"><a href="#cb22-435" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtitle("Residual variance") +</span></span>
<span id="cb22-436"><a href="#cb22-436" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-437"><a href="#cb22-437" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-438"><a href="#cb22-438" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density"</span></span>
<span id="cb22-439"><a href="#cb22-439" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-440"><a href="#cb22-440" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-441"><a href="#cb22-441" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-442"><a href="#cb22-442" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-443"><a href="#cb22-443" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face="bold", size = sizetitle),</span></span>
<span id="cb22-444"><a href="#cb22-444" aria-hidden="true" tabindex="-1"></a><span class="in">    strip.text = element_text(face="plain", size = sizetitle-2),</span></span>
<span id="cb22-445"><a href="#cb22-445" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-446"><a href="#cb22-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-447"><a href="#cb22-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-448"><a href="#cb22-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-449"><a href="#cb22-449" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- plot_grid(</span></span>
<span id="cb22-450"><a href="#cb22-450" aria-hidden="true" tabindex="-1"></a><span class="in">  p1, p2, p3, </span></span>
<span id="cb22-451"><a href="#cb22-451" aria-hidden="true" tabindex="-1"></a><span class="in">  ncol = 1, align = "v", axis = "l"</span></span>
<span id="cb22-452"><a href="#cb22-452" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb22-453"><a href="#cb22-453" aria-hidden="true" tabindex="-1"></a><span class="in">p</span></span>
<span id="cb22-454"><a href="#cb22-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-455"><a href="#cb22-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-456"><a href="#cb22-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-457"><a href="#cb22-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r savepriorsplot, include=F, message=F, warning=F}</span></span>
<span id="cb22-458"><a href="#cb22-458" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(</span></span>
<span id="cb22-459"><a href="#cb22-459" aria-hidden="true" tabindex="-1"></a><span class="in">  filename="ModVI_priors.png", </span></span>
<span id="cb22-460"><a href="#cb22-460" aria-hidden="true" tabindex="-1"></a><span class="in">  plot=p, </span></span>
<span id="cb22-461"><a href="#cb22-461" aria-hidden="true" tabindex="-1"></a><span class="in">  width=8, height = 10, </span></span>
<span id="cb22-462"><a href="#cb22-462" aria-hidden="true" tabindex="-1"></a><span class="in">  path=here::here("fig/")</span></span>
<span id="cb22-463"><a href="#cb22-463" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-464"><a href="#cb22-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-465"><a href="#cb22-465" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(</span></span>
<span id="cb22-466"><a href="#cb22-466" aria-hidden="true" tabindex="-1"></a><span class="in">  filename="ModVI_priors.svg", </span></span>
<span id="cb22-467"><a href="#cb22-467" aria-hidden="true" tabindex="-1"></a><span class="in">  plot=p, </span></span>
<span id="cb22-468"><a href="#cb22-468" aria-hidden="true" tabindex="-1"></a><span class="in">  width=8, height = 10, </span></span>
<span id="cb22-469"><a href="#cb22-469" aria-hidden="true" tabindex="-1"></a><span class="in">  path=here::here("fig/")</span></span>
<span id="cb22-470"><a href="#cb22-470" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-471"><a href="#cb22-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-472"><a href="#cb22-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-473"><a href="#cb22-473" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prior predictive check</span></span>
<span id="cb22-474"><a href="#cb22-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-475"><a href="#cb22-475" aria-hidden="true" tabindex="-1"></a>In bayesian modeling, we first perform a prior predictive check before fitting the model to our data. This allows us to check on the rationnality of the chosen priors.</span>
<span id="cb22-476"><a href="#cb22-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-477"><a href="#cb22-477" aria-hidden="true" tabindex="-1"></a>Results of the model with the sampling of priors :</span>
<span id="cb22-478"><a href="#cb22-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-479"><a href="#cb22-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r priorcheck, warning=F, message=F}</span></span>
<span id="cb22-480"><a href="#cb22-480" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb22-481"><a href="#cb22-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-482"><a href="#cb22-482" aria-hidden="true" tabindex="-1"></a><span class="in">m.sim.prior &lt;- </span></span>
<span id="cb22-483"><a href="#cb22-483" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-484"><a href="#cb22-484" aria-hidden="true" tabindex="-1"></a><span class="in">  brm(</span></span>
<span id="cb22-485"><a href="#cb22-485" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_sim,                               # &lt;1&gt;</span></span>
<span id="cb22-486"><a href="#cb22-486" aria-hidden="true" tabindex="-1"></a><span class="in">    bf.mod,                                   # &lt;2&gt;</span></span>
<span id="cb22-487"><a href="#cb22-487" aria-hidden="true" tabindex="-1"></a><span class="in">    backend = "cmdstanr",                        # &lt;3&gt;</span></span>
<span id="cb22-488"><a href="#cb22-488" aria-hidden="true" tabindex="-1"></a><span class="in">    prior = priors,                              # &lt;4&gt;</span></span>
<span id="cb22-489"><a href="#cb22-489" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_prior = "only",                       # &lt;5&gt;</span></span>
<span id="cb22-490"><a href="#cb22-490" aria-hidden="true" tabindex="-1"></a><span class="in">    cores = 4,                                   # &lt;6&gt;</span></span>
<span id="cb22-491"><a href="#cb22-491" aria-hidden="true" tabindex="-1"></a><span class="in">    seed = 1212,                                 # &lt;7&gt;</span></span>
<span id="cb22-492"><a href="#cb22-492" aria-hidden="true" tabindex="-1"></a><span class="in">    iter = 1000, warmup = 500,                   # &lt;8&gt;</span></span>
<span id="cb22-493"><a href="#cb22-493" aria-hidden="true" tabindex="-1"></a><span class="in">    control = list(</span></span>
<span id="cb22-494"><a href="#cb22-494" aria-hidden="true" tabindex="-1"></a><span class="in">      adapt_delta = .95,                         # &lt;9&gt;</span></span>
<span id="cb22-495"><a href="#cb22-495" aria-hidden="true" tabindex="-1"></a><span class="in">      max_treedepth = 12                         # &lt;9&gt;</span></span>
<span id="cb22-496"><a href="#cb22-496" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb22-497"><a href="#cb22-497" aria-hidden="true" tabindex="-1"></a><span class="in">    file=here::here("mod/m_brms_prior_sim")   # &lt;10&gt;</span></span>
<span id="cb22-498"><a href="#cb22-498" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-499"><a href="#cb22-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-500"><a href="#cb22-500" aria-hidden="true" tabindex="-1"></a><span class="in">print(m.sim.prior)</span></span>
<span id="cb22-501"><a href="#cb22-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-502"><a href="#cb22-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-503"><a href="#cb22-503" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Data used</span>
<span id="cb22-504"><a href="#cb22-504" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Model to be used</span>
<span id="cb22-505"><a href="#cb22-505" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Type of backend for calculations</span>
<span id="cb22-506"><a href="#cb22-506" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Priors to be used</span>
<span id="cb22-507"><a href="#cb22-507" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Work only done with priors and not the data</span>
<span id="cb22-508"><a href="#cb22-508" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Cores for calculations</span>
<span id="cb22-509"><a href="#cb22-509" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Seed for reproducibility</span>
<span id="cb22-510"><a href="#cb22-510" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>A total of 1000 interations are done with 500 that are part of the warmup phase</span>
<span id="cb22-511"><a href="#cb22-511" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>Control parameters on the iterations</span>
<span id="cb22-512"><a href="#cb22-512" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Path where the model results are saved</span>
<span id="cb22-513"><a href="#cb22-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-514"><a href="#cb22-514" aria-hidden="true" tabindex="-1"></a>We can then plot the predictions of this model and see if they represent at least the full range of our experimental data.</span>
<span id="cb22-515"><a href="#cb22-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-516"><a href="#cb22-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r priorpredcheck, warning=F}</span></span>
<span id="cb22-517"><a href="#cb22-517" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Prior predictive check.Fresh body weight of simulated non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed every 28 days (red points and thin lines, each line corresponding to one individual). Colored ribbons correspond to the different credibility intervals for the mean growth for each cohort under the prior distribution. The thicker black lines represent the predicted mean body weight based solely on prior assumptions.</span></span>
<span id="cb22-518"><a href="#cb22-518" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-priorpredVIsim</span></span>
<span id="cb22-519"><a href="#cb22-519" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 4</span></span>
<span id="cb22-520"><a href="#cb22-520" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 8</span></span>
<span id="cb22-521"><a href="#cb22-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-522"><a href="#cb22-522" aria-hidden="true" tabindex="-1"></a><span class="in">pred &lt;- predicted_draws(m.sim.prior, newdata=df_sim) # &lt;1&gt; </span></span>
<span id="cb22-523"><a href="#cb22-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-524"><a href="#cb22-524" aria-hidden="true" tabindex="-1"></a><span class="in">y_max &lt;- 500</span></span>
<span id="cb22-525"><a href="#cb22-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-526"><a href="#cb22-526" aria-hidden="true" tabindex="-1"></a><span class="in">p_ctrl &lt;- ggplot()+</span></span>
<span id="cb22-527"><a href="#cb22-527" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-528"><a href="#cb22-528" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_lineribbon(</span></span>
<span id="cb22-529"><a href="#cb22-529" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(pred, exposition == 0), </span></span>
<span id="cb22-530"><a href="#cb22-530" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y = .prediction^3, group = exposition),</span></span>
<span id="cb22-531"><a href="#cb22-531" aria-hidden="true" tabindex="-1"></a><span class="in">    .width=c(.99,.95,.8,.5),</span></span>
<span id="cb22-532"><a href="#cb22-532" aria-hidden="true" tabindex="-1"></a><span class="in">    color="black"</span></span>
<span id="cb22-533"><a href="#cb22-533" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-534"><a href="#cb22-534" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-535"><a href="#cb22-535" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_sim, exposition == 0),</span></span>
<span id="cb22-536"><a href="#cb22-536" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y = w, group=ID),</span></span>
<span id="cb22-537"><a href="#cb22-537" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "black",</span></span>
<span id="cb22-538"><a href="#cb22-538" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.4</span></span>
<span id="cb22-539"><a href="#cb22-539" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-540"><a href="#cb22-540" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb22-541"><a href="#cb22-541" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_sim, exposition == 0),</span></span>
<span id="cb22-542"><a href="#cb22-542" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y = w, group = ID),</span></span>
<span id="cb22-543"><a href="#cb22-543" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "black",</span></span>
<span id="cb22-544"><a href="#cb22-544" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.4</span></span>
<span id="cb22-545"><a href="#cb22-545" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-546"><a href="#cb22-546" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-547"><a href="#cb22-547" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = rev(pal_blue))+</span></span>
<span id="cb22-548"><a href="#cb22-548" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-549"><a href="#cb22-549" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y="Weight (mg)", x="Time (days)")+</span></span>
<span id="cb22-550"><a href="#cb22-550" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-551"><a href="#cb22-551" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(0, y_max)+</span></span>
<span id="cb22-552"><a href="#cb22-552" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-553"><a href="#cb22-553" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(</span></span>
<span id="cb22-554"><a href="#cb22-554" aria-hidden="true" tabindex="-1"></a><span class="in">    limits = c(0, 56),        </span></span>
<span id="cb22-555"><a href="#cb22-555" aria-hidden="true" tabindex="-1"></a><span class="in">    breaks = seq(0, 56, by = 28),        </span></span>
<span id="cb22-556"><a href="#cb22-556" aria-hidden="true" tabindex="-1"></a><span class="in">    minor_breaks = seq(0, 56, by = 14)</span></span>
<span id="cb22-557"><a href="#cb22-557" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-558"><a href="#cb22-558" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-559"><a href="#cb22-559" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal(14)+</span></span>
<span id="cb22-560"><a href="#cb22-560" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none")</span></span>
<span id="cb22-561"><a href="#cb22-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-562"><a href="#cb22-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-563"><a href="#cb22-563" aria-hidden="true" tabindex="-1"></a><span class="in">p_trt &lt;- ggplot()+</span></span>
<span id="cb22-564"><a href="#cb22-564" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-565"><a href="#cb22-565" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_lineribbon(</span></span>
<span id="cb22-566"><a href="#cb22-566" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(pred, exposition == 1),</span></span>
<span id="cb22-567"><a href="#cb22-567" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y=.prediction^3, group=exposition),</span></span>
<span id="cb22-568"><a href="#cb22-568" aria-hidden="true" tabindex="-1"></a><span class="in">    .width=c(.99,.95,.8,.5),</span></span>
<span id="cb22-569"><a href="#cb22-569" aria-hidden="true" tabindex="-1"></a><span class="in">    color="black"</span></span>
<span id="cb22-570"><a href="#cb22-570" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-571"><a href="#cb22-571" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb22-572"><a href="#cb22-572" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_sim, exposition == 1),</span></span>
<span id="cb22-573"><a href="#cb22-573" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y = w, group = ID),</span></span>
<span id="cb22-574"><a href="#cb22-574" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "black",</span></span>
<span id="cb22-575"><a href="#cb22-575" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.4</span></span>
<span id="cb22-576"><a href="#cb22-576" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-577"><a href="#cb22-577" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-578"><a href="#cb22-578" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_sim, exposition == 1),</span></span>
<span id="cb22-579"><a href="#cb22-579" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y = w, group = ID),</span></span>
<span id="cb22-580"><a href="#cb22-580" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "black",</span></span>
<span id="cb22-581"><a href="#cb22-581" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.4</span></span>
<span id="cb22-582"><a href="#cb22-582" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-583"><a href="#cb22-583" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-584"><a href="#cb22-584" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = rev(pal_red))+</span></span>
<span id="cb22-585"><a href="#cb22-585" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-586"><a href="#cb22-586" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y="Weight (mg)", x="Time (days)")+</span></span>
<span id="cb22-587"><a href="#cb22-587" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-588"><a href="#cb22-588" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(0, y_max)+</span></span>
<span id="cb22-589"><a href="#cb22-589" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(</span></span>
<span id="cb22-590"><a href="#cb22-590" aria-hidden="true" tabindex="-1"></a><span class="in">    limits = c(0, 56),        </span></span>
<span id="cb22-591"><a href="#cb22-591" aria-hidden="true" tabindex="-1"></a><span class="in">    breaks = seq(0, 56, by = 28),        </span></span>
<span id="cb22-592"><a href="#cb22-592" aria-hidden="true" tabindex="-1"></a><span class="in">    minor_breaks = seq(0, 56, by = 14)</span></span>
<span id="cb22-593"><a href="#cb22-593" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-594"><a href="#cb22-594" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-595"><a href="#cb22-595" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal(14)+</span></span>
<span id="cb22-596"><a href="#cb22-596" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none")</span></span>
<span id="cb22-597"><a href="#cb22-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-598"><a href="#cb22-598" aria-hidden="true" tabindex="-1"></a><span class="in">plot.prior_pred &lt;- p_ctrl + p_trt + </span></span>
<span id="cb22-599"><a href="#cb22-599" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(ncol = 2, guides = "collect") &amp; </span></span>
<span id="cb22-600"><a href="#cb22-600" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-601"><a href="#cb22-601" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "right", </span></span>
<span id="cb22-602"><a href="#cb22-602" aria-hidden="true" tabindex="-1"></a><span class="in">    title=element_text(face="bold"), </span></span>
<span id="cb22-603"><a href="#cb22-603" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.x = element_text(face="plain"),</span></span>
<span id="cb22-604"><a href="#cb22-604" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.y = element_text(face="plain")</span></span>
<span id="cb22-605"><a href="#cb22-605" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-606"><a href="#cb22-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-607"><a href="#cb22-607" aria-hidden="true" tabindex="-1"></a><span class="in">plot.prior_pred</span></span>
<span id="cb22-608"><a href="#cb22-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-609"><a href="#cb22-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-610"><a href="#cb22-610" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Predictions from the model</span>
<span id="cb22-611"><a href="#cb22-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-612"><a href="#cb22-612" aria-hidden="true" tabindex="-1"></a>The @fig-priorpredVIsim shows the chosen priors are realistic.</span>
<span id="cb22-613"><a href="#cb22-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-614"><a href="#cb22-614" aria-hidden="true" tabindex="-1"></a>The prior sensitivity of our model is explored @sec-Fpriorsens.</span>
<span id="cb22-615"><a href="#cb22-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-616"><a href="#cb22-616" aria-hidden="true" tabindex="-1"></a><span class="fu">### Posterior predictive check</span></span>
<span id="cb22-617"><a href="#cb22-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-618"><a href="#cb22-618" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model fit</span></span>
<span id="cb22-619"><a href="#cb22-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-620"><a href="#cb22-620" aria-hidden="true" tabindex="-1"></a>We can now fit the model to our simulated data.</span>
<span id="cb22-621"><a href="#cb22-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-622"><a href="#cb22-622" aria-hidden="true" tabindex="-1"></a><span class="in">```{r modrun, warning=F, message=F}</span></span>
<span id="cb22-623"><a href="#cb22-623" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb22-624"><a href="#cb22-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-625"><a href="#cb22-625" aria-hidden="true" tabindex="-1"></a><span class="in">m.sim.post &lt;-</span></span>
<span id="cb22-626"><a href="#cb22-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-627"><a href="#cb22-627" aria-hidden="true" tabindex="-1"></a><span class="in">  brm(</span></span>
<span id="cb22-628"><a href="#cb22-628" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_sim,                                 # &lt;1&gt;</span></span>
<span id="cb22-629"><a href="#cb22-629" aria-hidden="true" tabindex="-1"></a><span class="in">    bf.mod,                                        # &lt;2&gt;</span></span>
<span id="cb22-630"><a href="#cb22-630" aria-hidden="true" tabindex="-1"></a><span class="in">    backend = "cmdstanr",                          # &lt;3&gt;</span></span>
<span id="cb22-631"><a href="#cb22-631" aria-hidden="true" tabindex="-1"></a><span class="in">    prior = priors,                                # &lt;4&gt;</span></span>
<span id="cb22-632"><a href="#cb22-632" aria-hidden="true" tabindex="-1"></a><span class="in">    save_pars = save_pars(all = TRUE),             # &lt;5&gt;</span></span>
<span id="cb22-633"><a href="#cb22-633" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_prior = "yes",                          # &lt;6&gt;</span></span>
<span id="cb22-634"><a href="#cb22-634" aria-hidden="true" tabindex="-1"></a><span class="in">    seed = 12121212,                               # &lt;7&gt;</span></span>
<span id="cb22-635"><a href="#cb22-635" aria-hidden="true" tabindex="-1"></a><span class="in">    chains = 4, cores = 4,                         # &lt;8&gt;</span></span>
<span id="cb22-636"><a href="#cb22-636" aria-hidden="true" tabindex="-1"></a><span class="in">    iter = 6000, warmup = 1000,                    # &lt;9&gt;</span></span>
<span id="cb22-637"><a href="#cb22-637" aria-hidden="true" tabindex="-1"></a><span class="in">    control = list(adapt_delta = .95,              # &lt;10&gt;</span></span>
<span id="cb22-638"><a href="#cb22-638" aria-hidden="true" tabindex="-1"></a><span class="in">    max_treedepth = 12),                           # &lt;10&gt;</span></span>
<span id="cb22-639"><a href="#cb22-639" aria-hidden="true" tabindex="-1"></a><span class="in">    file=here::here("mod/m_brms_post_sim")      # &lt;11&gt;</span></span>
<span id="cb22-640"><a href="#cb22-640" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-641"><a href="#cb22-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-642"><a href="#cb22-642" aria-hidden="true" tabindex="-1"></a><span class="in">print(m.sim.post)</span></span>
<span id="cb22-643"><a href="#cb22-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-644"><a href="#cb22-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-645"><a href="#cb22-645" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Data used</span>
<span id="cb22-646"><a href="#cb22-646" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Model to be used</span>
<span id="cb22-647"><a href="#cb22-647" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Type of backend for calculations</span>
<span id="cb22-648"><a href="#cb22-648" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Priors to be used</span>
<span id="cb22-649"><a href="#cb22-649" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>We want all parameters to be saved</span>
<span id="cb22-650"><a href="#cb22-650" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Work done with priors and the data</span>
<span id="cb22-651"><a href="#cb22-651" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Number of chains and cores for calculations</span>
<span id="cb22-652"><a href="#cb22-652" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Seed for reproducibility</span>
<span id="cb22-653"><a href="#cb22-653" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>A total of 6000 interations are done with 1000 that are part of the warmup phase</span>
<span id="cb22-654"><a href="#cb22-654" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Control parameters on the iterations</span>
<span id="cb22-655"><a href="#cb22-655" aria-hidden="true" tabindex="-1"></a><span class="ss">11. </span>Path where the model results are saved</span>
<span id="cb22-656"><a href="#cb22-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-657"><a href="#cb22-657" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameter estimation results</span></span>
<span id="cb22-658"><a href="#cb22-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-659"><a href="#cb22-659" aria-hidden="true" tabindex="-1"></a>Chains recuperation and calculation of additional parameters :</span>
<span id="cb22-660"><a href="#cb22-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-661"><a href="#cb22-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chains}</span></span>
<span id="cb22-662"><a href="#cb22-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-663"><a href="#cb22-663" aria-hidden="true" tabindex="-1"></a><span class="in">df_chains &lt;- ggs(m.sim.post, burnin = T) |&gt;                     # &lt;1&gt;</span></span>
<span id="cb22-664"><a href="#cb22-664" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Parameter %in% List_parameters) |&gt;                     # &lt;1&gt;</span></span>
<span id="cb22-665"><a href="#cb22-665" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(                                                       # &lt;1&gt;</span></span>
<span id="cb22-666"><a href="#cb22-666" aria-hidden="true" tabindex="-1"></a><span class="in">    Chain=as.factor(Chain),                                     # &lt;1&gt;</span></span>
<span id="cb22-667"><a href="#cb22-667" aria-hidden="true" tabindex="-1"></a><span class="in">    value=value                                                 # &lt;1&gt;</span></span>
<span id="cb22-668"><a href="#cb22-668" aria-hidden="true" tabindex="-1"></a><span class="in">    )                                                           # &lt;1&gt;</span></span>
<span id="cb22-669"><a href="#cb22-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-670"><a href="#cb22-670" aria-hidden="true" tabindex="-1"></a><span class="in">df_chains_post &lt;- df_chains |&gt;                                  # &lt;2&gt;</span></span>
<span id="cb22-671"><a href="#cb22-671" aria-hidden="true" tabindex="-1"></a><span class="in"> filter(Iteration&gt;1000)                                         # &lt;2&gt;</span></span>
<span id="cb22-672"><a href="#cb22-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-673"><a href="#cb22-673" aria-hidden="true" tabindex="-1"></a><span class="in">df_chains_median &lt;- df_chains_post |&gt;                           # &lt;3&gt;</span></span>
<span id="cb22-674"><a href="#cb22-674" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(value ~ Parameter, median) |&gt;                       # &lt;3&gt;</span></span>
<span id="cb22-675"><a href="#cb22-675" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(median = value)                                        # &lt;3&gt;</span></span>
<span id="cb22-676"><a href="#cb22-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-677"><a href="#cb22-677" aria-hidden="true" tabindex="-1"></a><span class="in">df_chains_post_large &lt;-                                         # &lt;4&gt;</span></span>
<span id="cb22-678"><a href="#cb22-678" aria-hidden="true" tabindex="-1"></a><span class="in">  dcast(                                                        # &lt;4&gt;</span></span>
<span id="cb22-679"><a href="#cb22-679" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_chains_post,                                      # &lt;4&gt;</span></span>
<span id="cb22-680"><a href="#cb22-680" aria-hidden="true" tabindex="-1"></a><span class="in">    formula = Iteration + Chain ~ Parameter,                    # &lt;4&gt;</span></span>
<span id="cb22-681"><a href="#cb22-681" aria-hidden="true" tabindex="-1"></a><span class="in">    value.var = 'value'                                         # &lt;4&gt;</span></span>
<span id="cb22-682"><a href="#cb22-682" aria-hidden="true" tabindex="-1"></a><span class="in">  )                                                             # &lt;4&gt;</span></span>
<span id="cb22-683"><a href="#cb22-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-684"><a href="#cb22-684" aria-hidden="true" tabindex="-1"></a><span class="in">df_chains_post_large &lt;- df_chains_post_large |&gt;                 # &lt;4&gt;</span></span>
<span id="cb22-685"><a href="#cb22-685" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(                                                       # &lt;4&gt;</span></span>
<span id="cb22-686"><a href="#cb22-686" aria-hidden="true" tabindex="-1"></a><span class="in">    Delta_a_mu = b_a_exposition1-b_a_exposition0,               # &lt;4&gt;</span></span>
<span id="cb22-687"><a href="#cb22-687" aria-hidden="true" tabindex="-1"></a><span class="in">    Ratio_a_mu = b_a_exposition1/b_a_exposition0,               # &lt;4&gt;</span></span>
<span id="cb22-688"><a href="#cb22-688" aria-hidden="true" tabindex="-1"></a><span class="in">    Delta_a_sd = sd_ID__a_exposition1-sd_ID__a_exposition0,     # &lt;4&gt;</span></span>
<span id="cb22-689"><a href="#cb22-689" aria-hidden="true" tabindex="-1"></a><span class="in">    Ratio_a_sd = sd_ID__a_exposition1/sd_ID__a_exposition0,     # &lt;4&gt;</span></span>
<span id="cb22-690"><a href="#cb22-690" aria-hidden="true" tabindex="-1"></a><span class="in">    LnRR = log(b_a_exposition1/b_a_exposition0),                # &lt;4&gt;</span></span>
<span id="cb22-691"><a href="#cb22-691" aria-hidden="true" tabindex="-1"></a><span class="in">    LnCVi = log((sd_ID__a_exposition1/b_a_exposition1)/(sd_ID__a_exposition0/b_a_exposition0)) # &lt;4&gt;</span></span>
<span id="cb22-692"><a href="#cb22-692" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-693"><a href="#cb22-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-694"><a href="#cb22-694" aria-hidden="true" tabindex="-1"></a><span class="in">df_chains_post_long &lt;- df_chains_post_large |&gt;                  # &lt;4&gt;</span></span>
<span id="cb22-695"><a href="#cb22-695" aria-hidden="true" tabindex="-1"></a><span class="in">  melt(                                                         # &lt;4&gt;</span></span>
<span id="cb22-696"><a href="#cb22-696" aria-hidden="true" tabindex="-1"></a><span class="in">    id.vars=c("Iteration", "Chain"),                            # &lt;4&gt;</span></span>
<span id="cb22-697"><a href="#cb22-697" aria-hidden="true" tabindex="-1"></a><span class="in">    measure.vars=colnames(df_chains_post_large)[-c(1,2)],       # &lt;4&gt;</span></span>
<span id="cb22-698"><a href="#cb22-698" aria-hidden="true" tabindex="-1"></a><span class="in">    variable.name="Parameter",                                  # &lt;4&gt;</span></span>
<span id="cb22-699"><a href="#cb22-699" aria-hidden="true" tabindex="-1"></a><span class="in">    value.name="value"                                          # &lt;4&gt;</span></span>
<span id="cb22-700"><a href="#cb22-700" aria-hidden="true" tabindex="-1"></a><span class="in">  )                                                             # &lt;4&gt;</span></span>
<span id="cb22-701"><a href="#cb22-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-702"><a href="#cb22-702" aria-hidden="true" tabindex="-1"></a><span class="in">Param_a_mu &lt;- c(</span></span>
<span id="cb22-703"><a href="#cb22-703" aria-hidden="true" tabindex="-1"></a><span class="in">  "b_a_exposition0",</span></span>
<span id="cb22-704"><a href="#cb22-704" aria-hidden="true" tabindex="-1"></a><span class="in">  "b_a_exposition1"</span></span>
<span id="cb22-705"><a href="#cb22-705" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-706"><a href="#cb22-706" aria-hidden="true" tabindex="-1"></a><span class="in">Param_a_sd &lt;- c(</span></span>
<span id="cb22-707"><a href="#cb22-707" aria-hidden="true" tabindex="-1"></a><span class="in">  "sd_ID__a_exposition0",</span></span>
<span id="cb22-708"><a href="#cb22-708" aria-hidden="true" tabindex="-1"></a><span class="in">  "sd_ID__a_exposition1"</span></span>
<span id="cb22-709"><a href="#cb22-709" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-710"><a href="#cb22-710" aria-hidden="true" tabindex="-1"></a><span class="in">Param_ctrl &lt;- c(</span></span>
<span id="cb22-711"><a href="#cb22-711" aria-hidden="true" tabindex="-1"></a><span class="in">  "b_a_exposition0",</span></span>
<span id="cb22-712"><a href="#cb22-712" aria-hidden="true" tabindex="-1"></a><span class="in">  "sd_ID__a_exposition0"</span></span>
<span id="cb22-713"><a href="#cb22-713" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-714"><a href="#cb22-714" aria-hidden="true" tabindex="-1"></a><span class="in">Param_trt &lt;- c(</span></span>
<span id="cb22-715"><a href="#cb22-715" aria-hidden="true" tabindex="-1"></a><span class="in">  "b_a_exposition1",</span></span>
<span id="cb22-716"><a href="#cb22-716" aria-hidden="true" tabindex="-1"></a><span class="in">  "sd_ID__a_exposition1"</span></span>
<span id="cb22-717"><a href="#cb22-717" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-718"><a href="#cb22-718" aria-hidden="true" tabindex="-1"></a><span class="in">Param_t0 &lt;- c(</span></span>
<span id="cb22-719"><a href="#cb22-719" aria-hidden="true" tabindex="-1"></a><span class="in">  "b_L0_Intercept",</span></span>
<span id="cb22-720"><a href="#cb22-720" aria-hidden="true" tabindex="-1"></a><span class="in">  "sd_ID__L0_Intercept",</span></span>
<span id="cb22-721"><a href="#cb22-721" aria-hidden="true" tabindex="-1"></a><span class="in">  "Delta_a_mu",</span></span>
<span id="cb22-722"><a href="#cb22-722" aria-hidden="true" tabindex="-1"></a><span class="in">  "Delta_a_sd"</span></span>
<span id="cb22-723"><a href="#cb22-723" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-724"><a href="#cb22-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-725"><a href="#cb22-725" aria-hidden="true" tabindex="-1"></a><span class="in">df_chains_post_long &lt;- df_chains_post_long |&gt;</span></span>
<span id="cb22-726"><a href="#cb22-726" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb22-727"><a href="#cb22-727" aria-hidden="true" tabindex="-1"></a><span class="in">    exposition = case_when(</span></span>
<span id="cb22-728"><a href="#cb22-728" aria-hidden="true" tabindex="-1"></a><span class="in">      Parameter %in% Param_ctrl ~ "Non exposed",</span></span>
<span id="cb22-729"><a href="#cb22-729" aria-hidden="true" tabindex="-1"></a><span class="in">      Parameter %in% Param_trt ~ "Exposed",</span></span>
<span id="cb22-730"><a href="#cb22-730" aria-hidden="true" tabindex="-1"></a><span class="in">      Parameter %in% Param_t0 ~ "General")</span></span>
<span id="cb22-731"><a href="#cb22-731" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-732"><a href="#cb22-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-733"><a href="#cb22-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-734"><a href="#cb22-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-735"><a href="#cb22-735" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Extraction of each chain iterations values for each parameters</span>
<span id="cb22-736"><a href="#cb22-736" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Only iterations after the warmup phase</span>
<span id="cb22-737"><a href="#cb22-737" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Adding medians from each distribution</span>
<span id="cb22-738"><a href="#cb22-738" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Calculation delta and ratios between non-exposed and exposed individuals</span>
<span id="cb22-739"><a href="#cb22-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-740"><a href="#cb22-740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r comppriorpost}</span></span>
<span id="cb22-741"><a href="#cb22-741" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Prior (light grey) and posterior distributions for each parameter.</span></span>
<span id="cb22-742"><a href="#cb22-742" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-priorpost</span></span>
<span id="cb22-743"><a href="#cb22-743" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 12</span></span>
<span id="cb22-744"><a href="#cb22-744" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 12</span></span>
<span id="cb22-745"><a href="#cb22-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-746"><a href="#cb22-746" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_dens &lt;- 0.5</span></span>
<span id="cb22-747"><a href="#cb22-747" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_dens_prior &lt;- 0.2</span></span>
<span id="cb22-748"><a href="#cb22-748" aria-hidden="true" tabindex="-1"></a><span class="in">font_size &lt;- 12</span></span>
<span id="cb22-749"><a href="#cb22-749" aria-hidden="true" tabindex="-1"></a><span class="in">col_dens &lt;- Nord_polar[1]</span></span>
<span id="cb22-750"><a href="#cb22-750" aria-hidden="true" tabindex="-1"></a><span class="in">col_dens_ctrl &lt;- Nord_frost[4]</span></span>
<span id="cb22-751"><a href="#cb22-751" aria-hidden="true" tabindex="-1"></a><span class="in">col_dens_trt &lt;- col_red</span></span>
<span id="cb22-752"><a href="#cb22-752" aria-hidden="true" tabindex="-1"></a><span class="in">size_norm &lt;- 0.7</span></span>
<span id="cb22-753"><a href="#cb22-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-754"><a href="#cb22-754" aria-hidden="true" tabindex="-1"></a><span class="in">prior_L0_mu &lt;- priors %&gt;% </span></span>
<span id="cb22-755"><a href="#cb22-755" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-756"><a href="#cb22-756" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "b" &amp; nlpar == "L0")</span></span>
<span id="cb22-757"><a href="#cb22-757" aria-hidden="true" tabindex="-1"></a><span class="in">prior_L0_sd &lt;- priors %&gt;% </span></span>
<span id="cb22-758"><a href="#cb22-758" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-759"><a href="#cb22-759" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "sd" &amp; nlpar == "L0")</span></span>
<span id="cb22-760"><a href="#cb22-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-761"><a href="#cb22-761" aria-hidden="true" tabindex="-1"></a><span class="in">prior_a_ctrl_mu &lt;- priors %&gt;% </span></span>
<span id="cb22-762"><a href="#cb22-762" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-763"><a href="#cb22-763" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "b" &amp; nlpar == "a" &amp; coef == "exposition0")</span></span>
<span id="cb22-764"><a href="#cb22-764" aria-hidden="true" tabindex="-1"></a><span class="in">prior_a_ctrl_sd &lt;- priors %&gt;% </span></span>
<span id="cb22-765"><a href="#cb22-765" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-766"><a href="#cb22-766" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "sd" &amp; nlpar == "a" &amp; coef == "exposition0")</span></span>
<span id="cb22-767"><a href="#cb22-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-768"><a href="#cb22-768" aria-hidden="true" tabindex="-1"></a><span class="in">prior_a_trt_mu &lt;- priors %&gt;% </span></span>
<span id="cb22-769"><a href="#cb22-769" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-770"><a href="#cb22-770" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "b" &amp; nlpar == "a" &amp; coef == "exposition1")</span></span>
<span id="cb22-771"><a href="#cb22-771" aria-hidden="true" tabindex="-1"></a><span class="in">prior_a_trt_sd &lt;- priors %&gt;% </span></span>
<span id="cb22-772"><a href="#cb22-772" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-773"><a href="#cb22-773" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "sd" &amp; nlpar == "a" &amp; coef == "exposition1")</span></span>
<span id="cb22-774"><a href="#cb22-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-775"><a href="#cb22-775" aria-hidden="true" tabindex="-1"></a><span class="in">prior_sigma &lt;- priors %&gt;% </span></span>
<span id="cb22-776"><a href="#cb22-776" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() %&gt;% </span></span>
<span id="cb22-777"><a href="#cb22-777" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(class == "sigma")</span></span>
<span id="cb22-778"><a href="#cb22-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-779"><a href="#cb22-779" aria-hidden="true" tabindex="-1"></a><span class="in">plot_L0_mu &lt;-</span></span>
<span id="cb22-780"><a href="#cb22-780" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb22-781"><a href="#cb22-781" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-782"><a href="#cb22-782" aria-hidden="true" tabindex="-1"></a><span class="in">    data = prior_L0_mu,</span></span>
<span id="cb22-783"><a href="#cb22-783" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-784"><a href="#cb22-784" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj</span></span>
<span id="cb22-785"><a href="#cb22-785" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-786"><a href="#cb22-786" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-787"><a href="#cb22-787" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-788"><a href="#cb22-788" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens_prior</span></span>
<span id="cb22-789"><a href="#cb22-789" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-790"><a href="#cb22-790" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-791"><a href="#cb22-791" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_chains_post_long,Parameter == "b_L0_Intercept"),</span></span>
<span id="cb22-792"><a href="#cb22-792" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping = aes(</span></span>
<span id="cb22-793"><a href="#cb22-793" aria-hidden="true" tabindex="-1"></a><span class="in">      x=value,</span></span>
<span id="cb22-794"><a href="#cb22-794" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-795"><a href="#cb22-795" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-796"><a href="#cb22-796" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-797"><a href="#cb22-797" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-798"><a href="#cb22-798" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-799"><a href="#cb22-799" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-800"><a href="#cb22-800" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-801"><a href="#cb22-801" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density",</span></span>
<span id="cb22-802"><a href="#cb22-802" aria-hidden="true" tabindex="-1"></a><span class="in">    title = bquote(bold("Mean initial structural length " (mg^{1/3})))</span></span>
<span id="cb22-803"><a href="#cb22-803" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-804"><a href="#cb22-804" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-805"><a href="#cb22-805" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-806"><a href="#cb22-806" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-807"><a href="#cb22-807" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face = "bold")</span></span>
<span id="cb22-808"><a href="#cb22-808" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb22-809"><a href="#cb22-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-810"><a href="#cb22-810" aria-hidden="true" tabindex="-1"></a><span class="in">plot_L0_sd &lt;-</span></span>
<span id="cb22-811"><a href="#cb22-811" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb22-812"><a href="#cb22-812" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-813"><a href="#cb22-813" aria-hidden="true" tabindex="-1"></a><span class="in">    data = prior_L0_sd,</span></span>
<span id="cb22-814"><a href="#cb22-814" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-815"><a href="#cb22-815" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj</span></span>
<span id="cb22-816"><a href="#cb22-816" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-817"><a href="#cb22-817" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-818"><a href="#cb22-818" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-819"><a href="#cb22-819" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens_prior</span></span>
<span id="cb22-820"><a href="#cb22-820" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-821"><a href="#cb22-821" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-822"><a href="#cb22-822" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_chains_post_long,Parameter == "sd_ID__L0_Intercept"),</span></span>
<span id="cb22-823"><a href="#cb22-823" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping = aes(</span></span>
<span id="cb22-824"><a href="#cb22-824" aria-hidden="true" tabindex="-1"></a><span class="in">      x=value,</span></span>
<span id="cb22-825"><a href="#cb22-825" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-826"><a href="#cb22-826" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-827"><a href="#cb22-827" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-828"><a href="#cb22-828" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-829"><a href="#cb22-829" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-830"><a href="#cb22-830" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-831"><a href="#cb22-831" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-832"><a href="#cb22-832" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density",</span></span>
<span id="cb22-833"><a href="#cb22-833" aria-hidden="true" tabindex="-1"></a><span class="in">    title = bquote(bold("Individual variation of\ninitial structural length " (mg^{1/3})))</span></span>
<span id="cb22-834"><a href="#cb22-834" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-835"><a href="#cb22-835" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-836"><a href="#cb22-836" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-837"><a href="#cb22-837" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-838"><a href="#cb22-838" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face = "bold")</span></span>
<span id="cb22-839"><a href="#cb22-839" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb22-840"><a href="#cb22-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-841"><a href="#cb22-841" aria-hidden="true" tabindex="-1"></a><span class="in">plot_a_ctrl_mu &lt;-</span></span>
<span id="cb22-842"><a href="#cb22-842" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb22-843"><a href="#cb22-843" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-844"><a href="#cb22-844" aria-hidden="true" tabindex="-1"></a><span class="in">    data = prior_a_ctrl_mu,</span></span>
<span id="cb22-845"><a href="#cb22-845" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-846"><a href="#cb22-846" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj</span></span>
<span id="cb22-847"><a href="#cb22-847" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-848"><a href="#cb22-848" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-849"><a href="#cb22-849" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-850"><a href="#cb22-850" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens_prior</span></span>
<span id="cb22-851"><a href="#cb22-851" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-852"><a href="#cb22-852" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-853"><a href="#cb22-853" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_chains_post_long,Parameter == "b_a_exposition0"),</span></span>
<span id="cb22-854"><a href="#cb22-854" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping = aes(</span></span>
<span id="cb22-855"><a href="#cb22-855" aria-hidden="true" tabindex="-1"></a><span class="in">      x=value,</span></span>
<span id="cb22-856"><a href="#cb22-856" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-857"><a href="#cb22-857" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens_ctrl,</span></span>
<span id="cb22-858"><a href="#cb22-858" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens_ctrl,</span></span>
<span id="cb22-859"><a href="#cb22-859" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-860"><a href="#cb22-860" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-861"><a href="#cb22-861" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-862"><a href="#cb22-862" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-863"><a href="#cb22-863" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density",</span></span>
<span id="cb22-864"><a href="#cb22-864" aria-hidden="true" tabindex="-1"></a><span class="in">    title = bquote(bold("Mean growth rate " (mg^{1/3}/d))),</span></span>
<span id="cb22-865"><a href="#cb22-865" aria-hidden="true" tabindex="-1"></a><span class="in">    subtitle = "Non-exposed"</span></span>
<span id="cb22-866"><a href="#cb22-866" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-867"><a href="#cb22-867" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-868"><a href="#cb22-868" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-869"><a href="#cb22-869" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-870"><a href="#cb22-870" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face = "bold")</span></span>
<span id="cb22-871"><a href="#cb22-871" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb22-872"><a href="#cb22-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-873"><a href="#cb22-873" aria-hidden="true" tabindex="-1"></a><span class="in">plot_a_trt_mu &lt;-</span></span>
<span id="cb22-874"><a href="#cb22-874" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb22-875"><a href="#cb22-875" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-876"><a href="#cb22-876" aria-hidden="true" tabindex="-1"></a><span class="in">    data = prior_a_trt_mu,</span></span>
<span id="cb22-877"><a href="#cb22-877" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-878"><a href="#cb22-878" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj</span></span>
<span id="cb22-879"><a href="#cb22-879" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-880"><a href="#cb22-880" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-881"><a href="#cb22-881" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-882"><a href="#cb22-882" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens_prior</span></span>
<span id="cb22-883"><a href="#cb22-883" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-884"><a href="#cb22-884" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-885"><a href="#cb22-885" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_chains_post_long,Parameter == "b_a_exposition1"),</span></span>
<span id="cb22-886"><a href="#cb22-886" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping = aes(</span></span>
<span id="cb22-887"><a href="#cb22-887" aria-hidden="true" tabindex="-1"></a><span class="in">      x=value,</span></span>
<span id="cb22-888"><a href="#cb22-888" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-889"><a href="#cb22-889" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens_trt,</span></span>
<span id="cb22-890"><a href="#cb22-890" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens_trt,</span></span>
<span id="cb22-891"><a href="#cb22-891" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-892"><a href="#cb22-892" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-893"><a href="#cb22-893" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-894"><a href="#cb22-894" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-895"><a href="#cb22-895" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density",</span></span>
<span id="cb22-896"><a href="#cb22-896" aria-hidden="true" tabindex="-1"></a><span class="in">    title = bquote(bold("Mean growth rate " (mg^{1/3}/d))),</span></span>
<span id="cb22-897"><a href="#cb22-897" aria-hidden="true" tabindex="-1"></a><span class="in">    subtitle = "Exposed"</span></span>
<span id="cb22-898"><a href="#cb22-898" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-899"><a href="#cb22-899" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-900"><a href="#cb22-900" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-901"><a href="#cb22-901" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-902"><a href="#cb22-902" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face = "bold")</span></span>
<span id="cb22-903"><a href="#cb22-903" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb22-904"><a href="#cb22-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-905"><a href="#cb22-905" aria-hidden="true" tabindex="-1"></a><span class="in">plot_a_ctrl_sd &lt;-</span></span>
<span id="cb22-906"><a href="#cb22-906" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb22-907"><a href="#cb22-907" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-908"><a href="#cb22-908" aria-hidden="true" tabindex="-1"></a><span class="in">    data = prior_a_ctrl_sd,</span></span>
<span id="cb22-909"><a href="#cb22-909" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-910"><a href="#cb22-910" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj</span></span>
<span id="cb22-911"><a href="#cb22-911" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-912"><a href="#cb22-912" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-913"><a href="#cb22-913" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-914"><a href="#cb22-914" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens_prior</span></span>
<span id="cb22-915"><a href="#cb22-915" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-916"><a href="#cb22-916" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-917"><a href="#cb22-917" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_chains_post_long,Parameter == "sd_ID__a_exposition0"),</span></span>
<span id="cb22-918"><a href="#cb22-918" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping = aes(</span></span>
<span id="cb22-919"><a href="#cb22-919" aria-hidden="true" tabindex="-1"></a><span class="in">      x=value,</span></span>
<span id="cb22-920"><a href="#cb22-920" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-921"><a href="#cb22-921" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens_ctrl,</span></span>
<span id="cb22-922"><a href="#cb22-922" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens_ctrl,</span></span>
<span id="cb22-923"><a href="#cb22-923" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-924"><a href="#cb22-924" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-925"><a href="#cb22-925" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-926"><a href="#cb22-926" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-927"><a href="#cb22-927" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density",</span></span>
<span id="cb22-928"><a href="#cb22-928" aria-hidden="true" tabindex="-1"></a><span class="in">    title = bquote(bold("Inter-individual variation\nof growth rate " (mg^{1/3}/d))),</span></span>
<span id="cb22-929"><a href="#cb22-929" aria-hidden="true" tabindex="-1"></a><span class="in">    subtitle = "Non-exposed"</span></span>
<span id="cb22-930"><a href="#cb22-930" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-931"><a href="#cb22-931" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-932"><a href="#cb22-932" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-933"><a href="#cb22-933" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-934"><a href="#cb22-934" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face = "bold")</span></span>
<span id="cb22-935"><a href="#cb22-935" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb22-936"><a href="#cb22-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-937"><a href="#cb22-937" aria-hidden="true" tabindex="-1"></a><span class="in">plot_a_trt_sd &lt;-</span></span>
<span id="cb22-938"><a href="#cb22-938" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb22-939"><a href="#cb22-939" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-940"><a href="#cb22-940" aria-hidden="true" tabindex="-1"></a><span class="in">    data = prior_a_trt_sd,</span></span>
<span id="cb22-941"><a href="#cb22-941" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-942"><a href="#cb22-942" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj</span></span>
<span id="cb22-943"><a href="#cb22-943" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-944"><a href="#cb22-944" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-945"><a href="#cb22-945" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-946"><a href="#cb22-946" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens_prior</span></span>
<span id="cb22-947"><a href="#cb22-947" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-948"><a href="#cb22-948" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-949"><a href="#cb22-949" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_chains_post_long,Parameter == "sd_ID__a_exposition1"),</span></span>
<span id="cb22-950"><a href="#cb22-950" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping = aes(</span></span>
<span id="cb22-951"><a href="#cb22-951" aria-hidden="true" tabindex="-1"></a><span class="in">      x=value,</span></span>
<span id="cb22-952"><a href="#cb22-952" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-953"><a href="#cb22-953" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens_trt,</span></span>
<span id="cb22-954"><a href="#cb22-954" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens_trt,</span></span>
<span id="cb22-955"><a href="#cb22-955" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-956"><a href="#cb22-956" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-957"><a href="#cb22-957" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-958"><a href="#cb22-958" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-959"><a href="#cb22-959" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density",</span></span>
<span id="cb22-960"><a href="#cb22-960" aria-hidden="true" tabindex="-1"></a><span class="in">    title = bquote(bold("Inter-individual variation\nof growth rate " (mg^{1/3}/d))),</span></span>
<span id="cb22-961"><a href="#cb22-961" aria-hidden="true" tabindex="-1"></a><span class="in">    subtitle = "Exposed"</span></span>
<span id="cb22-962"><a href="#cb22-962" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-963"><a href="#cb22-963" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-964"><a href="#cb22-964" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-965"><a href="#cb22-965" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-966"><a href="#cb22-966" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face = "bold")</span></span>
<span id="cb22-967"><a href="#cb22-967" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb22-968"><a href="#cb22-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-969"><a href="#cb22-969" aria-hidden="true" tabindex="-1"></a><span class="in">plot_sigma &lt;-</span></span>
<span id="cb22-970"><a href="#cb22-970" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot() +</span></span>
<span id="cb22-971"><a href="#cb22-971" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_dist_halfeye(</span></span>
<span id="cb22-972"><a href="#cb22-972" aria-hidden="true" tabindex="-1"></a><span class="in">    data = prior_sigma,</span></span>
<span id="cb22-973"><a href="#cb22-973" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-974"><a href="#cb22-974" aria-hidden="true" tabindex="-1"></a><span class="in">      xdist = .dist_obj</span></span>
<span id="cb22-975"><a href="#cb22-975" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-976"><a href="#cb22-976" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-977"><a href="#cb22-977" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-978"><a href="#cb22-978" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens_prior</span></span>
<span id="cb22-979"><a href="#cb22-979" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-980"><a href="#cb22-980" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-981"><a href="#cb22-981" aria-hidden="true" tabindex="-1"></a><span class="in">    data = subset(df_chains_post_long,Parameter == "sigma"),</span></span>
<span id="cb22-982"><a href="#cb22-982" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping = aes(</span></span>
<span id="cb22-983"><a href="#cb22-983" aria-hidden="true" tabindex="-1"></a><span class="in">      x=value,</span></span>
<span id="cb22-984"><a href="#cb22-984" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-985"><a href="#cb22-985" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_dens,</span></span>
<span id="cb22-986"><a href="#cb22-986" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_dens,</span></span>
<span id="cb22-987"><a href="#cb22-987" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = alpha_dens</span></span>
<span id="cb22-988"><a href="#cb22-988" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-989"><a href="#cb22-989" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-990"><a href="#cb22-990" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Value",</span></span>
<span id="cb22-991"><a href="#cb22-991" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Density",</span></span>
<span id="cb22-992"><a href="#cb22-992" aria-hidden="true" tabindex="-1"></a><span class="in">    title = bquote(bold("Residual variance" (mg^{1/3})))</span></span>
<span id="cb22-993"><a href="#cb22-993" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-994"><a href="#cb22-994" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-995"><a href="#cb22-995" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-996"><a href="#cb22-996" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_text(angle = 90),</span></span>
<span id="cb22-997"><a href="#cb22-997" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.title = element_text(face = "bold")</span></span>
<span id="cb22-998"><a href="#cb22-998" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb22-999"><a href="#cb22-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1000"><a href="#cb22-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1001"><a href="#cb22-1001" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- (plot_L0_mu+ plot_a_ctrl_mu + plot_a_trt_mu)/(plot_L0_sd + plot_a_ctrl_sd   + plot_a_trt_sd) / plot_sigma </span></span>
<span id="cb22-1002"><a href="#cb22-1002" aria-hidden="true" tabindex="-1"></a><span class="in">p</span></span>
<span id="cb22-1003"><a href="#cb22-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1004"><a href="#cb22-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1005"><a href="#cb22-1005" aria-hidden="true" tabindex="-1"></a>Parameters estimation results :</span>
<span id="cb22-1006"><a href="#cb22-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1007"><a href="#cb22-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tableres}</span></span>
<span id="cb22-1008"><a href="#cb22-1008" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: Different statistical values of the posterior distributions</span></span>
<span id="cb22-1009"><a href="#cb22-1009" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-compvalposttheoVI</span></span>
<span id="cb22-1010"><a href="#cb22-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1011"><a href="#cb22-1011" aria-hidden="true" tabindex="-1"></a><span class="in">df_res_VI &lt;- summarise_draws(tidy_draws(m.sim.post))</span></span>
<span id="cb22-1012"><a href="#cb22-1012" aria-hidden="true" tabindex="-1"></a><span class="in">df_res_VI_show &lt;- df_res_VI[1:7,]</span></span>
<span id="cb22-1013"><a href="#cb22-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1014"><a href="#cb22-1014" aria-hidden="true" tabindex="-1"></a><span class="in">df_res_VI_show |&gt; datatable(</span></span>
<span id="cb22-1015"><a href="#cb22-1015" aria-hidden="true" tabindex="-1"></a><span class="in">  options = list(</span></span>
<span id="cb22-1016"><a href="#cb22-1016" aria-hidden="true" tabindex="-1"></a><span class="in">    dom = 't',</span></span>
<span id="cb22-1017"><a href="#cb22-1017" aria-hidden="true" tabindex="-1"></a><span class="in">    columnDefs = list(</span></span>
<span id="cb22-1018"><a href="#cb22-1018" aria-hidden="true" tabindex="-1"></a><span class="in">      list(className = 'dt-left', targets = "_all")</span></span>
<span id="cb22-1019"><a href="#cb22-1019" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb22-1020"><a href="#cb22-1020" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-1021"><a href="#cb22-1021" aria-hidden="true" tabindex="-1"></a><span class="in">  class="hover"</span></span>
<span id="cb22-1022"><a href="#cb22-1022" aria-hidden="true" tabindex="-1"></a><span class="in">  ) |&gt;</span></span>
<span id="cb22-1023"><a href="#cb22-1023" aria-hidden="true" tabindex="-1"></a><span class="in">  formatRound(columns = 2:length(df_res_VI_show), digits = 2)</span></span>
<span id="cb22-1024"><a href="#cb22-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1025"><a href="#cb22-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1026"><a href="#cb22-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lnRRCVI}</span></span>
<span id="cb22-1027"><a href="#cb22-1027" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: Effect size results</span></span>
<span id="cb22-1028"><a href="#cb22-1028" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-lnRRCVI</span></span>
<span id="cb22-1029"><a href="#cb22-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1030"><a href="#cb22-1030" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculation of the results for Ln(RR) and Ln(CVi)</span></span>
<span id="cb22-1031"><a href="#cb22-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1032"><a href="#cb22-1032" aria-hidden="true" tabindex="-1"></a><span class="in">Median_LnRR &lt;- median(subset(df_chains_post_long, Parameter=="LnRR")$value)</span></span>
<span id="cb22-1033"><a href="#cb22-1033" aria-hidden="true" tabindex="-1"></a><span class="in">Median_LnCVi &lt;- median(subset(df_chains_post_long, Parameter=="LnCVi")$value)</span></span>
<span id="cb22-1034"><a href="#cb22-1034" aria-hidden="true" tabindex="-1"></a><span class="in">Median_LnRR_print &lt;- round(Median_LnRR, 2)</span></span>
<span id="cb22-1035"><a href="#cb22-1035" aria-hidden="true" tabindex="-1"></a><span class="in">Median_LnCVi_print &lt;- round(Median_LnCVi, 2)</span></span>
<span id="cb22-1036"><a href="#cb22-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1037"><a href="#cb22-1037" aria-hidden="true" tabindex="-1"></a><span class="in">Median_Ratio_a_mu &lt;- median(subset(df_chains_post_long, Parameter=="Ratio_a_mu")$value)</span></span>
<span id="cb22-1038"><a href="#cb22-1038" aria-hidden="true" tabindex="-1"></a><span class="in">Median_Ratio_a_sd &lt;- median(subset(df_chains_post_long, Parameter=="Ratio_a_sd")$value)</span></span>
<span id="cb22-1039"><a href="#cb22-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1040"><a href="#cb22-1040" aria-hidden="true" tabindex="-1"></a><span class="in">CI_Ratio_a_mu &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter=="Ratio_a_mu")$value, method = "ETI", ci = 0.90)</span></span>
<span id="cb22-1041"><a href="#cb22-1041" aria-hidden="true" tabindex="-1"></a><span class="in">CI_Ratio_a_mu_p &lt;- paste("[", round(CI_Ratio_a_mu$CI_low,2), " ; ", round(CI_Ratio_a_mu$CI_high,2), "]", sep="")</span></span>
<span id="cb22-1042"><a href="#cb22-1042" aria-hidden="true" tabindex="-1"></a><span class="in">CI_Ratio_a_sd &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter=="Ratio_a_sd")$value, method = "ETI", ci = 0.90)</span></span>
<span id="cb22-1043"><a href="#cb22-1043" aria-hidden="true" tabindex="-1"></a><span class="in">CI_Ratio_a_sd_p &lt;- paste("[", round(CI_Ratio_a_sd$CI_low,2), " ; ", round(CI_Ratio_a_sd$CI_high,2), "]", sep="")</span></span>
<span id="cb22-1044"><a href="#cb22-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1045"><a href="#cb22-1045" aria-hidden="true" tabindex="-1"></a><span class="in">CI_LnRR &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter=="LnRR")$value, method = "ETI", ci = 0.90)</span></span>
<span id="cb22-1046"><a href="#cb22-1046" aria-hidden="true" tabindex="-1"></a><span class="in">CI_LnRR_p &lt;- paste("[", round(CI_LnRR$CI_low,2), " ; ", round(CI_LnRR$CI_high,2), "]", sep="")</span></span>
<span id="cb22-1047"><a href="#cb22-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1048"><a href="#cb22-1048" aria-hidden="true" tabindex="-1"></a><span class="in">CI_LnCVi &lt;- bayestestR::ci(subset(df_chains_post_long, Parameter=="LnCVi")$value, ci = 0.90)</span></span>
<span id="cb22-1049"><a href="#cb22-1049" aria-hidden="true" tabindex="-1"></a><span class="in">CI_LnCVi_p &lt;- paste("[", round(CI_LnCVi$CI_low,2), " ; ", round(CI_LnCVi$CI_high,2), "]", sep="")</span></span>
<span id="cb22-1050"><a href="#cb22-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1051"><a href="#cb22-1051" aria-hidden="true" tabindex="-1"></a><span class="in">pd_LnRR &lt;- p_direction(subset(df_chains_post_long, Parameter=="LnRR")$value)</span></span>
<span id="cb22-1052"><a href="#cb22-1052" aria-hidden="true" tabindex="-1"></a><span class="in">pd_LnCVi &lt;- p_direction(subset(df_chains_post_long, Parameter=="LnCVi")$value)</span></span>
<span id="cb22-1053"><a href="#cb22-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1054"><a href="#cb22-1054" aria-hidden="true" tabindex="-1"></a><span class="in">pd_Ratio_a_mu &lt;- p_direction(subset(df_chains_post_long, Parameter=="Ratio_a_mu")$value)</span></span>
<span id="cb22-1055"><a href="#cb22-1055" aria-hidden="true" tabindex="-1"></a><span class="in">pd_Ratio_a_sd &lt;- p_direction(subset(df_chains_post_long, Parameter=="Ratio_a_sd")$value)</span></span>
<span id="cb22-1056"><a href="#cb22-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1057"><a href="#cb22-1057" aria-hidden="true" tabindex="-1"></a><span class="in">df_res_Ln &lt;- data.frame(</span></span>
<span id="cb22-1058"><a href="#cb22-1058" aria-hidden="true" tabindex="-1"></a><span class="in">  Variable = c("LnRR", "LnCVi", "Ratio a_mu", "Ratio a_sd"),</span></span>
<span id="cb22-1059"><a href="#cb22-1059" aria-hidden="true" tabindex="-1"></a><span class="in">  Median = c(Median_LnRR, Median_LnCVi, Median_Ratio_a_mu, Median_Ratio_a_sd),</span></span>
<span id="cb22-1060"><a href="#cb22-1060" aria-hidden="true" tabindex="-1"></a><span class="in">  CI = c(CI_LnRR_p, CI_LnCVi_p, CI_Ratio_a_mu_p, CI_Ratio_a_sd_p),</span></span>
<span id="cb22-1061"><a href="#cb22-1061" aria-hidden="true" tabindex="-1"></a><span class="in">  pd = c(pd_LnRR$pd, pd_LnCVi$pd, pd_Ratio_a_mu$pd, pd_Ratio_a_sd$pd)</span></span>
<span id="cb22-1062"><a href="#cb22-1062" aria-hidden="true" tabindex="-1"></a><span class="in">) |&gt; </span></span>
<span id="cb22-1063"><a href="#cb22-1063" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb22-1064"><a href="#cb22-1064" aria-hidden="true" tabindex="-1"></a><span class="in">    Median = round(Median, 3)</span></span>
<span id="cb22-1065"><a href="#cb22-1065" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-1066"><a href="#cb22-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1067"><a href="#cb22-1067" aria-hidden="true" tabindex="-1"></a><span class="in"># Results expressed as LnRR and LnCVi</span></span>
<span id="cb22-1068"><a href="#cb22-1068" aria-hidden="true" tabindex="-1"></a><span class="in">df_res_Ln |&gt; datatable(</span></span>
<span id="cb22-1069"><a href="#cb22-1069" aria-hidden="true" tabindex="-1"></a><span class="in">  options = list(</span></span>
<span id="cb22-1070"><a href="#cb22-1070" aria-hidden="true" tabindex="-1"></a><span class="in">    dom = 't',</span></span>
<span id="cb22-1071"><a href="#cb22-1071" aria-hidden="true" tabindex="-1"></a><span class="in">    autoWidth = TRUE,</span></span>
<span id="cb22-1072"><a href="#cb22-1072" aria-hidden="true" tabindex="-1"></a><span class="in">    columnDefs = list(</span></span>
<span id="cb22-1073"><a href="#cb22-1073" aria-hidden="true" tabindex="-1"></a><span class="in">      list(className = 'dt-left', targets = "_all")</span></span>
<span id="cb22-1074"><a href="#cb22-1074" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb22-1075"><a href="#cb22-1075" aria-hidden="true" tabindex="-1"></a><span class="in">    ), </span></span>
<span id="cb22-1076"><a href="#cb22-1076" aria-hidden="true" tabindex="-1"></a><span class="in">  class="hover"</span></span>
<span id="cb22-1077"><a href="#cb22-1077" aria-hidden="true" tabindex="-1"></a><span class="in">  ) |&gt;</span></span>
<span id="cb22-1078"><a href="#cb22-1078" aria-hidden="true" tabindex="-1"></a><span class="in">  formatRound(columns = c(2,4), digits = 2)</span></span>
<span id="cb22-1079"><a href="#cb22-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1080"><a href="#cb22-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1081"><a href="#cb22-1081" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Chains</span></span>
<span id="cb22-1082"><a href="#cb22-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1083"><a href="#cb22-1083" aria-hidden="true" tabindex="-1"></a>We can check if the chains look good (@fig-chainsVI).</span>
<span id="cb22-1084"><a href="#cb22-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1085"><a href="#cb22-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chainspost, echo=T, message=F, warning=F}</span></span>
<span id="cb22-1086"><a href="#cb22-1086" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Parameters chains (without the first 1000 iterations of warmup).</span></span>
<span id="cb22-1087"><a href="#cb22-1087" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-chainsVI</span></span>
<span id="cb22-1088"><a href="#cb22-1088" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 5</span></span>
<span id="cb22-1089"><a href="#cb22-1089" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 8</span></span>
<span id="cb22-1090"><a href="#cb22-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1091"><a href="#cb22-1091" aria-hidden="true" tabindex="-1"></a><span class="in">plot &lt;-</span></span>
<span id="cb22-1092"><a href="#cb22-1092" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(</span></span>
<span id="cb22-1093"><a href="#cb22-1093" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_chains_post,</span></span>
<span id="cb22-1094"><a href="#cb22-1094" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = Iteration, y = value, color = Chain, group = Chain)</span></span>
<span id="cb22-1095"><a href="#cb22-1095" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb22-1096"><a href="#cb22-1096" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(alpha=0.7)+</span></span>
<span id="cb22-1097"><a href="#cb22-1097" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~Parameter, scales = "free", ncol = 3)+</span></span>
<span id="cb22-1098"><a href="#cb22-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1099"><a href="#cb22-1099" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = nord(palette = "frost"))+</span></span>
<span id="cb22-1100"><a href="#cb22-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1101"><a href="#cb22-1101" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()+</span></span>
<span id="cb22-1102"><a href="#cb22-1102" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1103"><a href="#cb22-1103" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "right",</span></span>
<span id="cb22-1104"><a href="#cb22-1104" aria-hidden="true" tabindex="-1"></a><span class="in">    title=element_text(size=12, face="plain"),</span></span>
<span id="cb22-1105"><a href="#cb22-1105" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.x = element_text(face="plain"),</span></span>
<span id="cb22-1106"><a href="#cb22-1106" aria-hidden="true" tabindex="-1"></a><span class="in">    strip.background = element_rect(fill="white")</span></span>
<span id="cb22-1107"><a href="#cb22-1107" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1108"><a href="#cb22-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1109"><a href="#cb22-1109" aria-hidden="true" tabindex="-1"></a><span class="in">plot</span></span>
<span id="cb22-1110"><a href="#cb22-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1111"><a href="#cb22-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1112"><a href="#cb22-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1113"><a href="#cb22-1113" aria-hidden="true" tabindex="-1"></a>We can also check on the parameters correlations (@fig-pairsVIsim).</span>
<span id="cb22-1114"><a href="#cb22-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1115"><a href="#cb22-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r pairs, echo = T}</span></span>
<span id="cb22-1116"><a href="#cb22-1116" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Parameters correlations</span></span>
<span id="cb22-1117"><a href="#cb22-1117" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-pairsVIsim</span></span>
<span id="cb22-1118"><a href="#cb22-1118" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 10</span></span>
<span id="cb22-1119"><a href="#cb22-1119" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 10</span></span>
<span id="cb22-1120"><a href="#cb22-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1121"><a href="#cb22-1121" aria-hidden="true" tabindex="-1"></a><span class="in">bayesplot::color_scheme_set("gray")</span></span>
<span id="cb22-1122"><a href="#cb22-1122" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- pairs(m.sim.post, regex=T)</span></span>
<span id="cb22-1123"><a href="#cb22-1123" aria-hidden="true" tabindex="-1"></a><span class="in">p</span></span>
<span id="cb22-1124"><a href="#cb22-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1125"><a href="#cb22-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1126"><a href="#cb22-1126" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model predictions</span></span>
<span id="cb22-1127"><a href="#cb22-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1128"><a href="#cb22-1128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dfpred, warning=F, message=F}</span></span>
<span id="cb22-1129"><a href="#cb22-1129" aria-hidden="true" tabindex="-1"></a><span class="in">pred &lt;- predicted_draws(m.sim.post, newdata=df_sim)</span></span>
<span id="cb22-1130"><a href="#cb22-1130" aria-hidden="true" tabindex="-1"></a><span class="in">post_i &lt;- as.data.frame(posterior_summary(m.sim.post))</span></span>
<span id="cb22-1131"><a href="#cb22-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1132"><a href="#cb22-1132" aria-hidden="true" tabindex="-1"></a><span class="in">ID &lt;- subset(df_sim, t==0)$ID</span></span>
<span id="cb22-1133"><a href="#cb22-1133" aria-hidden="true" tabindex="-1"></a><span class="in">expo &lt;- subset(df_sim, t==0)$exposition</span></span>
<span id="cb22-1134"><a href="#cb22-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1135"><a href="#cb22-1135" aria-hidden="true" tabindex="-1"></a><span class="in">df_estimates &lt;- </span></span>
<span id="cb22-1136"><a href="#cb22-1136" aria-hidden="true" tabindex="-1"></a><span class="in">  data.frame(</span></span>
<span id="cb22-1137"><a href="#cb22-1137" aria-hidden="true" tabindex="-1"></a><span class="in">    ID                = ID,</span></span>
<span id="cb22-1138"><a href="#cb22-1138" aria-hidden="true" tabindex="-1"></a><span class="in">    exposition        = expo,</span></span>
<span id="cb22-1139"><a href="#cb22-1139" aria-hidden="true" tabindex="-1"></a><span class="in">    r_L0_i            = post_i$Estimate[8:(8+length(ID)-1)],</span></span>
<span id="cb22-1140"><a href="#cb22-1140" aria-hidden="true" tabindex="-1"></a><span class="in">    r_a_i_expo_0      = post_i$Estimate[(8+length(ID)):(8+length(ID)*2-1)],</span></span>
<span id="cb22-1141"><a href="#cb22-1141" aria-hidden="true" tabindex="-1"></a><span class="in">    r_a_i_expo_1      = post_i$Estimate[(8+length(ID)*2):(8+length(ID)*3-1)],</span></span>
<span id="cb22-1142"><a href="#cb22-1142" aria-hidden="true" tabindex="-1"></a><span class="in">    r_a_i_2.5_expo_0  = post_i$Q2.5[(8+length(ID)):(8+length(ID)*2-1)],</span></span>
<span id="cb22-1143"><a href="#cb22-1143" aria-hidden="true" tabindex="-1"></a><span class="in">    r_a_i_2.5_expo_1  = post_i$Q2.5[(8+length(ID)*2):(8+length(ID)*3-1)],</span></span>
<span id="cb22-1144"><a href="#cb22-1144" aria-hidden="true" tabindex="-1"></a><span class="in">    r_a_i_97.5_expo_0 = post_i$Q97.5[(8+length(ID)):(8+length(ID)*2-1)],</span></span>
<span id="cb22-1145"><a href="#cb22-1145" aria-hidden="true" tabindex="-1"></a><span class="in">    r_a_i_97.5_expo_1 = post_i$Q97.5[(8+length(ID)*2):(8+length(ID)*3-1)]</span></span>
<span id="cb22-1146"><a href="#cb22-1146" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt; </span></span>
<span id="cb22-1147"><a href="#cb22-1147" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb22-1148"><a href="#cb22-1148" aria-hidden="true" tabindex="-1"></a><span class="in">    L0_i = post_i$Estimate[1]+r_L0_i,</span></span>
<span id="cb22-1149"><a href="#cb22-1149" aria-hidden="true" tabindex="-1"></a><span class="in">    a_i = case_when(</span></span>
<span id="cb22-1150"><a href="#cb22-1150" aria-hidden="true" tabindex="-1"></a><span class="in">      exposition == 0 ~ post_i$Estimate[2]+r_a_i_expo_0,</span></span>
<span id="cb22-1151"><a href="#cb22-1151" aria-hidden="true" tabindex="-1"></a><span class="in">      exposition == 1 ~ post_i$Estimate[3]+r_a_i_expo_1</span></span>
<span id="cb22-1152"><a href="#cb22-1152" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-1153"><a href="#cb22-1153" aria-hidden="true" tabindex="-1"></a><span class="in">    a_i_2.5 = case_when(</span></span>
<span id="cb22-1154"><a href="#cb22-1154" aria-hidden="true" tabindex="-1"></a><span class="in">      exposition==0 ~ post_i$Q2.5[2]+r_a_i_expo_0,</span></span>
<span id="cb22-1155"><a href="#cb22-1155" aria-hidden="true" tabindex="-1"></a><span class="in">      exposition==1 ~ post_i$Q2.5[3]+r_a_i_expo_1</span></span>
<span id="cb22-1156"><a href="#cb22-1156" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb22-1157"><a href="#cb22-1157" aria-hidden="true" tabindex="-1"></a><span class="in">    a_i_97.5 = case_when(</span></span>
<span id="cb22-1158"><a href="#cb22-1158" aria-hidden="true" tabindex="-1"></a><span class="in">      exposition==0 ~ post_i$Q97.5[2]+r_a_i_expo_0,</span></span>
<span id="cb22-1159"><a href="#cb22-1159" aria-hidden="true" tabindex="-1"></a><span class="in">      exposition==1 ~ post_i$Q97.5[3]+r_a_i_expo_1</span></span>
<span id="cb22-1160"><a href="#cb22-1160" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb22-1161"><a href="#cb22-1161" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt; </span></span>
<span id="cb22-1162"><a href="#cb22-1162" aria-hidden="true" tabindex="-1"></a><span class="in">  select(ID, exposition, L0_i, a_i, a_i_2.5, a_i_97.5)</span></span>
<span id="cb22-1163"><a href="#cb22-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1164"><a href="#cb22-1164" aria-hidden="true" tabindex="-1"></a><span class="in">df_pred_mean &lt;- pred |&gt; </span></span>
<span id="cb22-1165"><a href="#cb22-1165" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(</span></span>
<span id="cb22-1166"><a href="#cb22-1166" aria-hidden="true" tabindex="-1"></a><span class="in">    .prediction ~ t + ID + exposition, </span></span>
<span id="cb22-1167"><a href="#cb22-1167" aria-hidden="true" tabindex="-1"></a><span class="in">    FUN=mean</span></span>
<span id="cb22-1168"><a href="#cb22-1168" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1169"><a href="#cb22-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1170"><a href="#cb22-1170" aria-hidden="true" tabindex="-1"></a><span class="in">df_pred_Q &lt;- pred |&gt; </span></span>
<span id="cb22-1171"><a href="#cb22-1171" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(</span></span>
<span id="cb22-1172"><a href="#cb22-1172" aria-hidden="true" tabindex="-1"></a><span class="in">    .prediction ~ t + ID + exposition, </span></span>
<span id="cb22-1173"><a href="#cb22-1173" aria-hidden="true" tabindex="-1"></a><span class="in">    FUN='quantile', </span></span>
<span id="cb22-1174"><a href="#cb22-1174" aria-hidden="true" tabindex="-1"></a><span class="in">    probs=c(2.5, 97.5)/100</span></span>
<span id="cb22-1175"><a href="#cb22-1175" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1176"><a href="#cb22-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1177"><a href="#cb22-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1178"><a href="#cb22-1178" aria-hidden="true" tabindex="-1"></a><span class="in">df_pred &lt;- df_pred_mean |&gt; </span></span>
<span id="cb22-1179"><a href="#cb22-1179" aria-hidden="true" tabindex="-1"></a><span class="in">  cbind(df_pred_Q$.prediction[,1]) |&gt; </span></span>
<span id="cb22-1180"><a href="#cb22-1180" aria-hidden="true" tabindex="-1"></a><span class="in">  cbind(df_pred_Q$.prediction[,2]) |&gt;</span></span>
<span id="cb22-1181"><a href="#cb22-1181" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Expo=case_when(exposition==0 ~ "Non exposed",</span></span>
<span id="cb22-1182"><a href="#cb22-1182" aria-hidden="true" tabindex="-1"></a><span class="in">                        exposition==1 ~ "Exposed"))</span></span>
<span id="cb22-1183"><a href="#cb22-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1184"><a href="#cb22-1184" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(df_pred) &lt;- c("t", "ID", "exposition", </span></span>
<span id="cb22-1185"><a href="#cb22-1185" aria-hidden="true" tabindex="-1"></a><span class="in">                       "pred_L_mean", "pred_L_Q2.5", "pred_L_Q97.5", "Expo")</span></span>
<span id="cb22-1186"><a href="#cb22-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1187"><a href="#cb22-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1188"><a href="#cb22-1188" aria-hidden="true" tabindex="-1"></a>We now check the predictions of the model at the population level (@fig-postpredVIsim) and the individual level (@fig-postpredVIindctrlsim &amp; @fig-postpredVIindtrtsim) :</span>
<span id="cb22-1189"><a href="#cb22-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1190"><a href="#cb22-1190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r predmean, echo = T, warning=F}</span></span>
<span id="cb22-1191"><a href="#cb22-1191" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Posterior predictive check. Fresh body weight of simulated non-exposed earthworms (blue points and thin lines, each line corresponding to one individual) and earthworms exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points and thin lines, each line corresponding to one individual). Colored ribbons correspond to the different credibility intervals for the mean growth for each cohort. The thicker black lines represent the predicted mean body weight.</span></span>
<span id="cb22-1192"><a href="#cb22-1192" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-postpredVIsim</span></span>
<span id="cb22-1193"><a href="#cb22-1193" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 4</span></span>
<span id="cb22-1194"><a href="#cb22-1194" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 8</span></span>
<span id="cb22-1195"><a href="#cb22-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1196"><a href="#cb22-1196" aria-hidden="true" tabindex="-1"></a><span class="in">y_max &lt;- 480</span></span>
<span id="cb22-1197"><a href="#cb22-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1198"><a href="#cb22-1198" aria-hidden="true" tabindex="-1"></a><span class="in">p_ctrl &lt;- ggplot()+</span></span>
<span id="cb22-1199"><a href="#cb22-1199" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1200"><a href="#cb22-1200" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_lineribbon(</span></span>
<span id="cb22-1201"><a href="#cb22-1201" aria-hidden="true" tabindex="-1"></a><span class="in">    data = pred[pred$exposition == 0,],</span></span>
<span id="cb22-1202"><a href="#cb22-1202" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x=t, y=.prediction^3, group=exposition),</span></span>
<span id="cb22-1203"><a href="#cb22-1203" aria-hidden="true" tabindex="-1"></a><span class="in">    .width=c(.99,.95,.8,.5),</span></span>
<span id="cb22-1204"><a href="#cb22-1204" aria-hidden="true" tabindex="-1"></a><span class="in">    color="black"</span></span>
<span id="cb22-1205"><a href="#cb22-1205" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1206"><a href="#cb22-1206" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-1207"><a href="#cb22-1207" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_sim[df_sim$exposition == 0,], </span></span>
<span id="cb22-1208"><a href="#cb22-1208" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y = L^3, group = ID), </span></span>
<span id="cb22-1209"><a href="#cb22-1209" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "#141c44", </span></span>
<span id="cb22-1210"><a href="#cb22-1210" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.4</span></span>
<span id="cb22-1211"><a href="#cb22-1211" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1212"><a href="#cb22-1212" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb22-1213"><a href="#cb22-1213" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_sim[df_sim$exposition == 0,], </span></span>
<span id="cb22-1214"><a href="#cb22-1214" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y = L^3, group = ID), color = "#141c44", alpha = 0.4</span></span>
<span id="cb22-1215"><a href="#cb22-1215" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1216"><a href="#cb22-1216" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1217"><a href="#cb22-1217" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(0, y_max)+</span></span>
<span id="cb22-1218"><a href="#cb22-1218" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(</span></span>
<span id="cb22-1219"><a href="#cb22-1219" aria-hidden="true" tabindex="-1"></a><span class="in">    limits = c(0, 56),        </span></span>
<span id="cb22-1220"><a href="#cb22-1220" aria-hidden="true" tabindex="-1"></a><span class="in">    breaks = seq(0, 56, by = 28),        </span></span>
<span id="cb22-1221"><a href="#cb22-1221" aria-hidden="true" tabindex="-1"></a><span class="in">    minor_breaks = seq(0, 56, by = 14)</span></span>
<span id="cb22-1222"><a href="#cb22-1222" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-1223"><a href="#cb22-1223" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1224"><a href="#cb22-1224" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = rev(pal_blue))+</span></span>
<span id="cb22-1225"><a href="#cb22-1225" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1226"><a href="#cb22-1226" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y="Weight (mg)", x="Time (days)")+</span></span>
<span id="cb22-1227"><a href="#cb22-1227" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1228"><a href="#cb22-1228" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-1229"><a href="#cb22-1229" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none")</span></span>
<span id="cb22-1230"><a href="#cb22-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1231"><a href="#cb22-1231" aria-hidden="true" tabindex="-1"></a><span class="in">p_trt &lt;- ggplot()+</span></span>
<span id="cb22-1232"><a href="#cb22-1232" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_lineribbon(</span></span>
<span id="cb22-1233"><a href="#cb22-1233" aria-hidden="true" tabindex="-1"></a><span class="in">    data = pred[pred$exposition == 1,], </span></span>
<span id="cb22-1234"><a href="#cb22-1234" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x=t, y = .prediction^3, group = exposition),</span></span>
<span id="cb22-1235"><a href="#cb22-1235" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = c(.99,.95,.8,.5),</span></span>
<span id="cb22-1236"><a href="#cb22-1236" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "black"</span></span>
<span id="cb22-1237"><a href="#cb22-1237" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1238"><a href="#cb22-1238" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb22-1239"><a href="#cb22-1239" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_sim[df_sim$exposition == 1,], </span></span>
<span id="cb22-1240"><a href="#cb22-1240" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y = L^3, group = ID), </span></span>
<span id="cb22-1241"><a href="#cb22-1241" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "#380000", </span></span>
<span id="cb22-1242"><a href="#cb22-1242" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.4</span></span>
<span id="cb22-1243"><a href="#cb22-1243" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1244"><a href="#cb22-1244" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-1245"><a href="#cb22-1245" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_sim[df_sim$exposition == 1,], </span></span>
<span id="cb22-1246"><a href="#cb22-1246" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y = L^3, group = ID), </span></span>
<span id="cb22-1247"><a href="#cb22-1247" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "#380000", </span></span>
<span id="cb22-1248"><a href="#cb22-1248" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.4</span></span>
<span id="cb22-1249"><a href="#cb22-1249" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1250"><a href="#cb22-1250" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1251"><a href="#cb22-1251" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(</span></span>
<span id="cb22-1252"><a href="#cb22-1252" aria-hidden="true" tabindex="-1"></a><span class="in">    limits = c(0, 56),        </span></span>
<span id="cb22-1253"><a href="#cb22-1253" aria-hidden="true" tabindex="-1"></a><span class="in">    breaks = seq(0, 56, by = 28),        </span></span>
<span id="cb22-1254"><a href="#cb22-1254" aria-hidden="true" tabindex="-1"></a><span class="in">    minor_breaks = seq(0, 56, by = 14)</span></span>
<span id="cb22-1255"><a href="#cb22-1255" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-1256"><a href="#cb22-1256" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(0, y_max)+</span></span>
<span id="cb22-1257"><a href="#cb22-1257" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1258"><a href="#cb22-1258" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1259"><a href="#cb22-1259" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = rev(pal_red))+</span></span>
<span id="cb22-1260"><a href="#cb22-1260" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1261"><a href="#cb22-1261" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y = "Weight (mg)", x = "Time (days)")+</span></span>
<span id="cb22-1262"><a href="#cb22-1262" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1263"><a href="#cb22-1263" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()+</span></span>
<span id="cb22-1264"><a href="#cb22-1264" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none")</span></span>
<span id="cb22-1265"><a href="#cb22-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1266"><a href="#cb22-1266" aria-hidden="true" tabindex="-1"></a><span class="in">plot.estimates.grp &lt;- p_ctrl + p_trt + </span></span>
<span id="cb22-1267"><a href="#cb22-1267" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(ncol=2, guides="collect") &amp; </span></span>
<span id="cb22-1268"><a href="#cb22-1268" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1269"><a href="#cb22-1269" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "right", </span></span>
<span id="cb22-1270"><a href="#cb22-1270" aria-hidden="true" tabindex="-1"></a><span class="in">    title=element_text(face="bold"), </span></span>
<span id="cb22-1271"><a href="#cb22-1271" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.x = element_text(face="plain"),</span></span>
<span id="cb22-1272"><a href="#cb22-1272" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.y = element_text(face="plain")</span></span>
<span id="cb22-1273"><a href="#cb22-1273" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1274"><a href="#cb22-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1275"><a href="#cb22-1275" aria-hidden="true" tabindex="-1"></a><span class="in">plot.estimates.grp</span></span>
<span id="cb22-1276"><a href="#cb22-1276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1277"><a href="#cb22-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1278"><a href="#cb22-1278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r savepredmeanpop, include=F, message=F, warning=F}</span></span>
<span id="cb22-1279"><a href="#cb22-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1280"><a href="#cb22-1280" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(</span></span>
<span id="cb22-1281"><a href="#cb22-1281" aria-hidden="true" tabindex="-1"></a><span class="in">  filename="ModVI_post_pred.png", </span></span>
<span id="cb22-1282"><a href="#cb22-1282" aria-hidden="true" tabindex="-1"></a><span class="in">  plot=plot.estimates.grp, </span></span>
<span id="cb22-1283"><a href="#cb22-1283" aria-hidden="true" tabindex="-1"></a><span class="in">  width=8, height = 4.5, </span></span>
<span id="cb22-1284"><a href="#cb22-1284" aria-hidden="true" tabindex="-1"></a><span class="in">  path=here::here("fig/")</span></span>
<span id="cb22-1285"><a href="#cb22-1285" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-1286"><a href="#cb22-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1287"><a href="#cb22-1287" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(</span></span>
<span id="cb22-1288"><a href="#cb22-1288" aria-hidden="true" tabindex="-1"></a><span class="in">  filename="ModVI_post_pred.svg", </span></span>
<span id="cb22-1289"><a href="#cb22-1289" aria-hidden="true" tabindex="-1"></a><span class="in">       plot=plot.estimates.grp, </span></span>
<span id="cb22-1290"><a href="#cb22-1290" aria-hidden="true" tabindex="-1"></a><span class="in">  width=8, height = 4.5, </span></span>
<span id="cb22-1291"><a href="#cb22-1291" aria-hidden="true" tabindex="-1"></a><span class="in">  path=here::here("fig/")</span></span>
<span id="cb22-1292"><a href="#cb22-1292" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-1293"><a href="#cb22-1293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1294"><a href="#cb22-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1295"><a href="#cb22-1295" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb22-1296"><a href="#cb22-1296" aria-hidden="true" tabindex="-1"></a><span class="fu">## Non-exposed</span></span>
<span id="cb22-1297"><a href="#cb22-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1298"><a href="#cb22-1298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ctrlpredcheck, echo = T, warning=F}</span></span>
<span id="cb22-1299"><a href="#cb22-1299" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Posterior predictive check. Fresh body weight of simulated non-exposed earthworms (blue points). Colored ribbons correspond to the different credibility intervals for the predicted growth for each individual. The thicker black lines represent the predicted body weight.</span></span>
<span id="cb22-1300"><a href="#cb22-1300" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-postpredVIindctrlsim</span></span>
<span id="cb22-1301"><a href="#cb22-1301" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 8</span></span>
<span id="cb22-1302"><a href="#cb22-1302" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 9</span></span>
<span id="cb22-1303"><a href="#cb22-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1304"><a href="#cb22-1304" aria-hidden="true" tabindex="-1"></a><span class="in">p_ctrl &lt;- ggplot()+</span></span>
<span id="cb22-1305"><a href="#cb22-1305" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_lineribbon(</span></span>
<span id="cb22-1306"><a href="#cb22-1306" aria-hidden="true" tabindex="-1"></a><span class="in">    data = pred[pred$exposition==0,], </span></span>
<span id="cb22-1307"><a href="#cb22-1307" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y=.prediction^3, color=exposition, group=ID),</span></span>
<span id="cb22-1308"><a href="#cb22-1308" aria-hidden="true" tabindex="-1"></a><span class="in">    .width=c(.99,.95,.8,.5),</span></span>
<span id="cb22-1309"><a href="#cb22-1309" aria-hidden="true" tabindex="-1"></a><span class="in">    color="black"</span></span>
<span id="cb22-1310"><a href="#cb22-1310" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1311"><a href="#cb22-1311" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-1312"><a href="#cb22-1312" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim[df_sim$exposition==0,], </span></span>
<span id="cb22-1313"><a href="#cb22-1313" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x=t, y=L^3, group=ID), </span></span>
<span id="cb22-1314"><a href="#cb22-1314" aria-hidden="true" tabindex="-1"></a><span class="in">    color="#141c44", </span></span>
<span id="cb22-1315"><a href="#cb22-1315" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.25</span></span>
<span id="cb22-1316"><a href="#cb22-1316" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1317"><a href="#cb22-1317" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb22-1318"><a href="#cb22-1318" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim[df_sim$exposition==0,],</span></span>
<span id="cb22-1319"><a href="#cb22-1319" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x=t, y=L^3, group=ID), </span></span>
<span id="cb22-1320"><a href="#cb22-1320" aria-hidden="true" tabindex="-1"></a><span class="in">    color="#141c44", </span></span>
<span id="cb22-1321"><a href="#cb22-1321" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.3, </span></span>
<span id="cb22-1322"><a href="#cb22-1322" aria-hidden="true" tabindex="-1"></a><span class="in">    size=2.5</span></span>
<span id="cb22-1323"><a href="#cb22-1323" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1324"><a href="#cb22-1324" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ID, ncol=5)+</span></span>
<span id="cb22-1325"><a href="#cb22-1325" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1326"><a href="#cb22-1326" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = rev(pal_blue))+</span></span>
<span id="cb22-1327"><a href="#cb22-1327" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1328"><a href="#cb22-1328" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y="Weight (mg)", x="Time (days)")+</span></span>
<span id="cb22-1329"><a href="#cb22-1329" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(0, y_max)+</span></span>
<span id="cb22-1330"><a href="#cb22-1330" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(</span></span>
<span id="cb22-1331"><a href="#cb22-1331" aria-hidden="true" tabindex="-1"></a><span class="in">    limits = c(0, 56),        </span></span>
<span id="cb22-1332"><a href="#cb22-1332" aria-hidden="true" tabindex="-1"></a><span class="in">    breaks = seq(0, 56, by = 28),        </span></span>
<span id="cb22-1333"><a href="#cb22-1333" aria-hidden="true" tabindex="-1"></a><span class="in">    minor_breaks = seq(0, 56, by = 14)</span></span>
<span id="cb22-1334"><a href="#cb22-1334" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-1335"><a href="#cb22-1335" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1336"><a href="#cb22-1336" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()+</span></span>
<span id="cb22-1337"><a href="#cb22-1337" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1338"><a href="#cb22-1338" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "right", </span></span>
<span id="cb22-1339"><a href="#cb22-1339" aria-hidden="true" tabindex="-1"></a><span class="in">    title=element_text(size=12, face="plain"), </span></span>
<span id="cb22-1340"><a href="#cb22-1340" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.x = element_text(face="plain"),</span></span>
<span id="cb22-1341"><a href="#cb22-1341" aria-hidden="true" tabindex="-1"></a><span class="in">    strip.background = element_rect(fill="white")</span></span>
<span id="cb22-1342"><a href="#cb22-1342" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1343"><a href="#cb22-1343" aria-hidden="true" tabindex="-1"></a><span class="in">p_ctrl</span></span>
<span id="cb22-1344"><a href="#cb22-1344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1345"><a href="#cb22-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1346"><a href="#cb22-1346" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exposed</span></span>
<span id="cb22-1347"><a href="#cb22-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1348"><a href="#cb22-1348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r trtpredcheck, warning=F, message=F}</span></span>
<span id="cb22-1349"><a href="#cb22-1349" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Posterior predictive check. Fresh body weight of simulated exposed to the equivalent of 3 RD of Swing® Gold renewed each 28 days (red points). Colored ribbons correspond to the different credibility intervals for the predicted growth for each individual. The thicker black lines represent the predicted body weight.</span></span>
<span id="cb22-1350"><a href="#cb22-1350" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-postpredVIindtrtsim</span></span>
<span id="cb22-1351"><a href="#cb22-1351" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 8</span></span>
<span id="cb22-1352"><a href="#cb22-1352" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 9</span></span>
<span id="cb22-1353"><a href="#cb22-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1354"><a href="#cb22-1354" aria-hidden="true" tabindex="-1"></a><span class="in">p_trt &lt;- ggplot()+</span></span>
<span id="cb22-1355"><a href="#cb22-1355" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_lineribbon(</span></span>
<span id="cb22-1356"><a href="#cb22-1356" aria-hidden="true" tabindex="-1"></a><span class="in">    data = pred[pred$exposition==1,],</span></span>
<span id="cb22-1357"><a href="#cb22-1357" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = t, y=.prediction^3, color=exposition, group=ID),</span></span>
<span id="cb22-1358"><a href="#cb22-1358" aria-hidden="true" tabindex="-1"></a><span class="in">    .width=c(.99,.95,.8,.5),</span></span>
<span id="cb22-1359"><a href="#cb22-1359" aria-hidden="true" tabindex="-1"></a><span class="in">    color="black"</span></span>
<span id="cb22-1360"><a href="#cb22-1360" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1361"><a href="#cb22-1361" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb22-1362"><a href="#cb22-1362" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim[df_sim$exposition==1,], </span></span>
<span id="cb22-1363"><a href="#cb22-1363" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x=t, y=L^3, group=ID), </span></span>
<span id="cb22-1364"><a href="#cb22-1364" aria-hidden="true" tabindex="-1"></a><span class="in">    color="#380000", </span></span>
<span id="cb22-1365"><a href="#cb22-1365" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.3, </span></span>
<span id="cb22-1366"><a href="#cb22-1366" aria-hidden="true" tabindex="-1"></a><span class="in">    size=2.5</span></span>
<span id="cb22-1367"><a href="#cb22-1367" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1368"><a href="#cb22-1368" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-1369"><a href="#cb22-1369" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim[df_sim$exposition==1,], </span></span>
<span id="cb22-1370"><a href="#cb22-1370" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x=t, y=L^3, group=ID), </span></span>
<span id="cb22-1371"><a href="#cb22-1371" aria-hidden="true" tabindex="-1"></a><span class="in">    color="#380000", </span></span>
<span id="cb22-1372"><a href="#cb22-1372" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.25</span></span>
<span id="cb22-1373"><a href="#cb22-1373" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1374"><a href="#cb22-1374" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ID, ncol=5, nrow=6)+</span></span>
<span id="cb22-1375"><a href="#cb22-1375" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1376"><a href="#cb22-1376" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = rev(pal_red))+</span></span>
<span id="cb22-1377"><a href="#cb22-1377" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1378"><a href="#cb22-1378" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y="Weight (mg)", x="Time (days)")+</span></span>
<span id="cb22-1379"><a href="#cb22-1379" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(0, y_max)+</span></span>
<span id="cb22-1380"><a href="#cb22-1380" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(</span></span>
<span id="cb22-1381"><a href="#cb22-1381" aria-hidden="true" tabindex="-1"></a><span class="in">    limits = c(0, 56),        </span></span>
<span id="cb22-1382"><a href="#cb22-1382" aria-hidden="true" tabindex="-1"></a><span class="in">    breaks = seq(0, 56, by = 28),        </span></span>
<span id="cb22-1383"><a href="#cb22-1383" aria-hidden="true" tabindex="-1"></a><span class="in">    minor_breaks = seq(0, 56, by = 14)</span></span>
<span id="cb22-1384"><a href="#cb22-1384" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb22-1385"><a href="#cb22-1385" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1386"><a href="#cb22-1386" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()+</span></span>
<span id="cb22-1387"><a href="#cb22-1387" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1388"><a href="#cb22-1388" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "right", </span></span>
<span id="cb22-1389"><a href="#cb22-1389" aria-hidden="true" tabindex="-1"></a><span class="in">    title=element_text(size=12, face="plain"), </span></span>
<span id="cb22-1390"><a href="#cb22-1390" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.x = element_text(face="plain"),</span></span>
<span id="cb22-1391"><a href="#cb22-1391" aria-hidden="true" tabindex="-1"></a><span class="in">    strip.background = element_rect(fill="white")</span></span>
<span id="cb22-1392"><a href="#cb22-1392" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1393"><a href="#cb22-1393" aria-hidden="true" tabindex="-1"></a><span class="in">p_trt</span></span>
<span id="cb22-1394"><a href="#cb22-1394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1395"><a href="#cb22-1395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-1396"><a href="#cb22-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1397"><a href="#cb22-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparison of the simulated and estimated parameters values</span></span>
<span id="cb22-1398"><a href="#cb22-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1399"><a href="#cb22-1399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r predobs, warning=F, message=F}</span></span>
<span id="cb22-1400"><a href="#cb22-1400" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Results of the model fit on experimental data. Predicted values are represented with points with their respective credibility interval of 95%. Red points correspond to the predicted value for exposed individuals and blue points for the non exposed individuals. Dashed and dotted lines represent the 1.5-folds and 2-fold changes, respectively. The full line represents the identity line. </span></span>
<span id="cb22-1401"><a href="#cb22-1401" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-predobsw</span></span>
<span id="cb22-1402"><a href="#cb22-1402" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 13</span></span>
<span id="cb22-1403"><a href="#cb22-1403" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 12</span></span>
<span id="cb22-1404"><a href="#cb22-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1405"><a href="#cb22-1405" aria-hidden="true" tabindex="-1"></a><span class="in">df_sim_ordered &lt;- df_sim |&gt; arrange(t) |&gt; arrange(as.numeric(ID))</span></span>
<span id="cb22-1406"><a href="#cb22-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1407"><a href="#cb22-1407" aria-hidden="true" tabindex="-1"></a><span class="in">df_data_pred_obs &lt;- df_pred |&gt;</span></span>
<span id="cb22-1408"><a href="#cb22-1408" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb22-1409"><a href="#cb22-1409" aria-hidden="true" tabindex="-1"></a><span class="in">    w_obs = df_sim_ordered$w,</span></span>
<span id="cb22-1410"><a href="#cb22-1410" aria-hidden="true" tabindex="-1"></a><span class="in">    ratio_predobs = pred_L_mean^3 / w_obs</span></span>
<span id="cb22-1411"><a href="#cb22-1411" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1412"><a href="#cb22-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1413"><a href="#cb22-1413" aria-hidden="true" tabindex="-1"></a><span class="in">fact_1 &lt;- 1.5</span></span>
<span id="cb22-1414"><a href="#cb22-1414" aria-hidden="true" tabindex="-1"></a><span class="in">fact_2 &lt;- 2</span></span>
<span id="cb22-1415"><a href="#cb22-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1416"><a href="#cb22-1416" aria-hidden="true" tabindex="-1"></a><span class="in">seq_line &lt;- seq(1.1, 600, 0.1)</span></span>
<span id="cb22-1417"><a href="#cb22-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1418"><a href="#cb22-1418" aria-hidden="true" tabindex="-1"></a><span class="in">df_line &lt;- data.frame(</span></span>
<span id="cb22-1419"><a href="#cb22-1419" aria-hidden="true" tabindex="-1"></a><span class="in">  x1  = seq_line,</span></span>
<span id="cb22-1420"><a href="#cb22-1420" aria-hidden="true" tabindex="-1"></a><span class="in">  y1  = seq_line*fact_1,</span></span>
<span id="cb22-1421"><a href="#cb22-1421" aria-hidden="true" tabindex="-1"></a><span class="in">  x_1 = seq_line,</span></span>
<span id="cb22-1422"><a href="#cb22-1422" aria-hidden="true" tabindex="-1"></a><span class="in">  y_1 = seq_line/fact_1,</span></span>
<span id="cb22-1423"><a href="#cb22-1423" aria-hidden="true" tabindex="-1"></a><span class="in">  x2  = seq_line,</span></span>
<span id="cb22-1424"><a href="#cb22-1424" aria-hidden="true" tabindex="-1"></a><span class="in">  y2  = seq_line*fact_2,</span></span>
<span id="cb22-1425"><a href="#cb22-1425" aria-hidden="true" tabindex="-1"></a><span class="in">  x_2 = seq_line,</span></span>
<span id="cb22-1426"><a href="#cb22-1426" aria-hidden="true" tabindex="-1"></a><span class="in">  y_2 = seq_line/fact_2</span></span>
<span id="cb22-1427"><a href="#cb22-1427" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-1428"><a href="#cb22-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1429"><a href="#cb22-1429" aria-hidden="true" tabindex="-1"></a><span class="in">plot_predobs_log &lt;- ggplot()+ </span></span>
<span id="cb22-1430"><a href="#cb22-1430" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1431"><a href="#cb22-1431" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-1432"><a href="#cb22-1432" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_line, </span></span>
<span id="cb22-1433"><a href="#cb22-1433" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping=aes(x=x1, y=y1), </span></span>
<span id="cb22-1434"><a href="#cb22-1434" aria-hidden="true" tabindex="-1"></a><span class="in">    linetype="dashed"</span></span>
<span id="cb22-1435"><a href="#cb22-1435" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1436"><a href="#cb22-1436" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-1437"><a href="#cb22-1437" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_line, </span></span>
<span id="cb22-1438"><a href="#cb22-1438" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping=aes(x=x_1, y=y_1), </span></span>
<span id="cb22-1439"><a href="#cb22-1439" aria-hidden="true" tabindex="-1"></a><span class="in">    linetype="dashed"</span></span>
<span id="cb22-1440"><a href="#cb22-1440" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1441"><a href="#cb22-1441" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-1442"><a href="#cb22-1442" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_line, </span></span>
<span id="cb22-1443"><a href="#cb22-1443" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping=aes(x=x2, y=y2), </span></span>
<span id="cb22-1444"><a href="#cb22-1444" aria-hidden="true" tabindex="-1"></a><span class="in">    linetype="dotted"</span></span>
<span id="cb22-1445"><a href="#cb22-1445" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1446"><a href="#cb22-1446" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb22-1447"><a href="#cb22-1447" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_line, </span></span>
<span id="cb22-1448"><a href="#cb22-1448" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping=aes(x=x_2, y=y_2), </span></span>
<span id="cb22-1449"><a href="#cb22-1449" aria-hidden="true" tabindex="-1"></a><span class="in">    linetype="dotted"</span></span>
<span id="cb22-1450"><a href="#cb22-1450" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1451"><a href="#cb22-1451" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_abline(intercept=0, slope=1)+</span></span>
<span id="cb22-1452"><a href="#cb22-1452" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_pointrange(</span></span>
<span id="cb22-1453"><a href="#cb22-1453" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_data_pred_obs, </span></span>
<span id="cb22-1454"><a href="#cb22-1454" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb22-1455"><a href="#cb22-1455" aria-hidden="true" tabindex="-1"></a><span class="in">      x=w_obs,</span></span>
<span id="cb22-1456"><a href="#cb22-1456" aria-hidden="true" tabindex="-1"></a><span class="in">      y=pred_L_mean^3,</span></span>
<span id="cb22-1457"><a href="#cb22-1457" aria-hidden="true" tabindex="-1"></a><span class="in">      ymin=pred_L_Q2.5^3,</span></span>
<span id="cb22-1458"><a href="#cb22-1458" aria-hidden="true" tabindex="-1"></a><span class="in">      ymax=pred_L_Q97.5^3, </span></span>
<span id="cb22-1459"><a href="#cb22-1459" aria-hidden="true" tabindex="-1"></a><span class="in">      color=Expo</span></span>
<span id="cb22-1460"><a href="#cb22-1460" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb22-1461"><a href="#cb22-1461" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.5</span></span>
<span id="cb22-1462"><a href="#cb22-1462" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1463"><a href="#cb22-1463" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1464"><a href="#cb22-1464" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_log10(limits=c(1.6, 700))+</span></span>
<span id="cb22-1465"><a href="#cb22-1465" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_log10(limits=c(1.6, 700))+</span></span>
<span id="cb22-1466"><a href="#cb22-1466" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1467"><a href="#cb22-1467" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1468"><a href="#cb22-1468" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1469"><a href="#cb22-1469" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1470"><a href="#cb22-1470" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb22-1471"><a href="#cb22-1471" aria-hidden="true" tabindex="-1"></a><span class="in">    x="Observed weight (mg)", </span></span>
<span id="cb22-1472"><a href="#cb22-1472" aria-hidden="true" tabindex="-1"></a><span class="in">    y="Predicted weight (mg)"</span></span>
<span id="cb22-1473"><a href="#cb22-1473" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1474"><a href="#cb22-1474" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb22-1475"><a href="#cb22-1475" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal(24)+</span></span>
<span id="cb22-1476"><a href="#cb22-1476" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "bottom")</span></span>
<span id="cb22-1477"><a href="#cb22-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1478"><a href="#cb22-1478" aria-hidden="true" tabindex="-1"></a><span class="in">plot_predobs_log</span></span>
<span id="cb22-1479"><a href="#cb22-1479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1480"><a href="#cb22-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1481"><a href="#cb22-1481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r foldpred}</span></span>
<span id="cb22-1482"><a href="#cb22-1482" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: Percentage of points in the X-fold change area</span></span>
<span id="cb22-1483"><a href="#cb22-1483" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-foldpred</span></span>
<span id="cb22-1484"><a href="#cb22-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1485"><a href="#cb22-1485" aria-hidden="true" tabindex="-1"></a><span class="in"># Percentage of points in the X-fold change area</span></span>
<span id="cb22-1486"><a href="#cb22-1486" aria-hidden="true" tabindex="-1"></a><span class="in">f_fold &lt;- function(fold){</span></span>
<span id="cb22-1487"><a href="#cb22-1487" aria-hidden="true" tabindex="-1"></a><span class="in">  res &lt;- length(</span></span>
<span id="cb22-1488"><a href="#cb22-1488" aria-hidden="true" tabindex="-1"></a><span class="in">    subset(</span></span>
<span id="cb22-1489"><a href="#cb22-1489" aria-hidden="true" tabindex="-1"></a><span class="in">      df_data_pred_obs, </span></span>
<span id="cb22-1490"><a href="#cb22-1490" aria-hidden="true" tabindex="-1"></a><span class="in">      ratio_predobs &lt; fold &amp; ratio_predobs &gt; -fold</span></span>
<span id="cb22-1491"><a href="#cb22-1491" aria-hidden="true" tabindex="-1"></a><span class="in">      )$w_obs</span></span>
<span id="cb22-1492"><a href="#cb22-1492" aria-hidden="true" tabindex="-1"></a><span class="in">    )/length(subset(df_data_pred_obs, !is.na(w_obs))$t)</span></span>
<span id="cb22-1493"><a href="#cb22-1493" aria-hidden="true" tabindex="-1"></a><span class="in">  return(res)</span></span>
<span id="cb22-1494"><a href="#cb22-1494" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb22-1495"><a href="#cb22-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1496"><a href="#cb22-1496" aria-hidden="true" tabindex="-1"></a><span class="in">df_fold &lt;- data.frame(fold = c(1.05, 1.075, 1, 1.25, 1.5, 2)) %&gt;%</span></span>
<span id="cb22-1497"><a href="#cb22-1497" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(per = signif(mapply(f_fold, fold),2)*100)</span></span>
<span id="cb22-1498"><a href="#cb22-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1499"><a href="#cb22-1499" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(df_fold) &lt;- c("Fold", "Percentage of predictions within")</span></span>
<span id="cb22-1500"><a href="#cb22-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1501"><a href="#cb22-1501" aria-hidden="true" tabindex="-1"></a><span class="in">df_fold |&gt; datatable(options = list(dom = 't'), class="hover")</span></span>
<span id="cb22-1502"><a href="#cb22-1502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1503"><a href="#cb22-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1504"><a href="#cb22-1504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r comppredsim, warning=F, message=F}</span></span>
<span id="cb22-1505"><a href="#cb22-1505" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Comparison of simulated vs predicted parameters values. Vertical lines represent the true values of the simulated population parameters.</span></span>
<span id="cb22-1506"><a href="#cb22-1506" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-comppredsim</span></span>
<span id="cb22-1507"><a href="#cb22-1507" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 4</span></span>
<span id="cb22-1508"><a href="#cb22-1508" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 6</span></span>
<span id="cb22-1509"><a href="#cb22-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1510"><a href="#cb22-1510" aria-hidden="true" tabindex="-1"></a><span class="in">col_delta &lt;- Nord_polar[4]</span></span>
<span id="cb22-1511"><a href="#cb22-1511" aria-hidden="true" tabindex="-1"></a><span class="in">font_size &lt;- 10</span></span>
<span id="cb22-1512"><a href="#cb22-1512" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_dens &lt;- 0.6</span></span>
<span id="cb22-1513"><a href="#cb22-1513" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_expo &lt;- 0.4</span></span>
<span id="cb22-1514"><a href="#cb22-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1515"><a href="#cb22-1515" aria-hidden="true" tabindex="-1"></a><span class="in">plot_L0_mu &lt;- ggplot(</span></span>
<span id="cb22-1516"><a href="#cb22-1516" aria-hidden="true" tabindex="-1"></a><span class="in">  data=subset(df_chains_post_long,Parameter == "b_L0_Intercept"),</span></span>
<span id="cb22-1517"><a href="#cb22-1517" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(</span></span>
<span id="cb22-1518"><a href="#cb22-1518" aria-hidden="true" tabindex="-1"></a><span class="in">    x=value</span></span>
<span id="cb22-1519"><a href="#cb22-1519" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-1520"><a href="#cb22-1520" aria-hidden="true" tabindex="-1"></a><span class="in">  color = Nord_polar[1],</span></span>
<span id="cb22-1521"><a href="#cb22-1521" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = Nord_polar[1]</span></span>
<span id="cb22-1522"><a href="#cb22-1522" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb22-1523"><a href="#cb22-1523" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x=bquote("Initial structural length " (mg^{1/3})))+</span></span>
<span id="cb22-1524"><a href="#cb22-1524" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-1525"><a href="#cb22-1525" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust=0.5,</span></span>
<span id="cb22-1526"><a href="#cb22-1526" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_expo</span></span>
<span id="cb22-1527"><a href="#cb22-1527" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1528"><a href="#cb22-1528" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = sim_L0_mu, color = Nord_polar[1])+</span></span>
<span id="cb22-1529"><a href="#cb22-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1530"><a href="#cb22-1530" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1531"><a href="#cb22-1531" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1532"><a href="#cb22-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1533"><a href="#cb22-1533" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic(font_size)+</span></span>
<span id="cb22-1534"><a href="#cb22-1534" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1535"><a href="#cb22-1535" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.line.y=element_blank(),</span></span>
<span id="cb22-1536"><a href="#cb22-1536" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.y=element_blank(),</span></span>
<span id="cb22-1537"><a href="#cb22-1537" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.ticks.y=element_blank(),</span></span>
<span id="cb22-1538"><a href="#cb22-1538" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y=element_blank(),</span></span>
<span id="cb22-1539"><a href="#cb22-1539" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position="none"</span></span>
<span id="cb22-1540"><a href="#cb22-1540" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1541"><a href="#cb22-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1542"><a href="#cb22-1542" aria-hidden="true" tabindex="-1"></a><span class="in">plot_L0_sd &lt;- ggplot(</span></span>
<span id="cb22-1543"><a href="#cb22-1543" aria-hidden="true" tabindex="-1"></a><span class="in">  data=subset(df_chains_post_long,Parameter == "sd_ID__L0_Intercept"),</span></span>
<span id="cb22-1544"><a href="#cb22-1544" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(</span></span>
<span id="cb22-1545"><a href="#cb22-1545" aria-hidden="true" tabindex="-1"></a><span class="in">    x=value</span></span>
<span id="cb22-1546"><a href="#cb22-1546" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-1547"><a href="#cb22-1547" aria-hidden="true" tabindex="-1"></a><span class="in">  color = Nord_polar[1],</span></span>
<span id="cb22-1548"><a href="#cb22-1548" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = Nord_polar[1]</span></span>
<span id="cb22-1549"><a href="#cb22-1549" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb22-1550"><a href="#cb22-1550" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x=bquote("Initial structural length individual variation " (mg^{1/3})))+</span></span>
<span id="cb22-1551"><a href="#cb22-1551" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-1552"><a href="#cb22-1552" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust=0.5,</span></span>
<span id="cb22-1553"><a href="#cb22-1553" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_expo</span></span>
<span id="cb22-1554"><a href="#cb22-1554" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1555"><a href="#cb22-1555" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = sim_L0_sd, color = Nord_polar[1])+</span></span>
<span id="cb22-1556"><a href="#cb22-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1557"><a href="#cb22-1557" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1558"><a href="#cb22-1558" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1559"><a href="#cb22-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1560"><a href="#cb22-1560" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic(font_size)+</span></span>
<span id="cb22-1561"><a href="#cb22-1561" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1562"><a href="#cb22-1562" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.line.y=element_blank(),</span></span>
<span id="cb22-1563"><a href="#cb22-1563" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.y=element_blank(),</span></span>
<span id="cb22-1564"><a href="#cb22-1564" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.ticks.y=element_blank(),</span></span>
<span id="cb22-1565"><a href="#cb22-1565" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y=element_blank(),</span></span>
<span id="cb22-1566"><a href="#cb22-1566" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position="none",</span></span>
<span id="cb22-1567"><a href="#cb22-1567" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb22-1568"><a href="#cb22-1568" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1569"><a href="#cb22-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1570"><a href="#cb22-1570" aria-hidden="true" tabindex="-1"></a><span class="in">plot_res_mu &lt;- ggplot(</span></span>
<span id="cb22-1571"><a href="#cb22-1571" aria-hidden="true" tabindex="-1"></a><span class="in">  data=subset(df_chains_post_long,Parameter %in% Param_a_mu),</span></span>
<span id="cb22-1572"><a href="#cb22-1572" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(</span></span>
<span id="cb22-1573"><a href="#cb22-1573" aria-hidden="true" tabindex="-1"></a><span class="in">    #x=Parameter,</span></span>
<span id="cb22-1574"><a href="#cb22-1574" aria-hidden="true" tabindex="-1"></a><span class="in">    x=value,</span></span>
<span id="cb22-1575"><a href="#cb22-1575" aria-hidden="true" tabindex="-1"></a><span class="in">    color=exposition,</span></span>
<span id="cb22-1576"><a href="#cb22-1576" aria-hidden="true" tabindex="-1"></a><span class="in">    fill=exposition</span></span>
<span id="cb22-1577"><a href="#cb22-1577" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1578"><a href="#cb22-1578" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb22-1579"><a href="#cb22-1579" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x=bquote("Mean growth rate " (mg^{1/3}/d)))+</span></span>
<span id="cb22-1580"><a href="#cb22-1580" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-1581"><a href="#cb22-1581" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust=0.5,</span></span>
<span id="cb22-1582"><a href="#cb22-1582" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_expo</span></span>
<span id="cb22-1583"><a href="#cb22-1583" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1584"><a href="#cb22-1584" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = sim_a_ctrl_mu, color = pal_col[1])+</span></span>
<span id="cb22-1585"><a href="#cb22-1585" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = sim_a_trt_mu, color = pal_col[2])+</span></span>
<span id="cb22-1586"><a href="#cb22-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1587"><a href="#cb22-1587" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1588"><a href="#cb22-1588" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1589"><a href="#cb22-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1590"><a href="#cb22-1590" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic(font_size)+</span></span>
<span id="cb22-1591"><a href="#cb22-1591" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1592"><a href="#cb22-1592" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.line.y=element_blank(),</span></span>
<span id="cb22-1593"><a href="#cb22-1593" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.y=element_blank(),</span></span>
<span id="cb22-1594"><a href="#cb22-1594" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.ticks.y=element_blank(),</span></span>
<span id="cb22-1595"><a href="#cb22-1595" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y=element_blank(),</span></span>
<span id="cb22-1596"><a href="#cb22-1596" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position="none",</span></span>
<span id="cb22-1597"><a href="#cb22-1597" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1598"><a href="#cb22-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1599"><a href="#cb22-1599" aria-hidden="true" tabindex="-1"></a><span class="in">plot_res_sd &lt;- ggplot(</span></span>
<span id="cb22-1600"><a href="#cb22-1600" aria-hidden="true" tabindex="-1"></a><span class="in">  data=subset(df_chains_post_long,Parameter %in% Param_a_sd),</span></span>
<span id="cb22-1601"><a href="#cb22-1601" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(</span></span>
<span id="cb22-1602"><a href="#cb22-1602" aria-hidden="true" tabindex="-1"></a><span class="in">    x=value,</span></span>
<span id="cb22-1603"><a href="#cb22-1603" aria-hidden="true" tabindex="-1"></a><span class="in">    color=exposition,</span></span>
<span id="cb22-1604"><a href="#cb22-1604" aria-hidden="true" tabindex="-1"></a><span class="in">    fill=exposition</span></span>
<span id="cb22-1605"><a href="#cb22-1605" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb22-1606"><a href="#cb22-1606" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb22-1607"><a href="#cb22-1607" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-1608"><a href="#cb22-1608" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust=0.5,</span></span>
<span id="cb22-1609"><a href="#cb22-1609" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_expo</span></span>
<span id="cb22-1610"><a href="#cb22-1610" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1611"><a href="#cb22-1611" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = sim_a_ctrl_sd, color = pal_col[1])+</span></span>
<span id="cb22-1612"><a href="#cb22-1612" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = sim_a_trt_sd, color = pal_col[2])+</span></span>
<span id="cb22-1613"><a href="#cb22-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1614"><a href="#cb22-1614" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1615"><a href="#cb22-1615" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1616"><a href="#cb22-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1617"><a href="#cb22-1617" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x=bquote(</span></span>
<span id="cb22-1618"><a href="#cb22-1618" aria-hidden="true" tabindex="-1"></a><span class="in">    "Growth rate individual variation " (mg^{1/3}/d)</span></span>
<span id="cb22-1619"><a href="#cb22-1619" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1620"><a href="#cb22-1620" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1621"><a href="#cb22-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1622"><a href="#cb22-1622" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic(font_size)+</span></span>
<span id="cb22-1623"><a href="#cb22-1623" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1624"><a href="#cb22-1624" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.line.y=element_blank(),</span></span>
<span id="cb22-1625"><a href="#cb22-1625" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.y=element_blank(),</span></span>
<span id="cb22-1626"><a href="#cb22-1626" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.ticks.y=element_blank(),</span></span>
<span id="cb22-1627"><a href="#cb22-1627" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y=element_blank(),</span></span>
<span id="cb22-1628"><a href="#cb22-1628" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position="none"</span></span>
<span id="cb22-1629"><a href="#cb22-1629" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1630"><a href="#cb22-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1631"><a href="#cb22-1631" aria-hidden="true" tabindex="-1"></a><span class="in">plot_LnRR &lt;- ggplot(</span></span>
<span id="cb22-1632"><a href="#cb22-1632" aria-hidden="true" tabindex="-1"></a><span class="in">  data=subset(df_chains_post_long,Parameter == "LnRR"),</span></span>
<span id="cb22-1633"><a href="#cb22-1633" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(</span></span>
<span id="cb22-1634"><a href="#cb22-1634" aria-hidden="true" tabindex="-1"></a><span class="in">    x=value</span></span>
<span id="cb22-1635"><a href="#cb22-1635" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-1636"><a href="#cb22-1636" aria-hidden="true" tabindex="-1"></a><span class="in">  color = Nord_polar[4],</span></span>
<span id="cb22-1637"><a href="#cb22-1637" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = Nord_polar[4]</span></span>
<span id="cb22-1638"><a href="#cb22-1638" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb22-1639"><a href="#cb22-1639" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x=bquote("Mean pesticides effect (LnRR)"))+</span></span>
<span id="cb22-1640"><a href="#cb22-1640" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-1641"><a href="#cb22-1641" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust=0.5,</span></span>
<span id="cb22-1642"><a href="#cb22-1642" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_expo</span></span>
<span id="cb22-1643"><a href="#cb22-1643" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1644"><a href="#cb22-1644" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = sim_LnRR, color = Nord_polar[4])+</span></span>
<span id="cb22-1645"><a href="#cb22-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1646"><a href="#cb22-1646" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1647"><a href="#cb22-1647" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1648"><a href="#cb22-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1649"><a href="#cb22-1649" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic(font_size)+</span></span>
<span id="cb22-1650"><a href="#cb22-1650" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1651"><a href="#cb22-1651" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.line.y=element_blank(),</span></span>
<span id="cb22-1652"><a href="#cb22-1652" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.y=element_blank(),</span></span>
<span id="cb22-1653"><a href="#cb22-1653" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.ticks.y=element_blank(),</span></span>
<span id="cb22-1654"><a href="#cb22-1654" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y=element_blank(),</span></span>
<span id="cb22-1655"><a href="#cb22-1655" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position="none"</span></span>
<span id="cb22-1656"><a href="#cb22-1656" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1657"><a href="#cb22-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1658"><a href="#cb22-1658" aria-hidden="true" tabindex="-1"></a><span class="in">plot_LnCVi &lt;- ggplot(</span></span>
<span id="cb22-1659"><a href="#cb22-1659" aria-hidden="true" tabindex="-1"></a><span class="in">  data=subset(df_chains_post_long,Parameter == "LnCVi"),</span></span>
<span id="cb22-1660"><a href="#cb22-1660" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(</span></span>
<span id="cb22-1661"><a href="#cb22-1661" aria-hidden="true" tabindex="-1"></a><span class="in">    x=value</span></span>
<span id="cb22-1662"><a href="#cb22-1662" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-1663"><a href="#cb22-1663" aria-hidden="true" tabindex="-1"></a><span class="in">  color = Nord_polar[4],</span></span>
<span id="cb22-1664"><a href="#cb22-1664" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = Nord_polar[4]</span></span>
<span id="cb22-1665"><a href="#cb22-1665" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb22-1666"><a href="#cb22-1666" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x=bquote("Pesticides effect on individual variation (LnCVi)"))+</span></span>
<span id="cb22-1667"><a href="#cb22-1667" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(</span></span>
<span id="cb22-1668"><a href="#cb22-1668" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust=0.5,</span></span>
<span id="cb22-1669"><a href="#cb22-1669" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_expo</span></span>
<span id="cb22-1670"><a href="#cb22-1670" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb22-1671"><a href="#cb22-1671" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = sim_LnCVi, color = Nord_polar[4])+</span></span>
<span id="cb22-1672"><a href="#cb22-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1673"><a href="#cb22-1673" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1674"><a href="#cb22-1674" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values=rev(pal_col), name="")+</span></span>
<span id="cb22-1675"><a href="#cb22-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1676"><a href="#cb22-1676" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic(font_size)+</span></span>
<span id="cb22-1677"><a href="#cb22-1677" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb22-1678"><a href="#cb22-1678" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.line.y=element_blank(),</span></span>
<span id="cb22-1679"><a href="#cb22-1679" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.title.y=element_blank(),</span></span>
<span id="cb22-1680"><a href="#cb22-1680" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.ticks.y=element_blank(),</span></span>
<span id="cb22-1681"><a href="#cb22-1681" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y=element_blank(),</span></span>
<span id="cb22-1682"><a href="#cb22-1682" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position="none"</span></span>
<span id="cb22-1683"><a href="#cb22-1683" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb22-1684"><a href="#cb22-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1685"><a href="#cb22-1685" aria-hidden="true" tabindex="-1"></a><span class="in">plot &lt;- plot_L0_mu +plot_L0_sd +plot_res_mu + plot_res_sd + plot_LnRR + plot_LnCVi +</span></span>
<span id="cb22-1686"><a href="#cb22-1686" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(ncol=2, guides="collect", heights = c(1, 1, 1))</span></span>
<span id="cb22-1687"><a href="#cb22-1687" aria-hidden="true" tabindex="-1"></a><span class="in">plot</span></span>
<span id="cb22-1688"><a href="#cb22-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1689"><a href="#cb22-1689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1690"><a href="#cb22-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1691"><a href="#cb22-1691" aria-hidden="true" tabindex="-1"></a>@fig-comppredsim shows the posterior distributions of estimated parameters, with vertical black lines indicating the true population values. The results demonstrate good parameter recovery, as the distributions are generally centered around the true values. Estimates for initial structural length, growth rate, and pesticide effects align well with the simulated data, indicating accurate inference.</span>
<span id="cb22-1692"><a href="#cb22-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1693"><a href="#cb22-1693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r err}</span></span>
<span id="cb22-1694"><a href="#cb22-1694" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: Estimation errors on parameters</span></span>
<span id="cb22-1695"><a href="#cb22-1695" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-err</span></span>
<span id="cb22-1696"><a href="#cb22-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1697"><a href="#cb22-1697" aria-hidden="true" tabindex="-1"></a><span class="in">df_err &lt;- data.frame(</span></span>
<span id="cb22-1698"><a href="#cb22-1698" aria-hidden="true" tabindex="-1"></a><span class="in">  Parameter = c(as.list(df_res_VI_show[1])$variable, "LnRR", "LnCVi"),</span></span>
<span id="cb22-1699"><a href="#cb22-1699" aria-hidden="true" tabindex="-1"></a><span class="in">  Simulated = c(sim_L0_mu, sim_a_ctrl_mu, sim_a_trt_mu, sim_L0_sd, sim_a_ctrl_sd, sim_a_trt_sd, sd, sim_LnRR, sim_LnCVi),</span></span>
<span id="cb22-1700"><a href="#cb22-1700" aria-hidden="true" tabindex="-1"></a><span class="in">  Predicted = c(as.list(df_res_VI_show[2])$mean, mean(subset(df_chains_post_long, Parameter == "LnRR")$value), mean(subset(df_chains_post_long, Parameter == "LnCVi")$value))</span></span>
<span id="cb22-1701"><a href="#cb22-1701" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb22-1702"><a href="#cb22-1702" aria-hidden="true" tabindex="-1"></a><span class="in">df_err &lt;- df_err |&gt; </span></span>
<span id="cb22-1703"><a href="#cb22-1703" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb22-1704"><a href="#cb22-1704" aria-hidden="true" tabindex="-1"></a><span class="in">    Per_error = (Predicted-Simulated)/Simulated*100</span></span>
<span id="cb22-1705"><a href="#cb22-1705" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb22-1706"><a href="#cb22-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1707"><a href="#cb22-1707" aria-hidden="true" tabindex="-1"></a><span class="in">df_err |&gt; datatable(</span></span>
<span id="cb22-1708"><a href="#cb22-1708" aria-hidden="true" tabindex="-1"></a><span class="in">  options = list(</span></span>
<span id="cb22-1709"><a href="#cb22-1709" aria-hidden="true" tabindex="-1"></a><span class="in">    dom = 't',</span></span>
<span id="cb22-1710"><a href="#cb22-1710" aria-hidden="true" tabindex="-1"></a><span class="in">    columnDefs = list(</span></span>
<span id="cb22-1711"><a href="#cb22-1711" aria-hidden="true" tabindex="-1"></a><span class="in">      list(className = 'dt-left', targets = "_all")</span></span>
<span id="cb22-1712"><a href="#cb22-1712" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb22-1713"><a href="#cb22-1713" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb22-1714"><a href="#cb22-1714" aria-hidden="true" tabindex="-1"></a><span class="in">  class="hover"</span></span>
<span id="cb22-1715"><a href="#cb22-1715" aria-hidden="true" tabindex="-1"></a><span class="in">  ) |&gt;</span></span>
<span id="cb22-1716"><a href="#cb22-1716" aria-hidden="true" tabindex="-1"></a><span class="in">  formatRound(columns = 2:length(df_err), digits = 4)</span></span>
<span id="cb22-1717"><a href="#cb22-1717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1718"><a href="#cb22-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1719"><a href="#cb22-1719" aria-hidden="true" tabindex="-1"></a>Parameter recovery is excellent at the population level, with absolute errors below 0.5%, and strong at the individual level, with absolute errors between 4 to 5%.</span>
<span id="cb22-1720"><a href="#cb22-1720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1721"><a href="#cb22-1721" aria-hidden="true" tabindex="-1"></a>&lt;button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne"&gt;</span>
<span id="cb22-1722"><a href="#cb22-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1723"><a href="#cb22-1723" aria-hidden="true" tabindex="-1"></a>&lt;b&gt; Session Information &lt;/b&gt;</span>
<span id="cb22-1724"><a href="#cb22-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1725"><a href="#cb22-1725" aria-hidden="true" tabindex="-1"></a>&lt;/button&gt;</span>
<span id="cb22-1726"><a href="#cb22-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1727"><a href="#cb22-1727" aria-hidden="true" tabindex="-1"></a>:::: {#collapseOne .accordion-collapse .collapse}</span>
<span id="cb22-1728"><a href="#cb22-1728" aria-hidden="true" tabindex="-1"></a>&lt;div&gt;</span>
<span id="cb22-1729"><a href="#cb22-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1732"><a href="#cb22-1732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-1733"><a href="#cb22-1733" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb22-1734"><a href="#cb22-1734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-1735"><a href="#cb22-1735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1736"><a href="#cb22-1736" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb22-1737"><a href="#cb22-1737" aria-hidden="true" tabindex="-1"></a>::::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>